::: {.landscape}

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-measurement-timepoints
#| tbl-cap: "Measurement timepoints for all trial endpoints. Please note, that the Mood and Risk Questionnaire (MRQ) is not listed in the table. The MRQ Pre was assessed before each session, the MRQ Post after each session. The measurement time-points of the WAI-SR COACH and WAI-SR SUPERVISOR have been administered before session two in each module. Please see Fromberger et al. [@frombergerMyTabuAPlaceboControlled2021] for table of measurement timepoints with a higher time resolution. Abbreviations: BIS-15 = Barratt Impulsiveness Scale-15, BMS = Bumby Molest Scale, CUSI = Coping Using Sex Inventory, CVTRQ = Corrections Victoria Treatment Readiness Questionnaire, DERS = Difficulties in Emotion Regulation Scale, EKK-R = Questionnaire on Emotional Congruence with Children-Revised, ESIQ = Explicit Sexual Interest Questionnaire, F-Soz-U = Seven-item short version of the Social Support Questionnaire, HBI-19 = Hypersexual Behavior Inventory-19, NARQ = Negative Affect Repair Questionnaire, OQMPR = Questionnaire for the Measurement of Psychological Reactance, RCQ = Readiness to Change Questionnaire - German version, SOI-R = Sexual Outlet Inventory revised, subscale desire for sexual activity with children, SPSI-R = Social Problem-Solving Inventory Revised, SSIC = Specific self-efficacy for modifying Sexual Interest in Children, UCLA = UCLA Loneliness Scale - German short version."

library(dplyr)
library(gt)

# Daten
df <- data.frame(
  Group = c("BASELINE CHARACTERISTICS", "BASELINE CHARACTERISTICS", "BASELINE CHARACTERISTICS", "BASELINE CHARACTERISTICS", 
            "BASELINE CHARACTERISTICS", "BASELINE CHARACTERISTICS", "BASELINE CHARACTERISTICS", "PRIMARY OUTCOMES", 
            "PRIMARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", 
            "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", 
            "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", 
            "SECONDARY OUTCOMES", "SECONDARY OUTCOMES", "ANCILLARY OUTCOMES", "ANCILLARY OUTCOMES", "ANCILLARY OUTCOMES", 
            "ANCILLARY OUTCOMES", "ANCILLARY OUTCOMES"),
  Measure = c("SSQ-P", "SSQ-SO", "SSQ-CF", "PHQ-D", "SSPI-2", "ICD-11-Screener", "CARES", "Official re-offences", 
              "CVTRQ", "RCQ", "OQMPR", "F-SozU", "UCLA", "DERS", "NARQ", "BIS-15", "CUSI", "SPSI-R", "BMS", 
              "HBI-19", "SSIC", "SOI-R", "EKK-R", "ESIQ", "SBV-R", "ATQ", "WHO-5", "QNP", "WAI-SR COACH", "WAI-SR SUPERVISOR"),
  Allocation = c("", "", "X", "", "X", "", "", "", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "X", "", ""),
  Intro_pre = c("X", "", "", "X", "", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "", "", "", ""),
  Intro_post = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""),
  M1_pre = c("", "", "", "", "", "", "X", "", "X", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "X", "X"),
  M1_post = c("", "", "", "", "", "", "", "", "X", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "", ""),
  M2_pre = c("", "", "", "", "", "", "X", "", "", "", "X", "X", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "X", "X"),
  M2_post = c("", "", "", "", "", "", "", "", "", "", "X", "X", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "", "", ""),
  M3_pre = c("", "", "", "", "", "", "X", "", "", "", "", "", "", "X", "X", "X", "X", "", "", "", "", "", "", "", "", "", "X", "", "X", "X"),
  M3_post = c("", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "X", "X", "", "", "", "", "", "", "", "", "", "X", "", "", ""),
  M4_pre = c("", "", "", "", "", "", "X", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "", "", "", "", "X", "", "X", "X"),
  M4_post = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "", "", "", "", "X", "", "", ""),
  M5_pre = c("", "", "", "", "", "", "X", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "", "", "X", "", "X", "X"),
  M5_post = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "", "", "X", "", "", ""),
  M6_pre = c("", "", "", "", "", "", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "X", "", "X", "X"),
  M6_post = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "X", "X", "", "", "", "X", "", "", ""),
  FollowUp = c("", "", "", "", "", "", "", "X", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "")
)

# GT-Tabelle erstellen
tbl <- df %>%
  filter(Measure != "SSQ-rSO") %>%
  gt(rowname_col = "Measure", groupname_col = "Group") %>%
  tab_spanner(label = "Introduction", columns = c(Intro_pre, Intro_post)) %>%
  tab_spanner(label = "Module 1", columns = c(M1_pre, M1_post)) %>%
  tab_spanner(label = "Module 2", columns = c(M2_pre, M2_post)) %>%
  tab_spanner(label = "Module 3", columns = c(M3_pre, M3_post)) %>%
  tab_spanner(label = "Module 4", columns = c(M4_pre, M4_post)) %>%
  tab_spanner(label = "Module 5", columns = c(M5_pre, M5_post)) %>%
  tab_spanner(label = "Module 6", columns = c(M6_pre, M6_post)) %>%
  cols_label(
    Allocation = "Allocation",
    Intro_pre = "pre", Intro_post = "post",
    M1_pre = "pre", M1_post = "post",
    M2_pre = "pre", M2_post = "post",
    M3_pre = "pre", M3_post = "post",
    M4_pre = "pre", M4_post = "post",
    M5_pre = "pre", M5_post = "post",
    M6_pre = "pre", M6_post = "post",
    FollowUp = "Follow-Up"
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.font.size = 10,
    quarto.use_bootstrap = FALSE,
    quarto.disable_processing = TRUE,
    data_row.padding = gt::px(2),
    summary_row.padding = gt::px(2),
    grand_summary_row.padding = gt::px(2),
    #footnotes.padding = gt::px(2),
    #source_notes.padding = gt::px(2),
    row_group.padding = gt::px(2),
    column_labels.font.weight = "bold",
    row_group.font.weight = "bold"
    #row_group.background.color = "#F0F0F0"
  )

# save
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-measurement-timepoints.png")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-measurement-timepoints.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-measurement-timepoints.docx")))

# Ausgabe
tbl
```

:::