```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-intervention-module-theory
#| tbl-cap: "Description of psychotherapeutic techniques."

library(gt)

modules_df <- data.frame(
  Module = c(
    "**Module 1** (Motivation)",
    "**Module 2** (Supervision and social relationships)",
    "**Module 3** (Emotion management)",
    "**Module 4** (Problem solving)",
    "**Module 5** (Offense-supportive attitudes)",
    "**Module 6** (Sexuality)"
  ),
  Riskfactor = c(
    "Strengthen motivation to change and treatment readiness before addressing criminogenic needs.",
    "Build positive social network, reduce resistance to rules and community supervision.",
    "Reduce impulsiveness and improve coping with stress and negative emotions.",
    "Improve social problem-solving skills; promote positive problem orientation and rational problem-solving style.",
    "Change attitudes supporting sexual offending against children.",
    "Reduce sexual preoccupation, emotional congruence with children, and sexual interest in and fantasies about children."
  ),
  Techniques = c(
    "**Motivational Interviewing** (*Miller & Rollnick*, 50): open questions, reflective listening, appreciation, 'change talk' and 'confidence talk', resistance handling, summaries.",
    "**CBT** to encourage social network building and attitude change.",
    "**DBT** (*Linehan*, 62): emotion regulation, distress tolerance.\n\n**ACT** (*Hayes et al.*, 63): acceptance of negative experiences, meaningful life focus.",
    "**Problem-Solving Therapy**: training in positive problem orientation and rational problem-solving (*PST*; Nezu et al., 74).",
    "**Cognitive Restructuring**: identification, reframing, Socratic dialogue, comparison of new vs. old beliefs (Beck).\n\n**RNR**: adaption to individual needs by choosing three out of 16 pre-defined cognitive distortions.",
    "**CBT** to influence sexual thoughts/fantasies and promote adult-oriented interests"
  )
)

# Erstelle die gt-Tabelle
tbl <- gt(modules_df) %>%
  cols_align(
    align = "left",
    columns = vars(Module, Goals, Techniques)
  ) %>%
  fmt_markdown(
    columns = vars(Module, Goals, Techniques)
  ) %>%
  gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = FALSE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.png")))

tbl 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-risk-factors-secondary-outcomes
#| tbl-cap: "Secondary outcomes and their relationship to psychological meaningful risk-factors."

library(gt)

risk_factors_df <- data.frame(
  risk_domain = c(
    "Atypical sexuality",
    "Atypical sexuality",
    "Self-Regulation problems",
    "Lifestyle instability",
    "Emotion regulation deficits",
    "Problem solving deficits",
    "Antisocial cognitions",
    "Hostile masculinity",
    "Non-compliance with interventions",
    "Relationship problems",
    "Relationship problems",
    "Negative social influences"
  ),
  risk_factor = c(
    "Sexual preoccupation",
    "Paraphilic sexual interests",
    "Impulsivity",
    "",
    "",
    "",
    "Offense-supportive attitudes",
    "",
    "",
    "Capacity for adult intimacy",
    "Emotional congruence with children",
    ""
  ),
  operationalization = c(
    "HBI-19",
    "ESIQ; SOI-R",
    "BIS-15; DERS (subscale impulsivity)",
    "",
    "NARQ (subscale externalized coping)",
    "SPSI-R",
    "BMS",
    "",
    "OQMPR",
    "UCLA",
    "EKK-R",
    "FSoz-U K-7"
  ),
  module = c(
    "Module 6",
    "Module 6",
    "Module 3",
    "",
    "Module 3",
    "Module 4",
    "Module 5",
    "",
    "Module 2",
    "Module 2",
    "Module 6",
    "Module 2"
  )
)

# Erstelle die gt-Tabelle
tbl <- gt(risk_factors_df) %>%
  gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = FALSE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-risk-factors-secondary-outcomes.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-risk-factors-secondary-outcomes.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-risk-factors-secondary-outcomes.png")))

tbl 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-intervention-module-theory
#| tbl-cap: "Description of psychotherapeutic techniques."

library(gt)

modules_df <- data.frame(
  Module = c(
    "**Module 1** (Motivation)",
    "**Module 2** (Supervision and social relationships)",
    "**Module 3** (Emotion management)",
    "**Module 4** (Problem solving)",
    "**Module 5** (Offense-supportive attitudes)",
    "**Module 6** (Sexuality)"
  ),
  Goals = c(
    "Strengthen motivation to change and treatment readiness before addressing criminogenic needs.",
    "Build positive social network, reduce resistance to rules and community supervision.",
    "Reduce impulsiveness and improve coping with stress and negative emotions.",
    "Improve social problem-solving skills; promote positive problem orientation and rational problem-solving style.",
    "Change attitudes supporting sexual offending against children.",
    "Reduce sexual preoccupation, emotional congruence with children, and sexual interest in and fantasies about children."
  ),
  Techniques = c(
    paste0(
      "- Motivational Interviewing (Miller & Rollnick, 50): open questions, reflective listening, appreciation\n",
      "- Elicit 'change talk' and 'confidence talk'\n",
      "- Handle resistance; use summaries"
    ),
    paste0(
      "- CBT to encourage social network building\n",
      "- CBT to support attitude change"
    ),
    paste0(
      "- DBT (Linehan, 62): emotion regulation, distress tolerance\n",
      "- ACT (Hayes et al., 63): acceptance of negative experiences, meaningful life focus"
    ),
    paste0(
      "- Problem-Solving Therapy: positive problem orientation and rational problem-solving (PST; Nezu et al., 74)"
    ),
    paste0(
      "- Cognitive restructuring: identification, reframing, Socratic dialogue, compare new vs. old beliefs (Beck)\n",
      "- RNR: adapt to individual needs by choosing 3 out of 16 pre-defined cognitive distortions"
    ),
    paste0(
      "- CBT to influence sexual thoughts/fantasies\n",
      "- Promote adult-oriented interests"
    )
  )
)

# Erstelle die gt-Tabelle
tbl <- gt(modules_df) %>%
  cols_align(
    align = "left",
    columns = vars(Module, Goals, Techniques)
  ) %>%
  fmt_markdown(
    columns = vars(Module, Goals, Techniques)
  ) %>%
  gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = FALSE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-intervention-module-theory.png")))

tbl 
```
