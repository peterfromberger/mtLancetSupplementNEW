{
  "hash": "6d045e652dbce98529efc57ccacd916f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Supplementary materials\"\n\nlightbox: true\nnotebook-links: false\n\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    theme: default\n    other-links:\n      - text: Figures and Tables\n        icon: file-earmark-zip\n        href: 'resources/figs_tbls.zip'\n      - text: Source code\n        icon: github\n        href: 'https://github.com/peterfromberger/mtLancetSupplementNew'\n  pdf:\n    toc: true\n    number-sections: true\n    fontsize: 10pt\n    fig-dpi: 300\n    keep-tex: true\n    include-in-header:\n      - text: |\n          \\usepackage{pdfpages}\n---\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at /home/frp/Code/mtLancetSupplementNEW\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(glue)\n\n# SAP analysis script from MBSB (Dr. Fabian Kück und Dr. Andreas Leha): primary outcomes\nsource(here::here(\"_scripts/Fromberger_SAP.R\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nYou can cite this package as:\n     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.\n     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: multcomp\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: mvtnorm\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: survival\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: TH.data\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: MASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'TH.data'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:MASS':\n\n    geyser\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:MASS':\n\n    select\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDie folgenden Objekte sind maskiert von 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDie folgenden Objekte sind maskiert von 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(ID)`\nJoining with `by = join_by(username)`\nmmrm() registered as emmeans extension\nLade nötiges Paket: lme4\nLade nötiges Paket: Matrix\nAttache Paket: 'lmerTest'\nDas folgende Objekt ist maskiert 'package:lme4':\n\nlmer\nDas folgende Objekt ist maskiert 'package:stats':\n\nstep\nJoining with `by = join_by(client_id)`\nJoining with `by = join_by(ID)`\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.  Additional attributes\nincluding contrasts are lost. To avoid this behavior, make sure use\n`drop_visit_levels = FALSE`.\nAttache Paket: 'gtsummary'\nDas folgende Objekt ist maskiert 'package:MASS':\n\nselect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Using an external vector in selections was deprecated in tidyselect 1.1.0.\ni Please use `all_of()` or `any_of()` instead.\n  # Was:\n  data %>% select(col_name)\n\n  # Now:\n  data %>% select(all_of(col_name))\n\nSee <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'tidyr'\n\nDas folgende Objekt ist maskiert durch '.GlobalEnv':\n\n    who\n\nDie folgenden Objekte sind maskiert von 'package:Matrix':\n\n    expand, pack, unpack\n\nDas folgende Objekt ist maskiert 'package:magrittr':\n\n    extract\n\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\nmmrm() registered as car::Anova extension\nScale for x is already present.\nAdding another scale for x, which will replace the existing scale.\nAttache Paket: 'patchwork'\n\nDas folgende Objekt ist maskiert 'package:MASS':\n\n    area\n\nJoining with `by = join_by(strata)`Joining with `by = join_by(treatment)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# SAP analysis script from MBSB (Dr. Fabian Kück und Dr. Andreas Leha): secodary outcomes\nsource(here::here(\"_scripts/analysis_secondary_endpoints.R\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: There was 1 warning in `mutate()`.\ni In argument: `across(...)`.\nCaused by warning in `Ops.ordered()`:\n! '-' is not meaningful for ordered factors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'nlme'\n\nDas folgende Objekt ist maskiert 'package:lme4':\n\n    lmList\n\nDas folgende Objekt ist maskiert 'package:dplyr':\n\n    collapse\n\n\nAttache Paket: 'ordinal'\n\nDas folgende Objekt ist maskiert 'package:dplyr':\n\n    slice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLade nötiges Paket: car\nLade nötiges Paket: carData\n\nAttache Paket: 'car'\n\nDas folgende Objekt ist maskiert 'package:dplyr':\n\n    recode\n\nLade nötiges Paket: lmtest\nLade nötiges Paket: zoo\n\nAttache Paket: 'zoo'\n\nDie folgenden Objekte sind maskiert von 'package:base':\n\n    as.Date, as.Date.numeric\n\nLade nötiges Paket: sandwich\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\nWarning: variable 'Aktuelle Betreuung, Aktuelle zusätzliche Behandlung' is\nabsent: its contrasts will be ignored\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# SAP analysis script from MBSB (Dr. Fabian Kück und Dr. Andreas Leha): sensitivity analysis for primary outcomes\nsource(here::here(\"_scripts/rbmi.R\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'rbmi'\n\nDas folgende Objekt ist maskiert 'package:tidyr':\n\n    expand\n\nDas folgende Objekt ist maskiert 'package:Matrix':\n\n    expand\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# SAP analysis script from MBSB (Dr. Fabian Kück und Dr. Andreas Leha): remove outlier\nsource(here::here(\"_scripts/remove_outlier.R\"))\n```\n:::\n\n\n<!-- \n##################\n# TRIAL registration\n##################\n-->\n## Trial registry\n\n::: {.content-visible when-format=\"pdf\"}\n\n\\includepdf[pages=-, fitpaper=true]{resources/GermanClinicalTrialsRegister.pdf}\n\n:::\n\n::: {.content-visible when-format=\"html\"}\n```{=html}\n<p>\n    Please <a href=\"resources/GermanClinicalTrialsRegister.pdf\">click here</a> to\n    download the PDF file.\n</p>\n```\n:::\n\n{{< pagebreak >}}\n\n<!-- \n##################\n# WBI description\n##################\n-->\n## The \\@myTabu framework\n\nPlease note, that the following descriptions are partly adapted from Fromberger et al. (2021). [@frombergerMyTabuAPlaceboControlled2021]\n\n### Structure of WBI\n\nThe WBI \\@myTabu consists of three isolated sections, one only for participants, one only for the online coaches, and one section for community supervisors (see @fig-sitemap). The access to these sections was secured by username and password full-filling the criteria of the DSGVO. On the landing page of the coach section, a dashboard informs the coach on tasks he has to perform (e.g. unanswered messages by a client, open guided tasks). Each coach had only access to the participants he was responsible for. The landing page links to the in-app messenger and a page for working on guided tasks together with the participant.\nThe supervisor section, only accessible by participating community supervisors, provides a landing page which summarized important key aspects (treatment progress, critical events) of all participants, which have been supervised by this supervisor. Due to security reasons, the supervisor was able to see the raw values of the primary endpoint. If a item of the primary endpoint has been graded as a potential hint to recidivism by lawyers within the research team during development of the app, additional judicial information are provided specifically for the federal state the supervision officer is working at.\n\n![Sitemap of the WBI \\@myTabu. WBI = Web-Based Intervention. ](_diagrams/mtDiagrams-Sitemap.png){#fig-sitemap width=100%}\n\nThe participant section, only accessible by participants, provides on the landing page key aspects of their progress, e.g. current saldo, gudied exercises the have to work on, a help page, a first aid kit as well as a section for the WBI. The participants are remembered on open guided tasks or being late with the intervention by in-app alerts. The WBI starts with two introductory sessions, in order to explain the participants how the app works. After finishing the instruction section, the participants is linked to the first lection of the WBI. The structure and organization of the content was identical across both trial arms. The WBI was structured into six modules, each module into four sessions and each session into six to eight lections. A lection was divided into different content blocks: guided exercises, psychoeducation, examples (virtual participants), and automated exercises. Virtual participants accompanied the participant, narrate about their experiences, and make suggestions from the perspective of someone who is also affected (scored by professional actor)At the beginning of each session, key elements from the previous session or module were recapped. At the end of each session, the most important points of that session or module were summarized. Content created during exercises was partly dynamic integrated in consecutive sessions. For example, at the start of the intervention participants created a list of positive activities, which was later used to suggest ways in which they could reward themselves for completing a session or module. In both trial arms, the program included digital psycho-educational blocks incorporating multimedia elements such as videos and graphics, as well as guided and unguided exercises. A total of eighteen different online exercises (e.g., fill‑in‑the‑gap tasks, multiple‑choice questions, four-field-tasks) were integrated into the WBI. These exercises were either offered as self‑guided tasks with automated feedback or as coach‑guided tasks in which feedback was provided by online coaches. In the intervention arm, the most relevant aspects of each session were delivered as guided tasks. In the placebo arm, the allocation of tasks as guided or unguided was determined based on a predefined matching procedure to replicate the distribution of guided and unguided tasks in the intervention arm. The feedback of the online coaches was manualized: Within a special section of the WBI, the coach was able to choose pre-build templates for each guided task (see @fig-act-guided-task). Furthermore, an in-app messaging system allowed the user to communicate with the online coach as well as the supervision officer in a secured environment. It was ensured that messages and feedback for guided tasks has been provided within 36 hours by the coach. In order to enhance the extrinsic motivation of participants, an automatic reward system is integrated based on a gamification approach. That is, participants receive coins and virtual awards for each finished content block. The coins can be changed into Euros, if the participant has collected at least 15 Euros, he can request the payout online. The participant can receive a maximum compensation of 120 Euro. Finally, an online first aid kit was provided for each user and filled with individual skills prepared by the user itself during guided tasks in the intervention arm. In the placebo arm, the first add kit was not individualized but pre-filled with basic hints. Throughout all modules, the speech was friendly, empathetic, simple, and easy to understand (e.g., no technical terms, examples of everyday life) in order to account for the different cognitive functioning level of participants.\n\n![Process flow of guided exercises. 29 guided exercises have been developed for each trial arm. The figure shows the process of reviewing a guided task by study therapists.](_diagrams/mtDiagrams-act_Guided_Task.png){#fig-act-guided-task width=100%}\n\n### Theoretical foundation\n\nAlready established therapeutic concepts from in-face community-based treatment programs for individuals who committed sexual offenses against children [@brikenPraeventionSexuellenKindesmissbrauchs2017; @wildPreventionSexualChild2020] as well as cognitive-behavioral treatment concepts build the theoretical ground of the WBI; see @frombergerMyTabuAPlaceboControlled2021 for more details. The in-person programs have been adapted for online use. Both programs have been designed for CSA as well as CSEM offenders. Parts relevant to the meaningful risk factors of both in-face programs have been digitalized and parts on risk factors not supported by empirical evidence have been skipped in order to shorten the WBI. The content of the intervention arm focused exclusively on psychological meaningful risk factors [@mannAssessingRiskSexual2010; @setoEmpiricallybasedDynamicRisk2023], see @fig-wbi-overview for an overview of the theoretical concept of the WBI. To achieve a reduction in re-offenses, it seems to be most promising to target dynamic factors, which are changeable and strong associated with recidivism [@setoEmpiricallybasedDynamicRisk2023]. Mann et al. (2010) introduced the term meaningful psychological risk factors for sexual offending by identifying those risk factors in the literature, which are dynamic and therefore changeable by treatment and are empirically proved in enhancing the risk for recidivism. Recently, Seto et al. (2023) replicated the findings and proofed the meaningful risk factors with a broader and more recent literature basis. The emprirical basis for risk factors for CSAM-exclusive offences is not as broad as for sexual offending in the sense of in-person offences. @babchishinChildSexualExploitation2018 elaborated in their review risk factors for CSEM-exclusive offenders. Atypical sexual interests, sexual pre-occupation, sexual arousal, access to the internet and children, and distorted cognitions are assumed to play a key role in recidivism. Thus, there is a overlap between risk factors for CSA offenses and risk factors for CSAM offenses [@reichelReviewRiskFactors2024]. But it is assumed, that e.g. the content of offense-supportive attitudes differs from the content of offense-supportive attitudes for mixed offenders or CSA-exclusive offenders. Access to children or the internet is a so-called facilitating factor in the sense of the Motivation-Facilitation Model of sexual offending and therefore only indirect changeable by treatment [@setoMotivationFacilitationModelSexual2019]. In consequence, addressed risk factore were the same for participants with CSA offences and participants with CSEM offences. Virtual participants (four male and one female offender with different offense histories) accompanied the participant, narrate about their experiences, and make suggestions from the perspective of someone who is also affected (scored by professional actor). Guided exercises are used at the core of cognitive-behavioral treatment within the WBI. Guided exercises have been developed to train important new concepts online. They ensure, that the participants have to think about the previous contents to answer them correctly, since the online coach reviews the answers. Additionally, guided exercises are the most probable content block in which the online coach gets in touch with the participant (see @fig-act-guided-task). All modules within the intervention arm comprised techniques of motivational interviewing [@rollnickMotivationalInterviewingTreatment2015] to enhance or maintain the motivation of the participants. The WBI is designed for female as well as male participants, but due to a lack of knowledge with regard to specific risk factors for female sex offenders at development of the WBI, the content remains identical for women and men. In order to make the WBI suitable for female participants, the used language was adapted and one female virtual participant has been designed and integrated. The placebo arm was developed to ensure the same mode, dose, and amount of support and attention by supporting online coaches as in the intervention arm - but the content of the modules was unrelated to meaningful dynamic risk factors. The content of the placebo condition comprised information on healthy living, e.g., healthy nutrition, physical activities, or healthy sleep. The amount of guided exercises was the same as in the intervention arm (n = 29 guided exercises), but the exercises have been specifically designed to not induce any sustainable effect. In the following paragraphs, the theoretical backgorund of each module is described in detail.\n\n![Overview of the WBI. The figure shows the correspondence between meaningful risk-factors, secondary outcomes of the clinical trial, and the content of the trial arm. Abbreviations: BIS-15 = Barratt Impulsiveness Scale-15, BMS = Bumby Molest Scale, CUSI = Coping Using Sex Inventory, CVTRQ = Corrections Victoria Treatment Readiness Questionnaire, DERS = Difficulties in Emotion Regulation Scale, EKK-R = Questionnaire on Emotional Congruence with Children-Revised, ESIQ = Explicit Sexual Interest Questionnaire, F-Soz-U = Seven-item short version of the Social Support Questionnaire, HBI-19 = Hypersexual Behavior Inventory-19, NARQ = Negative Affect Repair Questionnaire, OQMPR = Questionnaire for the Measurement of Psychological Reactance, RCQ = Readiness to Change Questionnaire - German version, SOI-R = Sexual Outlet Inventory revised, subscale desire for sexual activity with children, SPSI-R = Social Problem-Solving Inventory Revised, SSIC = Specific self-efficacy for modifying Sexual Interest in Children, UCLA = UCLA Loneliness Scale - German short version.](_diagrams/mtDiagrams-act_Wbi_Overview.png){#fig-wbi-overview width=100%}\n\n#### Module 1: Motivation\n\nWard et al. identify motivation to change and subsequent treatment engagement as intermediate targets that must be addressed before criminogenic needs can be modified. [@wardMultifactorOffenderReadiness2004] Empirical evidence indicates that higher treatment motivation is associated with greater therapeutic success among individuals who committed CSA offences and with programme dropout in web‑based interventions for alcohol use disorder. [@terryMotivationSexOffender2001; @postelEffectivenessWebbasedIntervention2010] Reviews of web‑based interventions suggest that most treatment discontinuation occurs before the active treatment phase begins and that the timing of dropout is comparable between in‑person and therapist‑guided web‑based treatments. [@melvilleDropoutInternetbasedTreatment2010] As motivation to change is likely to influence treatment engagement, outcomes, and dropout among ICCO, these findings highlight the importance of addressing motivation at the outset of the study. [@terryMotivationSexOffender2001; @postelEffectivenessWebbasedIntervention2010] The motivation module is therefore grounded in motivational interviewing principles, which conceptualise behavioural change as a process marked by ambivalence. [@rollnickMotivationalInterviewingTreatment2015] Therapists support participants in exploring reasons for and against change, with a focus on personal values and goal setting to foster intrinsic motivation. The approach is guided by four core principles—expressing empathy, developing discrepancy, avoiding argumentation, and supporting self‑efficacy—implemented through open‑ended questioning, reflective listening, affirmations, change‑talk strategies, resistance management, confidence‑building techniques, and summaries.\n\n#### Module 2: Supervision and social relationships\n\nTheoretical and empirical models of criminal behaviour underscore the relevance of social influences for recidivism. [@andrewsPsychologyCriminalConduct2010] Negative social environments and resistance to rules and supervision have been identified as meaningful risk factors for sexual reoffending. [@setoEmpiricallybasedDynamicRisk2023; @hansonPredictorsSexualRecidivsm2004] Accordingly, interventions for ICCO under CS should promote the development of protective social networks. Such networks extend beyond family and peers to include therapists, supervision officers, and social workers. The supervision and social relationships module of \\@myTabu therefore aims to strengthen motivation to establish positive social connections and to reduce resistance to supervision through psychoeducational and cognitive‑behavioural techniques, including the illustration of associations between negative social networks and reoffending and the provision of strategies to disengage from criminogenic influences. A further established risk factor for sexual reoffending is the absence of emotionally intimate adult relationships. [@setoEmpiricallybasedDynamicRisk2023] Individuals who have committed sexual offences and maintain stable adult partnerships show lower recidivism rates than those who do not, and deficits in emotionally intimate adult relationships are linearly associated with sexual reoffending. [@hansonAssessingRiskSexual2007; @hansonPredictorsSexualRecidivsm2004] Consequently, this module provides information on these associations and offers guidance to support the development of emotionally intimate adult relationships. To date, the effectiveness of the specific supervision‑related content described here has not been empirically evaluated, either in in‑person or in web‑based interventions.\n\n#### Module 3: Emotion management\n\nLifestyle impulsiveness as a pattern characterised by low self‑control, instability in employment and housing, absence of meaningful daily routines, irresponsible decision‑making, and limited or unrealistic long‑term goals is associated with recdivism. Lifestyle impulsiveness is a well‑established risk factor for sexual reoffending with a broad empirical base. [@setoEmpiricallybasedDynamicRisk2023] For dysfunctional coping, Knight and Thornton demonstrated that external coping—defined as a tendency to respond to stressful and negatively valenced emotional events in a reckless and impulsive manner—predicts sexual recidivism. [@knightEvaluatingImprovingRisk2007] To address these risk factors, \\@myTabu integrates skills training derived from Dialectical Behaviour Therapy (DBT [@linehanCourseEvolutionDialectical2015]) and Acceptance and Commitment Therapy (ACT [@hayesAcceptanceCommitmentTherapy1999]) with the aim of reducing impulsivity and strengthening coping capacities in response to stressful or negatively experienced life events. DBT skills training targets emotion regulation and distress tolerance by teaching alternative behavioural strategies to replace external or sexualised coping. DBT has previously been shown to reduce impulsive behaviour in forensic populations, and web‑based interventions based on DBT principles have demonstrated effectiveness, particularly in reducing stress, across several psychiatric conditions. [@berzinsDevelopmentImplementationDialectical2004; @spijkermanEffectivenessOnlineMindfulnessbased2016; @jayawardeneEffectsPreventiveOnline2016] ACT focuses on fostering a meaningful life by promoting acceptance of negative internal experiences and providing strategies for adaptive responses to emotional distress. [@hayesAcceptanceCommitmentTherapy1999] ACT has been successfully applied in offender treatment settings and has shown promising results when delivered via web‑based interventions for various psychiatric disorders. [@spijkermanEffectivenessOnlineMindfulnessbased2016; @jayawardeneEffectsPreventiveOnline2016; @lanzaAcceptanceCommitmentTherapy2014]\n\n#### Module 4: Problem solving\nMeta‑analyses have demonstrated a significant association between poor social problem‑solving abilities and sexual recidivism. [@mannAssessingRiskSexual2010; @setoEmpiricallybasedDynamicRisk2023] Social problem solving is defined as a self‑directed cognitive‑behavioural process through which individuals attempt to identify and implement effective solutions to problems encountered in everyday life. [@dzurillaSocialProblemSolving2004] Within the widely accepted cognitive model proposed by D’Zurilla and Goldfried, problem solving comprises two dimensions: problem orientation and problem‑solving style. Problem orientation may be positive (PPO) or negative (NPO). PPO is associated with adaptive coping and reduced emotional distress, whereas NPO is linked to avoidance and ineffective coping strategies. [@dzurillaProblemSolvingBehavior1971]\nAccording to this model, three problem‑solving styles can be distinguished: rational problem solving (RPS), impulsive coping style (ICS), and avoidance style (AS). RPS involves a systematic and planned application of skills to achieve adaptive solutions. In contrast, ICS is characterised by unsystematic responses, often involving the implementation of the first available option, while AS is marked by avoidance of problems and reliance on external solutions.\nEmpirical evidence indicates that ICCO exhibit higher levels of NPO and lower levels of PPO than the general population and show a greater tendency towards ICS and AS compared with RPS. [@nezuProblemSolvingTherapyTreatment2013] Moreover, poor problem‑solving skills in this population have been shown to be amenable to change through psychological interventions. [@wakelingPsychometricValidationSocial2007; @mcguireReviewEffectiveInterventions2008] The problem‑solving module therefore aims to improve deficient problem‑solving skills by drawing on the well‑established principles of Problem‑Solving Therapy (PST [@nezuProblemSolvingTherapyTreatment2013]). The module focuses on fostering a positive problem orientation and strengthening rational problem‑solving skills.\n\n#### Module 5: Offense‑supportive cognitions\nOffense‑supportive attitudes among ICCO can be summarised as beliefs that children are capable of sexually mature relationships, are not harmed by sexual contact with adults, or actively provoke sexual behaviour in adults. [@mannTreatingCognitiveComponents2016; @setoEmpiricallybasedDynamicRisk2023] These attitudes must be clearly distinguished from attempts to excuse or justify one’s own specific offences, which should not be the focus of cognitive treatment. [@mannAssessingRiskSexual2010] A meta‑analysis by Helmus et al. demonstrated that only offense‑supportive attitudes, as defined above, constitute a psychologically meaningful risk factor in terms of predicting sexual recidivism among ICCO. [@helmusAttitudesSupportiveSexual2013] In contrast, offence‑specific justifications have not been shown to be predictive and are therefore not considered primary targets of intervention. The offense‑supportive attitudes module applies cognitive restructuring to modify offense‑supportive beliefs. Cognitive restructuring is the most widely used and best‑evaluated technique for changing maladaptive cognitions in this population. Modifying implicit theories, attitudes, and beliefs is challenging, particularly among ICCO, as such beliefs may not be experienced as harmful by the individual and may instead serve to minimise perceived harm resulting from their own offences. [@mannTreatingCognitiveComponents2016] Nevertheless, several studies have demonstrated that cognitive restructuring can effectively reduce implicit offense‑supportive beliefs and attitudes. [@beechAssessmentTreatmentDistorted2013]\n\n#### Module 6: Sexuality\n\nIndividuals who have committed sexual offences have been shown to be more sexually active and more strongly interested in sexual topics than non‑offending individuals. [@lalumiereTestMateDeprivation1996] Sexual preoccupation is characterised by intrusive sexual thoughts and behaviours that are difficult or impossible to control (84) and has been shown to be strongly associated with sexual reoffending. [@hansonPredictorsSexualRecidivsm2004] Accordingly, a primary aim of the sexuality module is to provide basic knowledge about sexuality and to support the reduction of excessive sexual thoughts and behaviours. The module further aims to increase awareness of high‑risk situations that may trigger sexual thoughts and behaviours. Participants are provided with strategies to manage and, where possible, reduce sexual preoccupation by limiting sexual thoughts and activities. Emotional congruence with children represents another central risk factor addressed in the sexuality module. ICCO under CS may experience a perceived emotional closeness to children and, when identifying themselves with children, may find it easier to initiate contact with them. [@matthesDeutscheVersionStable20072008] Emotional congruence with children is therefore considered a risk factor strongly associated with sexual reoffending. [@wardIntegratedTheorySexual2006] The sexuality module seeks to reduce emotional congruence with children through psychoeducational approaches, emphasising that emotionally equal relationships between adults and children are not possible and providing strategies to establish greater emotional distance from children.\nSexual interest in children, including sexual fantasies involving children, constitutes one of the most important risk factors for sexual reoffending among ICCO [@setoEmpiricallybasedDynamicRisk2023] and has been described as a potential motivational factor underlying sexual abuse of children. [@wardDynamicRiskFactors2016] Reducing sexual interest in children while strengthening non‑deviant sexual interests may therefore contribute to risk reduction. The extent to which sexual interests can change across the lifespan remains debated, and empirical evidence is currently insufficient to draw definitive conclusions. [@olverEvaluatingChangeMen2020] Clinically, both changes in sexual interests and highly persistent pedophilic interests have been observed, supporting the conceptualisation of sexual interest in children as a dynamic risk factor that may change over time. [@olverEvaluatingChangeMen2020] Within the sexuality module, cognitive‑behavioural techniques are applied to influence sexual interest in and, where possible, sexual fantasies about children, while promoting sexual interest in adults. The techniques employed in this module have demonstrated effectiveness in in‑person treatments and, at least among younger individuals, have also been applied in web‑based interventions. [@franquefWhichTechniquesAre2015; @marshall2011; @guseInterventionsUsingNew2012; @baileyInternetStudyMen2016]\n\n![Action diagram for critical events. Predefined standard operating procedures have been used in order to ensure the security of society during the clinical trial. The figure shows exemplary the process for the occurence of a critical event (hints on concrete preparations of a re-offence). Please note, no critical events occured during the clinical trial.](_diagrams/mtDiagrams-act_Critical_Event.png){#fig-act-critical-event width=100%}\n\n\n{{< pagebreak >}}\n\n<!-- \n##################\n# OUTCOME measures\n##################\n-->\n\n## Outcomes and measurement timepoints\n\n### Description of trial endpoints {#endpoint-description}\n\nNote that the following description of the primary and secondary outcome moeasures is adapted from @frombergerMyTabuAPlaceboControlled2021.\n\n#### SSQ-P\nThe Sample Specifications Questionnaire for the Participant (SSQ-P) is a self developed online questionnaire asking the participants about their demographics, lifestyle, current and former therapeutic treatments and offending history.\n\n#### SSQ-SO\nThe Sample Specifications Questionnaire for the SO (SSQ-SO) is a self-developed online questionnaire for the supervision officer concerning the current living condition, offending and clinical history, and index offense of the participant.\n\n#### SSQ-CF\nThe Sample Specifications Questionnaire based on the Court File (SSQ-CF) is a self-developed checklist for coding court files. Information from the court files are coded by the study investigators to determine whether the participant meets the study inclusion criteria. This includes information e.g on the index offense, and former offenses. In case that items of the SSQ-CF cannot be filled out adequately by utilizing court files, the participants was interviewed directly.\n\n#### PHQ-D\nThe Patient Health Questionnaire (PHQ-D [@loeweGesundheitsfragebogenFuerPatienten2002]) is a screening tool for mental disorders. Classification of results generally takes place on a syndrome level. Syndromes examined are: Somatoform disorders, major depressive syndrome, other depressive syndrome, panic syndrome, other anxiety syndromes, eating disorder syndrome, alcohol abuse. Tests are scored using a stencil. Utilizing a sum score for each syndrome, conclusions pertaining to the severity of each syndrome can be drawn. The measure shows good to very good diagnostic validity, especially regarding panic disorder and major depression [@graefeScreeningPsychischerStoerungen2004].\n\n#### SSPI-2\nThe Revised Scale for Pedophilic Interests (SSPI-2 [@setoRevisedScreeningScale2017a]) is a structured rating scale of assessing pedophilic interests based on the offending behavior. It comprises five items (number, age, gender, relationship of victims, and child pornography) and is significantly associated with phallometrically assessed sexual arousal to children. The SSPI-2 is derived from information of the participants as well as the supervision officer and is only defined for hands-on offenders [@setoRevisedScreeningScale2017a].\n\n#### ICD-11-Screener\nThe ICD-11-Screener [@screenerInstituteSexResearch2019] is a self-assessment procedure to ascertain indications for the presence of sexual dysfunction, gender dysphoria, or paraphilic disorder. However, the instrument is not suitable for diagnosis. It is assumed that the ICD-11-Screener can identify individuals who have the disorders described above. The ICD-11-Screener is not validated yet. Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n#### CARES\nThe Child Sexual Abuse Risk Evaluation Self-Report (CARES) is a composite instrument integrating the CARES-A, which assesses acute dynamic risk factors, and the CARES-S, which measures stable dynamic risk factors. [@sonjaetzlerDevelopmentInitialValidationsubmitted] The CARES total score is calculated by summing the CARES-A and CARES-S total scores, producing a range from 0 to 102, with higher scores indicating greater severity of both acute and stable dynamic risk factors. The CARES-A scale evaluates seven acute dynamic risk factors associated with sexual reoffending in individuals convicted of at least one (contact or non-contact) sexual offense against children: (1) Preoccupation with Potential Victims, (2) Hostility, (3) Hypersexuality, (4) Rejection of Control Measures, (5) Emotional Crisis, (6) Loss of Social Support, and (7) Substance Use. Comprising 21 items, the CARES-A yields scores from 0 to 42; higher scores denote more pronounced acute dynamic risk. Reliability coefficients for the CARES-A range from $\\alpha$ = .79 to $\\alpha$ = .83. Analyses of social desirability revealed no significant correlations between CARES-A scores and either the exaggeration of positive qualities or negative qualities. [@sonjaetzlerDevelopmentInitialValidationsubmitted] The CARES-S scale assesses six stable dynamic predictors of sexual recidivism. It consists of 30 items covering: (1) Problematic Sexual Interests, (2) Problematic Emotion-Regulation, (3) Lack of Problem-Solving Skills, (4) Offense-Supportive Cognitions, and (5) Lack of Social Support. Five of these subscales correspond to empirically supported psychological risk factors for sexual recidivism [@mannAssessingRiskSexual2010; @setoEmpiricallybasedDynamicRisk2023]. The CARES-S total score ranges from 0 to 60; higher scores indicate stronger stable dynamic risk factors. The reduced CARES-S achieved an internal consistency of $\\alpha$ = .53. As with the CARES-A, no significant correlations with social desirability measures were found in the evaluation study.  [@sonjaetzlerDevelopmentInitialValidationsubmitted]\n\n#### Official re-offences\nOfficially registered re-offenses will be assessed five years after last-patient-out (September 2030).\n\n#### CVTRQ\nThe Corrections Victoria Treatment Readiness Questionnaire (CVTRQ [@caseyAssessingSuitabilityOffender2007]) is a self-report measure designed to assess treatment readiness in offenders who have been referred to a cognitive skills program. It comprises 20 items and consists of four scales: (1) Attitudes and motivation, (2) emotional reaction, (3) offending beliefs, and (4) efficacy. Each item has to be answered on a five-point Likert-scale. The CVTRQ shows an acceptable convergent validity, discriminant validity as well as predictive validity [@caseyAssessingSuitabilityOffender2007]. To the best of our knowledge, there is no validated German version of the CVTRQ. \\@myTabu translated the CVTRQ. The translation was checked and translated back into English. Resulting differences due to adaptation were inspected and discussed in terms of item content.\n\n#### RCQ\nThe Readiness to Change Questionnaire (RCQ [@rollnickDevelopmentShortReadiness1992]) is a 12 item questionnaire originally designed to identify the stage of change reached by individuals who excessively drink alcohol. The German version (RCQ-D)[@hannoverReadinessChangeQuestionnaire2002] was adapted within the project by changing the questions regarding drinking of alcohol in questions regarding CSA and CSEM offenses. Responses are made on a five-point Likert-scale. The RCQ-D as well as the RCQ shows good psychometric properties. [@hannoverReadinessChangeQuestionnaire2002] Psychometric properties of the version adapted for ISAC and ICCSEM are not available yet.\n\n#### OQMPR\nThe Questionnaire for the Measurement of Psychological Reactance (QMPR [@merzQuestionnaireMeasurementPsychological1983]) is a questionnaire for the assessment of psychological reactance defined as the theory that people resist attempts to constrain either their thoughts or their behaviors. The Optimized Questionnaire for the Measurement of Psychological Reactance (OQMPR)[@herzbergZurPsychometrischenOptimierung2002] is a German variant of the QMPR. The OQMPR consists of 12 statements on a five-point Likert-scale. It has a test-retest-reliability of rtt = 0.85. [@herzbergZurPsychometrischenOptimierung2002]\n\n#### F-SozU\nSeven-item short version of the Social Support Questionnaire (F-SozU [@dunkelEvaluationShortformSocial2005]) is an efficient questionnaire to assess perceived social support. Each item comprises a five-point Likertscale. Internal consistency of the original long version showed Cronbach's $\\alpha$ between 0.81 and 0.93. [@fydrichFragebogenZurSozialen]\n\n#### UCLA\nThe UCLA Loneliness Scale (UCLA [@russellUCLALonelinessScale1996]) consists of 20 items in order to assess subjective feelings of loneliness. The German short version [@doringPsychometrischeEinsamkeitsforschungDeutsche1993] consists of 12 items on a four-point Likert-scale. A German study with CSA and CSEM offenders demonstrated a high reliability of $\\alpha$ = 0.92. [@neutzeUndetectedDetectedChild2012]\n\n#### DERS\nThe Difficulties in Emotion Regulation Scale (DERS [@gratzMultidimensionalAssessmentEmotion2004]) is a self-report questionnaire to assess emotion dysregulation. The sub-scale \"impulse control difficulties\" is used as outcome measure and comprises five items on a five-point Likert-scale. The German version is used, which shows a good internal consistency, construct and predictive validity. [@ehringCharacteristicsEmotionRegulation2008]\n\n#### NARQ\nThe Negative Affect Repair Questionnaire (NARQ [@schererNegativeAffectRepair2013]) is a self-report questionnaire to assess strategies to regulate negative affect in a systematic manner. It consists of 17 items on a five-point Likert-scale and provides a good construct validity. Reliability scores (Cronbach's $\\alpha$) for the three NARQ scales ranged between 0.71 and 0.80. [@schererNegativeAffectRepair2013]\n\n#### BIS-15\nThe Barratt Impulsiveness Scale-15 (BIS-15 [@pattonFactorStructureBarratt1995]) is a questionnaire developed to assess the personality/behavioral construct of impulsiveness. It consists of 30 items on a four-point Likert-scale. The German short version BIS-15 [@meulePsychometrischeEvaluationDeutschen2011] consisting of 15 items is used in the clinical trial. The BIS-15 is an efficient measure of impulsiveness with good internal consistency of $\\alpha$ = 0.81.  [@meulePsychometrischeEvaluationDeutschen2011]\n\n#### CUSI\nThe Coping Using Sex Inventory (CUSI [@cortoniSexCopingStrategy2001]) is a questionnaire to assess the presence of and the degree to which sex was used to deal with problematic situations. It consists of 16 items on a fivepoint Likert-scale with a satisfying internal consistency. [@cortoniSexCopingStrategy2001] The translation was checked and translated back into English by the authors. Resulting differences due to adaptation were inspected and discussed in terms of item content.\n\n#### SPSI-R\nThe Social Problem-Solving Inventory Revised (SPSI-R [@dzurillaSocialProblemSolving2004]) is a self-report questionnaire for the assessment of the five dimensions in the social problem-solving model: (1) positive problem orientation, (2) negative problem orientation, (3) rational problem solving, (4) impulsivity/carelessness style, and (5) avoidance style. The SPSI-R consists of 52 items on a five-point Likert-scale. It shows good psychometric properties for individuals who have sexually offended [@wakelingPsychometricValidationSocial2007]. The validated German version is a short form consisting of 25 items [@grafPsychometrischeUeberpruefungDeutschsprachigen2003].\n\n#### BMS\nThe Bumby Molest Scale (BMS [@bumbyAssessingCognitiveDistortions]) is a self-report questionnaire which assesses offense supportive cognitions of CSA or CSEM offenders (German Version: [@feelgoodKVMSkalaZurErfassung2009]). It consists of 38 items on a four-point Likert-scale. The German version shows good construct validity, internal consistency, and test-retest reliability [@feelgoodKVMSkalaZurErfassung2009].\n\n#### HBI-19\nSexual preoccupation is assessed by the Hypersexual Behavior Inventory-19 (HBI-19 [@kleinValidierungsstudieDeutschenVersion2013]). The HBI-19 is a three-factor measure (coping, control, and consequences) developed to assess hypersexual behavior. The instrument consists of 19 items (e.g., 'I use sex to forget sorrows of everyday life.') answered on a scale from 1 (never) to 5 (very often). The maximum score is 95, with higher scores indicating a higher level of sexual preoccupation. The questionnaire was shown to have good reliability ($\\alpha$ = 0.90) and validity. [@kleinValidierungsstudieDeutschenVersion2013]\n\n#### SSIC\nThe Specific self-efficacy for modifying Sexual Interest in Children (SSIC [@tozdanSpezifischeSelbstwirksamkeitZur2015]) comprises six items on the participant's conviction regarding the ability to change their sexual interest in children (e.g., 'I can succeed in reducing my sexual interest in children') were answered on a scale from 1 (do not agree at all) to 5 (totally agree). The maximum score is 30, with higher scores indicating a higher level of self-efficacy. The instrument was shown to have good reliability ($\\alpha$ = 0.87) and validity [@tozdanSpezifischeSelbstwirksamkeitZur2015].\n\n#### SOI-R\nThe Item 2a of the Sexual Outlet Inventory revised (SOI-R [@brikenSexualOutletInventory2010]) assesses the desire for sexual activity involving children on a visual analog scale from 0 (desire is absent) to 100 (\"I have to act to satisfy the desire)\"\". Higher values on the scale indicate a stronger sexual interest in children. [@brikenSexualOutletInventory2010]\n\n#### EKK-R\nEmotional congruence with children is assessed by the Questionnaire on Emotional Congruence with Children-Revised (EKK-R [@mackEmotionaleKongruenzMit2012]) including three factors (special relationship to children, immaturity, and emotional closeness to children). Twenty items are answered on a four-point scale. The questionnaire demonstrated good reliability ($\\alpha$ = 0.80) and validity. [@mackEmotionaleKongruenzMit2012]\n\n#### ESIQ\nThe Explicit Sexual Interest Questionnaire (ESIQ [@banseIndirectMeasuresSexual2010]) directly assesses pedophilic interest. It consists of two scales measuring sexual behavior (20 items, e.g., 'I enjoyed orally stimulating a man.') and sexual fantasies (20 items, e.g., 'I find it attractive to imagine a little boy sexually stimulating me.'). All items are answered on a scale from 1 (totally disagree) to 5 (totally agree). The reliability of the instrument ranges between 0.86 and 0.97 [@banseIndirectMeasuresSexual2010].\n\n#### WHO-5\nThe WHO-5 Well-Being Index (WHO-5 [@bechMeasuringDimensionPsychological2004]) is a questionnaire that measures current mental well-being with five items. The items are rated on a six-point Likert-scale ranging from 0 (at no time) to 5 (all of the time). The WHO-5 has shown good validity in measuring subjective well-being in clinical studies [@toppWHO5WellbeingIndex2015]. The norm in Germany is mean 65.7. The threshold for a clinically relevant change is defined as a change of at least 10 points on the total score. [@toppWHO5WellbeingIndex2015] Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n#### QNP\nThe Questionnaire of Non-Participation (QNP) was developed to assess reasons for not taking part in the study. It comprises eleven items on a six-point Likert-scale. Items are e.g., 'I will not take part in the study because I do not need any further help.' or 'I will not take part in the study because I am afraid of negative consequences if my SO gets additional information about me.' The QNP will only be administered if a potential participant will not take part in the study but has given informed consent to fill out this questionnaire. Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n#### MRQ\nThe Mood and Risk Questionnaire (MRQ) consists of ten self-developed items, of which six are asking about thoughts and behaviors associated with potential re-offenses and four asking about the psychological and emotional state of the participant. The MRQ was developed by the \\@myTabu team in order to assess adverse events in a structured manner and with adapted adverse events for individuals who have a history of CSA or CSEM. The MRQ has been assessed before and after each session of the WBI and differs between the items in the pre and post measurements: all items of the pre measurement refer explicitly to the time between finishing last post measurement and before starting the new session (time not working on the WBI). The post measurement explicitly asks for the time during working on the session. The MRQ has the following one-item subscales: (1)  Contact planning (\"...have you thought about how to best make contact with a child?\");  (2) Contact preparation (\"...have you made preparations to be able to make contact with a child?\"); (3) Urge for CSA (\"...have you felt that you must commit a sexual act with a child?\"); (4) Urge for CSEM (\"...have you felt that you might soon (again) watch child sexual abuse material?\"); (5) Sexual tension (\"...have you felt that sexual tension has built up within you?)\"; (6) Control of sexual thoughts and activity (\"...have you felt that it is difficult for you to control your sexual thoughts and activities?\"); (7) Unable to cope with the mental burden (\"...have you felt that you can no longer endure burdens?\"); (8) Suicidal ideations (\"...have you thought about taking your own life?\"); (9) Mental crisis (\"At present, I feel that my behavior and experience are impaired due to mental problems.\"); (10) Very bad negative mood (\"How do you feel at the moment?\"). An adverse event was defined as the highest possible score on each one-item self-report subscale ('Often' for subscales 1–8, 'Strongly agree' for subscale 9, and 'Very bad' for subscale 10). The MRQ post questionnaire explicitly asks for the time during working on the WBI, whereas the MRQ pre questionnaire eclusiviely asks for the last week before measurement timepoint. Please note, that the occurence of a report of the highest possible score was defined as adverse event post-hoc. Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n#### WAI-SR\nThe Working Alliance Inventory-Short Revised (WAI-SR [@wilmersDeutschsprachigeVersionWorking2008; @horvathDevelopmentWorkingAlliance1986]) measures three dimensions of therapeutic alliance: (a) bond, (b) task, and (c) goal. For the purpose of this study, the original items of the German version [@wilmersDeutschsprachigeVersionWorking2008] were adapted to be suitable for a web-based intervention. The items have to be rated on a five-point Likertscale ranging from 1 (never) to 5 (always). It was adapted to suit to the online-coach (WAI-SR COACH) as well as the supervision officer (WAI-SR SUPERVISOR) resulting in 16 items. Internal consistency (Cronbach's $\\alpha$) of the original questionnaire ranges from 0.82 to 0.90 [@wilmersDeutschsprachigeVersionWorking2008]. Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n#### EQ\nThe Exclusion Questionnaire (EQ) is a questionnaire to assess the exclusion reasons of the supervision officer. The EQ was specifically developed for this clinical trial by the project team. Only supervision officers were able to exclude a participant from the trial by clicking a button in the WBI. After clicking the button, the supervision officer had to fill in the EQ before the PI was informed to exclude the participant by Email. The EQ asks about eight possible exclusion reasons (e.g. re-offences, withdraw of informed consent) and one additional free text from. Multiple answers on the eight exclusion reasons are possible. Due to a mistake by the PI, this questionnaire was not mentioned in the SAP.\n\n\n::: {.landscape}\n\n\n::: {#tbl-measurement-timepoints .cell tbl-cap='Measurement timepoints for all trial endpoints. Please note, that the Mood and Risk Questionnaire (MRQ) is not listed in the table. The MRQ Pre was assessed before each session, the MRQ Post after each session. The measurement time-points of the WAI-SR COACH and WAI-SR SUPERVISOR have been administered before session two in each module. Please see Fromberger et al. [@frombergerMyTabuAPlaceboControlled2021] for table of measurement timepoints with a higher time resolution.'}\n\n```{.r .cell-code .hidden}\nlibrary(dplyr)\nlibrary(gt)\n\n# Daten\ndf <- data.frame(\n  Group = c(\"BASELINE CHARACTERISTICS\", \"BASELINE CHARACTERISTICS\", \"BASELINE CHARACTERISTICS\", \"BASELINE CHARACTERISTICS\", \n            \"BASELINE CHARACTERISTICS\", \"BASELINE CHARACTERISTICS\", \"BASELINE CHARACTERISTICS\", \"PRIMARY OUTCOMES\", \n            \"PRIMARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \n            \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \n            \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \n            \"SECONDARY OUTCOMES\", \"SECONDARY OUTCOMES\", \"ANCILLARY OUTCOMES\", \"ANCILLARY OUTCOMES\", \"ANCILLARY OUTCOMES\", \n            \"ANCILLARY OUTCOMES\", \"ANCILLARY OUTCOMES\"),\n  Measure = c(\"SSQ-P\", \"SSQ-SO\", \"SSQ-CF\", \"PHQ-D\", \"SSPI-2\", \"ICD-11-Screener\", \"CARES\", \"Official re-offences\", \n              \"CVTRQ\", \"RCQ\", \"OQMPR\", \"F-SozU\", \"UCLA\", \"DERS\", \"NARQ\", \"BIS-15\", \"CUSI\", \"SPSI-R\", \"BMS\", \n              \"HBI-19\", \"SSIC\", \"SOI-R\", \"EKK-R\", \"ESIQ\", \"SBV-R\", \"ATQ\", \"WHO-5\", \"QNP\", \"WAI-SR COACH\", \"WAI-SR SUPERVISOR\"),\n  Allocation = c(\"\", \"\", \"X\", \"\", \"X\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"\", \"\"),\n  Intro_pre = c(\"X\", \"\", \"\", \"X\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\"),\n  Intro_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"),\n  M1_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M1_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  M2_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"X\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M2_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  M3_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M3_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  M4_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M4_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  M5_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M5_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  M6_pre = c(\"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"X\", \"\", \"X\", \"X\"),\n  M6_post = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"X\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\"),\n  FollowUp = c(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"X\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\")\n)\n\n# GT-Tabelle erstellen\ntbl <- df %>%\n  filter(Measure != \"SSQ-rSO\") %>%\n  gt(rowname_col = \"Measure\", groupname_col = \"Group\") %>%\n  tab_spanner(label = \"Introduction\", columns = c(Intro_pre, Intro_post)) %>%\n  tab_spanner(label = \"Module 1\", columns = c(M1_pre, M1_post)) %>%\n  tab_spanner(label = \"Module 2\", columns = c(M2_pre, M2_post)) %>%\n  tab_spanner(label = \"Module 3\", columns = c(M3_pre, M3_post)) %>%\n  tab_spanner(label = \"Module 4\", columns = c(M4_pre, M4_post)) %>%\n  tab_spanner(label = \"Module 5\", columns = c(M5_pre, M5_post)) %>%\n  tab_spanner(label = \"Module 6\", columns = c(M6_pre, M6_post)) %>%\n  cols_label(\n    Allocation = \"Allocation\",\n    Intro_pre = \"pre\", Intro_post = \"post\",\n    M1_pre = \"pre\", M1_post = \"post\",\n    M2_pre = \"pre\", M2_post = \"post\",\n    M3_pre = \"pre\", M3_post = \"post\",\n    M4_pre = \"pre\", M4_post = \"post\",\n    M5_pre = \"pre\", M5_post = \"post\",\n    M6_pre = \"pre\", M6_post = \"post\",\n    FollowUp = \"Follow-Up\"\n  ) %>%\n  tab_source_note(\n    \"Abbreviations: BIS-15 = Barratt Impulsiveness Scale-15, BMS = Bumby Molest Scale, CUSI = Coping Using Sex Inventory, CVTRQ = Corrections Victoria Treatment Readiness Questionnaire, DERS = Difficulties in Emotion Regulation Scale, EKK-R = Questionnaire on Emotional Congruence with Children-Revised, ESIQ = Explicit Sexual Interest Questionnaire, F-Soz-U = Seven-item short version of the Social Support Questionnaire, HBI-19 = Hypersexual Behavior Inventory-19, NARQ = Negative Affect Repair Questionnaire, OQMPR = Questionnaire for the Measurement of Psychological Reactance, RCQ = Readiness to Change Questionnaire - German version, SOI-R = Sexual Outlet Inventory revised, subscale desire for sexual activity with children, SPSI-R = Social Problem-Solving Inventory Revised, SSIC = Specific self-efficacy for modifying Sexual Interest in Children, UCLA = UCLA Loneliness Scale - German short version.\"\n  ) %>%\n  tab_options(\n    table.font.names = \"Times New Roman\",\n    table.font.size = 10,\n    quarto.use_bootstrap = FALSE,\n    quarto.disable_processing = TRUE,\n    data_row.padding = gt::px(1),\n    summary_row.padding = gt::px(1),\n    grand_summary_row.padding = gt::px(1),\n    row_group.padding = gt::px(1),\n    column_labels.font.weight = \"bold\",\n    row_group.font.weight = \"bold\"\n  ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-measurement-timepoints.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f4d176ee.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-measurement-timepoints.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5d17058.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-measurement-timepoints.docx\")))\n\n# Ausgabe\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}l|llrlllllllllllll}\n\\toprule\n &  & \\multicolumn{2}{c}{Introduction} & \\multicolumn{2}{c}{Module 1} & \\multicolumn{2}{c}{Module 2} & \\multicolumn{2}{c}{Module 3} & \\multicolumn{2}{c}{Module 4} & \\multicolumn{2}{c}{Module 5} & \\multicolumn{2}{c}{Module 6} &  \\\\ \n\\cmidrule(lr){3-4} \\cmidrule(lr){5-6} \\cmidrule(lr){7-8} \\cmidrule(lr){9-10} \\cmidrule(lr){11-12} \\cmidrule(lr){13-14} \\cmidrule(lr){15-16}\n & Allocation & pre & post & pre & post & pre & post & pre & post & pre & post & pre & post & pre & post & Follow-Up \\\\ \n\\midrule\\addlinespace[2.5pt]\n\\multicolumn{17}{l}{BASELINE CHARACTERISTICS} \\\\[2.5pt] \n\\midrule\\addlinespace[2.5pt]\nSSQ-P &  & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nSSQ-SO &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nSSQ-CF & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nPHQ-D &  & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nSSPI-2 & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nICD-11-Screener &  & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nCARES &  &  &  & X &  & X &  & X &  & X &  & X &  & X &  &  \\\\ \n\\midrule\\addlinespace[2.5pt]\n\\multicolumn{17}{l}{PRIMARY OUTCOMES} \\\\[2.5pt] \n\\midrule\\addlinespace[2.5pt]\nOfficial re-offences &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  & X \\\\ \nCVTRQ & X &  &  & X & X &  &  &  &  &  &  &  &  &  &  &  \\\\ \n\\midrule\\addlinespace[2.5pt]\n\\multicolumn{17}{l}{SECONDARY OUTCOMES} \\\\[2.5pt] \n\\midrule\\addlinespace[2.5pt]\nRCQ &  &  &  & X & X &  &  &  &  &  &  &  &  &  &  &  \\\\ \nOQMPR &  &  &  &  &  & X & X &  &  &  &  &  &  &  &  &  \\\\ \nF-SozU &  &  &  &  &  & X & X &  &  &  &  &  &  &  &  &  \\\\ \nUCLA &  &  &  &  &  & X & X &  &  &  &  &  &  &  &  &  \\\\ \nDERS &  &  &  &  &  &  &  & X & X &  &  &  &  &  &  &  \\\\ \nNARQ &  &  &  &  &  &  &  & X & X &  &  &  &  &  &  &  \\\\ \nBIS-15 &  &  &  &  &  &  &  & X & X &  &  &  &  &  &  &  \\\\ \nCUSI &  &  &  &  &  &  &  & X & X &  &  &  &  &  &  &  \\\\ \nSPSI-R &  &  &  &  &  &  &  &  &  & X & X &  &  &  &  &  \\\\ \nBMS &  &  &  &  &  &  &  &  &  & X & X &  &  &  &  &  \\\\ \nHBI-19 &  &  &  &  &  &  &  &  &  &  &  & X & X &  &  &  \\\\ \nSSIC &  &  &  &  &  &  &  &  &  &  &  & X & X &  &  &  \\\\ \nSOI-R &  &  &  &  &  &  &  &  &  &  &  &  &  & X & X &  \\\\ \nEKK-R &  &  &  &  &  &  &  &  &  &  &  &  &  & X & X &  \\\\ \nESIQ &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nSBV-R &  & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \n\\midrule\\addlinespace[2.5pt]\n\\multicolumn{17}{l}{ANCILLARY OUTCOMES} \\\\[2.5pt] \n\\midrule\\addlinespace[2.5pt]\nATQ & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nWHO-5 &  &  &  & X & X & X & X & X & X & X & X & X & X & X & X &  \\\\ \nQNP & X &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\\\ \nWAI-SR COACH &  &  &  & X &  & X &  & X &  & X &  & X &  & X &  &  \\\\ \nWAI-SR SUPERVISOR &  &  &  & X &  & X &  & X &  & X &  & X &  & X &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: BIS-15 = Barratt Impulsiveness Scale-15, BMS = Bumby Molest Scale, CUSI = Coping Using Sex Inventory, CVTRQ = Corrections Victoria Treatment Readiness Questionnaire, DERS = Difficulties in Emotion Regulation Scale, EKK-R = Questionnaire on Emotional Congruence with Children-Revised, ESIQ = Explicit Sexual Interest Questionnaire, F-Soz-U = Seven-item short version of the Social Support Questionnaire, HBI-19 = Hypersexual Behavior Inventory-19, NARQ = Negative Affect Repair Questionnaire, OQMPR = Questionnaire for the Measurement of Psychological Reactance, RCQ = Readiness to Change Questionnaire - German version, SOI-R = Sexual Outlet Inventory revised, subscale desire for sexual activity with children, SPSI-R = Social Problem-Solving Inventory Revised, SSIC = Specific self-efficacy for modifying Sexual Interest in Children, UCLA = UCLA Loneliness Scale - German short version.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n:::\n\n\n<!-- \n##################\n# RESULTS Section\n##################\n-->\n{{< pagebreak >}}\n\n## Baseline characteristics\n\n### SSPI-2\n\n\n::: {#tbl-sspi-2 .cell tbl-cap='Baseline values of the SSPI-2. Note, that the SSPI-2 is only defined for participants who have at least one hands-on offences. [@setoRevisedScreeningScale2017a] Abbreviations: Q1 = 25th percentile, Q3 = 75th percentile.'}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nlibrary(tidyr)\nlibrary(gtsummary)\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# read in data\ndata <- read.csv(here::here(\"_data/finalData/randomizedMaster.csv\"))\n\n# itt\ndata <- data %>% filter(client_id %in% client_list)\n\ncalculate_sspi <- function(df) {\n\n  # umcodierung der items zum berechnen\n  df <- df %>% mutate(sspi_irgendein_maennliches_opfer_unter_15jahre = case_when(indexirgend == \"Ja\" ~ 1,\n                                                                                      indexirgend == \"Nein\" ~ 0,\n                                                                                      TRUE ~ NA_real_))\n\n  df <- df %>% mutate(sspi_mehrere_opfer_unter_15jahre = case_when(indexmehropf == \"Ja\" ~ 1,\n                                                                        indexmehropf == \"Nein\" ~ 0,\n                                                                        TRUE ~ NA_real_))\n  \n  df <- df %>% mutate(sspi_irgendein_opfer_unter_12jahre = case_when(indexirgendopf == \"Ja\" ~ 1,\n                                                                          indexirgendopf == \"Nein\" ~ 0,\n                                                                          TRUE ~ NA_real_))\n  df <- df %>% mutate(sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre = case_when(indexnichtfam == \"Ja\" ~ 1,\n                                                                                                      indexnichtfam == \"Nein\" ~ 0,\n                                                                                                      TRUE ~ NA_real_))\n  df <- df %>% mutate(sspi_irgendein_besitz_von_kinderpornographie = case_when(vsbesitz == \"Ja\" ~ 1,\n                                                                                  vsbesitz == \"Nein\" ~ 0,\n                                                                                  TRUE ~ NA_real_))\n  # sspi-2 score auf aktenbasis (auch bei personen mit unvollstaendigen items)\n  df <- df %>% mutate(calc_sspi_score = rowSums(across(c(sspi_irgendein_maennliches_opfer_unter_15jahre, \n                                                        sspi_mehrere_opfer_unter_15jahre, \n                                                        sspi_irgendein_opfer_unter_12jahre, \n                                                        sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre,\n                                                        sspi_irgendein_besitz_von_kinderpornographie))\n                                                        ))\n                                                        \n  #sspi score ist nur sinnvoll bei personen, die eine straftat nach §§ 176 stgb ff. begangen haben\n  df <- df %>% mutate(calc_sspi_score = case_when(strataindex != \"Auch §§ 176, 176a, 176b StGB\" ~ NA,\n                                                  indexirgend == \"keine Angabe\"  ~ NA, \n                                                  indexmehropf == \"keine Angabe\"  ~ NA,\n                                                  indexirgendopf == \"keine Angabe\" ~ NA,\n                                                  indexnichtfam == \"keine Angabe\" ~ NA,\n                                                  TRUE ~ calc_sspi_score))\n\n  return(df)\n}\n\nsspi <- data %>%\n    dplyr::select(\n        strataindex,\n        indexirgend,\n        indexmehropf,\n        indexirgendopf,\n        indexnichtfam,\n        vsbesitz,\n        sspi_irgendein_besitz_von_kinderpornographie,\n        sspi_mehrere_opfer_unter_15jahre,\n        sspi_irgendein_maennliches_opfer_unter_15jahre,\n        sspi_irgendein_opfer_unter_12jahre,\n        sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre,\n        client_group,\n        indexnichtfam,\n    )\n\nsspi <- calculate_sspi(sspi) \n\nsspi <- sspi %>%\n    select(\n        -strataindex,\n        -indexirgend,\n        -indexmehropf,\n        -indexirgendopf,\n        -indexnichtfam,\n        -vsbesitz\n    ) %>%\n    mutate(\n        sspi_irgendein_besitz_von_kinderpornographie = factor(sspi_irgendein_besitz_von_kinderpornographie, levels = c(1, 0), labels = c(\"Yes\", \"No\")),\n        sspi_mehrere_opfer_unter_15jahre = factor(sspi_mehrere_opfer_unter_15jahre, levels = c(1, 0), labels = c(\"Yes\", \"No\")),\n        sspi_irgendein_maennliches_opfer_unter_15jahre = factor(sspi_irgendein_maennliches_opfer_unter_15jahre, levels = c(1, 0), labels = c(\"Yes\", \"No\")),\n        sspi_irgendein_opfer_unter_12jahre = factor(sspi_irgendein_opfer_unter_12jahre, levels = c(1, 0), labels = c(\"Yes\", \"No\")),\n        sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre = factor(sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre, levels = c(1, 0), labels = c(\"Yes\", \"No\"))\n    )\n\ntbl <- sspi %>%\n    tbl_summary(\n        by = client_group,\n        type = list(\n            sspi_irgendein_besitz_von_kinderpornographie  ~ \"categorical\",\n            sspi_mehrere_opfer_unter_15jahre  ~ \"categorical\",\n            sspi_irgendein_maennliches_opfer_unter_15jahre  ~ \"categorical\",\n            sspi_irgendein_opfer_unter_12jahre  ~ \"categorical\",\n            sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre  ~ \"categorical\",\n            calc_sspi_score  ~ \"continuous2\"\n        ),\n        label = list(\n            sspi_irgendein_besitz_von_kinderpornographie = \"Any hands-off offences\",\n            sspi_mehrere_opfer_unter_15jahre = \"More than one hands-on victims\",\n            sspi_irgendein_maennliches_opfer_unter_15jahre  = \"Any hands-on victims under 15 years old\",\n            sspi_irgendein_opfer_unter_12jahre  = \"Any hands-on victims under 12 years old\",\n            sspi_irgendein_nicht_zur_familie_gehoerendes_opfer_unter15jahre  = \"Any extra-familiar hands-on victims\",\n            calc_sspi_score = \"SSPI-2 score\"\n        ),\n        missing_text = \"Missing\"\n    ) %>%\n    add_overall() %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    )\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sspi-2.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f17a772ed.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sspi-2.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sspi-2.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f40a17fb1.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl       \n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Overall}  N = 221\\textsuperscript{\\textit{1}} & \\textbf{Intervention}  N = 108\\textsuperscript{\\textit{1}} & \\textbf{Placebo}  N = 113\\textsuperscript{\\textit{1}} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Any hands-off offences} &  &  &  \\\\ \n    Yes & 186 (84\\%) & 90 (83\\%) & 96 (85\\%) \\\\ \n    No & 35 (16\\%) & 18 (17\\%) & 17 (15\\%) \\\\ \n{\\bfseries More than one hands-on victims} &  &  &  \\\\ \n    Yes & 43 (45\\%) & 20 (43\\%) & 23 (46\\%) \\\\ \n    No & 53 (55\\%) & 26 (57\\%) & 27 (54\\%) \\\\ \n    Missing & 125 & 62 & 63 \\\\ \n{\\bfseries Any hands-on victims under 15 years old} &  &  &  \\\\ \n    Yes & 43 (44\\%) & 21 (44\\%) & 22 (45\\%) \\\\ \n    No & 54 (56\\%) & 27 (56\\%) & 27 (55\\%) \\\\ \n    Missing & 124 & 60 & 64 \\\\ \n{\\bfseries Any hands-on victims under 12 years old} &  &  &  \\\\ \n    Yes & 68 (72\\%) & 31 (66\\%) & 37 (77\\%) \\\\ \n    No & 27 (28\\%) & 16 (34\\%) & 11 (23\\%) \\\\ \n    Missing & 126 & 61 & 65 \\\\ \n{\\bfseries Any extra-familiar hands-on victims} &  &  &  \\\\ \n    Yes & 75 (77\\%) & 35 (74\\%) & 40 (80\\%) \\\\ \n    No & 22 (23\\%) & 12 (26\\%) & 10 (20\\%) \\\\ \n    Missing & 124 & 61 & 63 \\\\ \n{\\bfseries SSPI-2 score} &  &  &  \\\\ \n    Median (Q1 – Q3) & 3·00 (2·00 – 4·00) & 3·00 (2·00 – 4·00) & 3·00 (2·00 – 4·00) \\\\ \n    Missing & 136 & 66 & 70 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\textsuperscript{\\textit{1}} n (\\%)\\\\\n\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n\n{{< pagebreak >}}\n\n## Timing (protocol deviations)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggrain)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRegistered S3 methods overwritten by 'ggpp':\n  method                  from   \n  heightDetails.titleGrob ggplot2\n  widthDetails.titleGrob  ggplot2\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(ggsci)\n\nscale_colour_group <- function(...) {\n  scale_colour_manual(\n    values = c(\n      \"Intervention\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[2],\n      \"Placebo\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[1]\n    )\n  )\n}\n\nscale_fill_group <- function(...) {\n  scale_fill_manual(\n    values = c(\n      \"Intervention\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[2],\n      \"Placebo\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[1]\n    )\n  )\n}\n\nadd_gg_theme <- function(plt) {\n  plt <- plt +\n    scale_fill_group() +\n    scale_colour_group() +\n    ggplot2::theme_classic() + \n    ggplot2::theme(\n          axis.title = element_text(size = 16),\n          axis.text = element_text(size = 14),\n          legend.title = element_text(size = 16),\n          legend.text = element_text(size = 14),\n      )\n\n  return(plt)\n}\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#df <- readRDS(here::here(\"_data/finalData/randomizedMaster2.Rds\"))\ndf <- dat_clean\n\nbm_unpaired_test <- function(data, variable, by, ...) {\n\n  # ---------------\n  # Brunner-Munzel Test for unpaired data\n  # ---------------\n\n  formula <- as.formula(paste(variable, \" ~ client_group\"))\n\n  bm_intervention <- npar.t.test(\n    data[[variable]] ~ data[[by]],\n    data = data,\n    conf.level = 0.95,\n    alternative = \"two.sided\",\n    nperm = 10000,\n    rounds = 3,\n    info = FALSE,\n    plot.simci = FALSE\n)\n\n  df <- data.frame(\n    Effect = c(bm_intervention$Analysis$Effect),\n    p.hat = c(bm_intervention$Analysis$Estimator),\n    Lower = c(bm_intervention$Analysis$Lower),\n    Upper = c(bm_intervention$Analysis$Upper),\n    t.value = c(bm_intervention$Analysis$T),\n    p.value = c(bm_intervention$Analysis$p)\n  )\n\n  df <- df %>%\n    dplyr::mutate(\n      ci.value = glue::glue(\"{Lower}, {Upper}\")\n    ) %>%\n    dplyr::select(c(p.value))\n\n  return(df)\n}\n```\n:::\n\n\n### Cumulative time from baseline to finish module\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# RAIN plot (descriptive)\ntmp_tmp = dat_clean %>%\n      select(client_id, treatment, timepoint, Zeit_seit_Beginn_Modul_1_in_Jahren) %>% filter(timepoint != \"Baseline\" & !client_id %in% c(253, 396))\n\n# convert to days\ntmp_tmp <- tmp_tmp %>%\n  mutate(Zeit_seit_Beginn_Modul_1_in_Jahren = Zeit_seit_Beginn_Modul_1_in_Jahren* 365.25)\n    \n# RAIN plot (descriptive)\nplt <- ggplot(tmp_tmp, aes(fill = treatment, x = timepoint, y = Zeit_seit_Beginn_Modul_1_in_Jahren, color = treatment)\n  ) +\n  geom_rain(\n    seed = 42,\n    rain.side = 'r',\n    #id.long.var = \"IoD_reduced\",\n    point.args = list(\n      alpha = 0.3,\n      shape = 21\n    ),\n    point.args.pos = rlang::list2(\n      position = position_jitter(\n        width = 0.1,\n        height = 0.1\n      )\n    ),\n    boxplot.args = list(\n      outlier.shape = NA,\n      color = \"black\",\n      alpha = .7\n    ),\n    boxplot.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .25,\n        width = 0.2\n      ), \n      width = 0.15\n    ),\n    violin.args = list(\n      alpha = .2\n    ),\n    violin.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .4,\n        width = 0\n      ), \n      width = 1.2\n    ),\n  ) +\n  labs(\n    y = \"Time from baseline to post module (days)\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n\nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-time-to-post-module-rainplot.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-time-to-post-module-rainplot.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 459 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n:::\n\n\n![Cumulative time from baseline to finish module. The cumulative time from baseline to finish module is defined as time from beginning of module one to the end of the respective module. Note, that the cumulative time from baseline to finish module consist of the time of working on the content and time for filling in questionnaires and time needed to revise guided tasks (and an undefined error term for doing things not related to the WBI).](_figures/fig-time-to-post-module-rainplot.png){#fig-time-to-post-module-rainplot width=100%}\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(mmrm)\n\nformular <- as.formula(\n  paste(\n      \"Zeit_seit_Beginn_Modul_1_in_Jahren ~ timepoint + treatment:timepoint + us(timepoint | client_id)\"\n  )\n)\n\nfit_time_post_module <- mmrm(\n    formula = formular,\n    data = tmp_tmp %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n        dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n:::\n\n\n\n::: {#tbl-time-to-post-module-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for the cumulative time from baseline to finish module. The cumulative time from baseline to finish module is defined as time from beginning of module one to the end of the respective module. Note, that the cumulative time from baseline to finish module consist of the time of working on the content and time for filling in questionnaires and time needed to revise guided tasks (and an undefined error term for doing things not related to the WBI).'}\n\n```{.r .cell-code .hidden}\ntbl <- fit_time_post_module %>%\n    tbl_regression(\n      add_estimate_to_reference_rows = TRUE,\n      intercept = TRUE,\n      label = list(\n        treatment = \"Treatment\",\n        timepoint = \"Timepoint\",\n        `Timepoint * treatment` = \"Timepoint * treatment\"\n      )\n    ) %>%\n    modify_header(label ~ \"**Variable**\") %>%\n    remove_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"StGB = German penalty law\") %>%\n    modify_column_alignment(columns = everything(), align = \"left\") %>%\n    modify_table_styling(\n        columns = c(estimate, conf.low, conf.high),\n        rows = reference_row %in% TRUE,\n        missing_symbol = \"Ref.\"\n    ) %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f31a39f27.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-mmrm.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f312fa212.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}llll}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 87 & 69 to 105 & <0·0001 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 (post) * Intervention & 27 & 1·9 to 53 & 0·035 \\\\ \n    Module 2 (post) * Intervention & 44 & 3·3 to 85 & 0·034 \\\\ \n    Module 3 (post) * Intervention & 77 & 13 to 141 & 0·019 \\\\ \n    Module 4 (post) * Intervention & 113 & 30 to 195 & 0·0078 \\\\ \n    Module 5 (post) * Intervention & 126 & 30 to 223 & 0·011 \\\\ \n    Module 6 (post) * Intervention & 132 & 29 to 236 & 0·013 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 (post) & 0·00 & Ref. &  \\\\ \n    Module 2 (post) & 69 & 55 to 83 & <0·0001 \\\\ \n    Module 3 (post) & 149 & 118 to 180 & <0·0001 \\\\ \n    Module 4 (post) & 217 & 172 to 262 & <0·0001 \\\\ \n    Module 5 (post) & 289 & 235 to 344 & <0·0001 \\\\ \n    Module 6 (post) & 333 & 273 to 393 & <0·0001 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, StGB = German penalty law\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Estimated marginal means\nemm <- emmeans(fit_time_post_module, ~ treatment | timepoint)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nNOTE: A nesting structure was detected in the fitted model:\n    treatment %in% timepoint\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm_df <- as.data.frame(emm)\n\nplt <- ggplot(\n    emm_df, \n    aes(\n      x = timepoint,\n      y = emmean, \n      color = treatment, \n      group = treatment\n    )\n  ) +\n  geom_line() +\n  geom_point(size = 3) +\n  geom_ribbon(\n    aes(\n      ymin = lower.CL, \n      ymax = upper.CL\n    ),\n    alpha = 0.2\n  ) +\n  labs(\n    y = \"Estimated marginal means ± 95%-CI\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n  \nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-time-to-post-module-estimated-marginal-means.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-time-to-post-module-estimated-marginal-means.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n:::\n\n\n![Estimated marginal means of the MMRM for the cumulative time from baseline to finish module. The cumulative time from baseline to finish module is defined as time from beginning of module one to the end of the respective module. Note, that the cumulative time from baseline to finish module consist of the time of working on the content and time for filling in questionnaires and time needed to revise guided tasks (and an undefined error term for doing things not related to the WBI).](_figures/fig-time-to-post-module-estimated-marginal-means.png){#fig-time-to-post-module-estimated-marginal-means width=100%}\n\n::: {.landscape}\n\n\n::: {#tbl-time-to-post-module-pairwise-comparisons .cell tbl-cap='Pairwise comparisons for the cumulative time from baseline to finish module is defined as time from beginning of module one to the end of the respective module. Note, that the cumulative time from baseline to finish module consist of the time of working on the content and time for filling in questionnaires and time needed to revise guided tasks (and an undefined error term for doing things not related to the WBI).'}\n\n```{.r .cell-code .hidden}\ndf_m1toEndModule <- tmp_tmp %>%\n  mutate(timepoint = gsub(\".*([0-9]+).*\", \"\\\\1\", timepoint)) %>%\n  pivot_wider(\n    names_from = timepoint,\n    values_from = Zeit_seit_Beginn_Modul_1_in_Jahren,\n    names_prefix = \"module_\"\n  )\n\n\ntbl <- df_m1toEndModule %>%\n  dplyr::select(-client_id) %>%\n  tbl_summary(\n    by = treatment,\n    statistic = all_continuous() ~ c(\n            \"{mean} ({sd})\",\n            \"{median} ({p25}, {p75})\",\n            \"{min}, {max}\"\n          ),\n    label = list(\n      module_1 = \"Module 1 (advised: 28 days)\",\n      module_2 = \"Module 2 (advised: 56 days)\",\n      module_3 = \"Module 3 (advised: 84 days)\",\n      module_4 = \"Module 4 (advised: 112 days)\",\n      module_5 = \"Module 5 (advised: 140 days)\",\n      module_6 = \"Module 6 (advised: 168 days)\"\n    ),\n    type = list(\n      module_1 = \"continuous2\",\n      module_2 = \"continuous2\",\n      module_3 = \"continuous2\",\n      module_4 = \"continuous2\",\n      module_5 = \"continuous2\",\n      module_6 = \"continuous2\"\n    ),\n    missing_text = \"Missing\"\n  ) %>%\n  # brunner-munzel test\n    add_stat(fns = everything() ~ bm_unpaired_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n      p.value = \"**p**\"\n    ) %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"Q1 = 25th percentile, Q3 = 75th percentile, p~adj~ = Holm-Bonferroni adjusted p.\") %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-pairwise-comparisons.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f60f2042.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-pairwise-comparisons.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-to-post-module-pairwise-comparisons.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f27695ea6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Intervention}  N = 108 & \\textbf{Placebo}  N = 113 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (advised: 28 days)} &  &  & 0·053 & 0·24 \\\\ \n    Mean (SD) & 114 (110) & 87 (76) &  &  \\\\ \n    Median (Q1, Q3) & 69 (43, 151) & 58 (36, 112) &  &  \\\\ \n    Min, Max & 24, 691 & 23, 506 &  &  \\\\ \n    Missing & 2 & 7 &  &  \\\\ \n{\\bfseries Module 2 (advised: 56 days)} &  &  & 0·25 & 0·30 \\\\ \n    Mean (SD) & 162 (126) & 145 (104) &  &  \\\\ \n    Median (Q1, Q3) & 116 (78, 193) & 103 (71, 192) &  &  \\\\ \n    Min, Max & 58, 704 & 56, 635 &  &  \\\\ \n    Missing & 23 & 22 &  &  \\\\ \n{\\bfseries Module 3 (advised: 84 days)} &  &  & 0·10 & 0·30 \\\\ \n    Mean (SD) & 210 (135) & 185 (111) &  &  \\\\ \n    Median (Q1, Q3) & 165 (121, 250) & 152 (103, 229) &  &  \\\\ \n    Min, Max & 88, 938 & 84, 521 &  &  \\\\ \n    Missing & 38 & 37 &  &  \\\\ \n{\\bfseries Module 4 (advised: 112 days)} &  &  & 0·048 & 0·24 \\\\ \n    Mean (SD) & 260 (138) & 223 (122) &  &  \\\\ \n    Median (Q1, Q3) & 226 (153, 336) & 189 (140, 248) &  &  \\\\ \n    Min, Max & 117, 890 & 113, 667 &  &  \\\\ \n    Missing & 46 & 44 &  &  \\\\ \n{\\bfseries Module 5 (advised: 140 days)} &  &  & 0·028 & 0·17 \\\\ \n    Mean (SD) & 325 (161) & 258 (113) &  &  \\\\ \n    Median (Q1, Q3) & 290 (186, 418) & 228 (177, 279) &  &  \\\\ \n    Min, Max & 152, 919 & 141, 649 &  &  \\\\ \n    Missing & 58 & 58 &  &  \\\\ \n{\\bfseries Module 6 (advised: 168 days)} &  &  & 0·13 & 0·30 \\\\ \n    Mean (SD) & 363 (181) & 309 (152) &  &  \\\\ \n    Median (Q1, Q3) & 329 (208, 441) & 259 (208, 347) &  &  \\\\ \n    Min, Max & 174, 965 & 162, 901 &  &  \\\\ \n    Missing & 66 & 58 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlog2 <- readRDS(here::here(\"_data/MBSB/data/input/2024-11-22/mtDatabase_26112024_FINAL/client_clientinterventionprogressdetailed.rds\")) %>% mutate(\n  lesson_duration = (lession_finished - lession_started)) # seconds \n\n# Create complete grid of all combinations\ncomplete_grid <- expand.grid(\n  client_id = unique(log2$client_id),\n  current_module_nr = unique(log2$current_module_nr),\n  current_session_nr = unique(log2$current_session_nr)\n) %>%\n  as_tibble()\n\n# Join with original data and calculate session durations\nlog2_complete <- complete_grid %>%\n  left_join(\n    log2,\n    by = c(\"client_id\", \"current_module_nr\", \"current_session_nr\")\n  ) %>%\n  group_by(client_id, current_module_nr, current_session_nr) %>%\n  mutate(\n    session_duration = ifelse(\n      any(is.na(lesson_duration)),\n      NA_real_,\n      sum(lesson_duration, na.rm = TRUE)\n    )\n  ) %>%\n  ungroup() %>%\n  distinct(client_id, current_module_nr, current_session_nr, .keep_all = TRUE) %>%\n  filter(current_module_nr != 0) %>%\n  filter(current_session_nr != 0)\n\n# Calculate total module duration\nlog2_summary <- log2_complete %>%\n  group_by(client_id, current_module_nr) %>%\n  summarise(\n    total_module_duration = as.numeric(sum(session_duration, na.rm = TRUE) / 3600), .groups = 'drop'\n  ) %>%\n  mutate(\n    total_module_duration = ifelse(\n      total_module_duration == 0,\n      NA_real_,\n      total_module_duration\n\n    )\n  )\n\nlog2_summary <- log2_summary %>% \n  mutate(\n    # total_module_duration = ifelse(\n    #   total_module_duration == 0,\n    #   NA_real_,\n    #   total_module_duration\n    # ),\n    client_id = factor(client_id)\n  ) %>%\n  mutate(\n    timepoint = case_when(\n      current_module_nr == 0 ~ \"Baseline\",\n      current_module_nr == 1 ~ \"Module 1 (post)\",\n      current_module_nr == 2 ~ \"Module 2 (post)\",\n      current_module_nr == 3 ~ \"Module 3 (post)\",\n      current_module_nr == 4 ~ \"Module 4 (post)\",\n      current_module_nr == 5 ~ \"Module 5 (post)\",\n      current_module_nr == 6 ~ \"Module 6 (post)\"\n    )\n  )\n\nlog2_joined <- dat_clean %>%\n  dplyr::select(client_id, treatment, timepoint, module_duration_days) %>%\n  filter(!client_id %in% c(253, 396)) %>%\n  filter(timepoint != \"Baseline\") %>%\n  right_join(log2_summary, by = c(\"client_id\", \"timepoint\")) %>%\n  mutate(\n    time_sum_duration_lections_hours = ifelse(\n      is.na(module_duration_days),\n      NA_real_,\n      total_module_duration\n    ),\n    timepoint = factor(timepoint)\n  ) %>%\n  filter(!is.na(treatment)) %>%\n  mutate(\n    timepoint = case_when(\n      current_module_nr == 0 ~ \"Baseline\",\n      current_module_nr == 1 ~ \"Module 1 (post)\",\n      current_module_nr == 2 ~ \"Module 2 (post)\",\n      current_module_nr == 3 ~ \"Module 3 (post)\",\n      current_module_nr == 4 ~ \"Module 4 (post)\",\n      current_module_nr == 5 ~ \"Module 5 (post)\",\n      current_module_nr == 6 ~ \"Module 6 (post)\"\n    )\n  )\n```\n:::\n\n\n### Time working on module\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# RAIN plot (descriptive)\nplt <- ggplot(log2_joined, aes(fill = treatment, x = timepoint, y = time_sum_duration_lections_hours, color = treatment)\n  ) +\n  ggrain::geom_rain(\n    seed = 42,\n    rain.side = 'r',\n    #id.long.var = \"time_sum_duration_lections_hours\",\n    point.args = list(\n      alpha = 0.3,\n      shape = 21\n    ),\n    point.args.pos = rlang::list2(\n      position = position_jitter(\n        seed = 42,\n        width = 0.1,\n        height = 0.1\n      )\n    ),\n    boxplot.args = list(\n      outlier.shape = NA,\n      color = \"black\",\n      alpha = .7\n    ),\n    boxplot.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .25,\n        width = 0.2\n      ), \n      width = 0.15\n    ),\n    violin.args = list(\n      alpha = .2\n    ),\n    violin.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .4,\n        width = 0\n      ), \n      width = 1.2\n    ),\n  ) +\n  labs(\n    y = \"Time working on content (hours)\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n\nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-time-working-on-module-rainplot.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-time-working-on-module-rainplot.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 466 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n:::\n\n\n![Rainplot for time working on content by module. The time working on content is defined as the sum of the time from creating a data base entry for lection data (at first visit of the lection page) to the time last change of database entry for this lection data occured for each lection the participant worked on in one module. This time difference can be interpreted as a narrow estimator for the time needed to finish the content of a WBI without the time needed for filling in questionnaires, reviews of guided tasks, or waiting times. But it includes the time needed for first answer of a guided exercise and times, in which the participant not logged in or logged in but not worked on the lection.](_figures/fig-time-working-on-module-rainplot.png){#fig-time-working-on-module-rainplot width=100%}\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(mmrm)\n\nformular <- as.formula(\n  paste(\n      \"time_sum_duration_lections_hours ~ timepoint + treatment:timepoint + us(timepoint | client_id)\"\n  )\n)\n\nfit_time_post_module <- mmrm(\n    formula = formular,\n    data = log2_joined %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n    dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\")) %>% mutate(timepoint = factor(timepoint))\n)\n```\n:::\n\n\n\n::: {#tbl-time-working-on-module-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for time working on content of one module of the WBI. The time working on content is defined as the sum of the time from creating a data base entry for lection data (at first visit of the lection page) to the time last change of database entry for this lection data occured for each lection the participant worked on in one module. This time difference can be interpreted as a narrow estimator for the time needed to finish the content of a WBI without the time needed for filling in questionnaires, reviews of guided tasks, or waiting times. But it includes the time needed for first answer of a guided exercise and times, in which the participant not logged in or logged in but not worked on the lection.'}\n\n```{.r .cell-code .hidden}\ntbl <- fit_time_post_module %>%\n    tbl_regression(\n      add_estimate_to_reference_rows = TRUE,\n      intercept = TRUE,\n      label = list(\n        treatment = \"Treatment\",\n        timepoint = \"Timepoint\",\n        `Timepoint * treatment` = \"Timepoint * treatment\"\n      )\n    ) %>%\n    modify_header(label ~ \"**Variable**\") %>%\n    remove_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"CI = Confidence Interval, StGB = German penalty law.\") %>%\n    modify_column_alignment(columns = everything(), align = \"left\") %>%\n    modify_table_styling(\n        columns = c(estimate, conf.low, conf.high),\n        rows = reference_row %in% TRUE,\n        missing_symbol = \"Ref.\"\n    ) %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f6b89ab28.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-mmrm.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f27cb8a0c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}llll}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 349 & 129 to 570 & 0·0020 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 (post) * Intervention & 360 & 49 to 671 & 0·024 \\\\ \n    Module 2 (post) * Intervention & 148 & -48 to 345 & 0·14 \\\\ \n    Module 3 (post) * Intervention & 188 & -96 to 473 & 0·19 \\\\ \n    Module 4 (post) * Intervention & 236 & 19 to 453 & 0·034 \\\\ \n    Module 5 (post) * Intervention & 324 & 6·1 to 641 & 0·046 \\\\ \n    Module 6 (post) * Intervention & 93 & -142 to 328 & 0·42 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 (post) & 0·00 & Ref. &  \\\\ \n    Module 2 (post) & -130 & -317 to 57 & 0·17 \\\\ \n    Module 3 (post) & -18 & -255 to 219 & 0·88 \\\\ \n    Module 4 (post) & -106 & -327 to 115 & 0·34 \\\\ \n    Module 5 (post) & -33 & -304 to 237 & 0·81 \\\\ \n    Module 6 (post) & -95 & -327 to 137 & 0·42 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(emmeans)\n\n# Estimated marginal means\nemm <- emmeans(fit_time_post_module, ~ treatment | timepoint)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nNOTE: A nesting structure was detected in the fitted model:\n    treatment %in% timepoint\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm_df <- as.data.frame(emm)\n\nplt <- ggplot(\n    emm_df, \n    aes(\n      x = timepoint,\n      y = emmean, \n      color = treatment, \n      group = treatment\n    )\n  ) +\n  geom_line() +\n  geom_point(size = 3) +\n  geom_ribbon(\n    aes(\n      ymin = lower.CL, \n      ymax = upper.CL\n    ),\n    alpha = 0.2\n  ) +\n  labs(\n    y = \"Estimated marginal means ± 95%-CI\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n  \nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-time-working-on-module-estimated-marginal-means.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-time-working-on-module-estimated-marginal-means.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n:::\n\n\n![Estimated marginal means for for time working on content of one module of the WBI. The time working on content is defined as the sum of the time from creating a data base entry for lection data (at first visit of the lection page) to the time last change of database entry for this lection data occured for each lection the participant worked on in one module. This time difference can be interpreted as a narrow estimator for the time needed to finish the content of a WBI without the time needed for filling in questionnaires, reviews of guided tasks, or waiting times. But it includes the time needed for first answer of a guided exercise and times, in which the participant not logged in or logged in but not worked on the lection.](_figures/fig-time-working-on-module-estimated-marginal-means.png){#fig-time-working-on-module-estimated-marginal-means width=100%}\n\n::: {.landscape}\n\n\n::: {#tbl-time-working-on-module .cell tbl-cap='Pairwise comparisons for time working on content by module. The time working on content is defined as the sum of the time from creating a data base entry for lection data (at first visit of a lection page) to the time last change of database entry for this lection data occured for each lection the participant worked on in one module. This time difference can be interpreted as a narrow estimator for the time needed to finish the content of a WBI without the time needed for filling in questionnaires, reviews of guided tasks, or waiting times. But it includes the time needed for first answer of a guided exercise and times, in which the participant not logged in or logged in but not worked on the lection.'}\n\n```{.r .cell-code .hidden}\ndf_working_time <- log2_joined %>%\n  mutate(timepoint = gsub(\".*([0-9]+).*\", \"\\\\1\", timepoint)) %>%\n  pivot_wider(\n    names_from = timepoint,\n    values_from = time_sum_duration_lections_hours,\n    names_prefix = \"module_\"\n  ) %>%\n  select(-module_duration_days, - current_module_nr, - total_module_duration)\n\ndf_wide <- df_working_time %>%\n  group_by(client_id) %>%\n  summarise(\n    across(\n      starts_with(\"module_\"),\n      ~ if (all(is.na(.x))) NA_real_ else first(na.omit(.x))\n    ),\n    treatment = first(treatment),\n    .groups = \"drop\"\n  )\n\n\ntbl <- df_wide %>%\n  dplyr::select(-client_id) %>%\n  tbl_summary(\n    by = treatment,\n    statistic = all_continuous() ~ c(\n            \"{mean} ({sd})\",\n            \"{median} ({p25}, {p75})\",\n            \"{min}, {max}\"\n          ),\n    label = list(\n      module_1 = \"Module 1 (pre-tests: about 4 hours)\",\n      module_2 = \"Module 2 (pre-tests: about 4 hours)\",\n      module_3 = \"Module 3 (pre-tests: about 4 hours)\",\n      module_4 = \"Module 4 (pre-tests: about 4 hours)\",\n      module_5 = \"Module 5 (pre-tests: about 4 hours)\",\n      module_6 = \"Module 6 (pre-tests: about 4 hours)\"\n    ),\n    type = list(\n      module_1 = \"continuous2\",\n      module_2 = \"continuous2\",\n      module_3 = \"continuous2\",\n      module_4 = \"continuous2\",\n      module_5 = \"continuous2\",\n      module_6 = \"continuous2\"\n    ),\n    missing_text = \"Missing\"\n  ) %>%\n  # brunner-munzel test\n    add_stat(fns = everything() ~ bm_unpaired_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n      p.value = \"**p**\"\n    ) %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"Q1 = 25th percentile, Q3 = 75th percentile, p~adj~ = Holm-Bonferroni adjusted p.\") %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-pairwise-comparisons.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1fced7cb.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-pairwise-comparisons.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-time-working-on-module-pairwise-comparisons.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f79662d21.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Intervention}  N = 108 & \\textbf{Placebo}  N = 113 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (pre-tests: about 4 hours)} &  &  & 0·18 & >0·99 \\\\ \n    Mean (SD) & 709 (1 500) & 349 (629) &  &  \\\\ \n    Median (Q1, Q3) & 49 (2, 637) & 12 (2, 498) &  &  \\\\ \n    Min, Max & 1, 9 549 & 0, 3 242 &  &  \\\\ \n    Missing & 2 & 7 &  &  \\\\ \n{\\bfseries Module 2 (pre-tests: about 4 hours)} &  &  & 0·77 & >0·99 \\\\ \n    Mean (SD) & 273 (668) & 218 (553) &  &  \\\\ \n    Median (Q1, Q3) & 11 (1, 193) & 4 (1, 157) &  &  \\\\ \n    Min, Max & 0, 3 825 & 0, 3 962 &  &  \\\\ \n    Missing & 24 & 22 &  &  \\\\ \n{\\bfseries Module 3 (pre-tests: about 4 hours)} &  &  & 0·46 & >0·99 \\\\ \n    Mean (SD) & 283 (561) & 237 (680) &  &  \\\\ \n    Median (Q1, Q3) & 29 (2, 258) & 4 (2, 120) &  &  \\\\ \n    Min, Max & 1, 3 137 & 0, 4 762 &  &  \\\\ \n    Missing & 39 & 38 &  &  \\\\ \n{\\bfseries Module 4 (pre-tests: about 4 hours)} &  &  & 0·89 & >0·99 \\\\ \n    Mean (SD) & 293 (620) & 145 (297) &  &  \\\\ \n    Median (Q1, Q3) & 4 (1, 173) & 4 (2, 89) &  &  \\\\ \n    Min, Max & 1, 3 586 & 0, 1 019 &  &  \\\\ \n    Missing & 47 & 45 &  &  \\\\ \n{\\bfseries Module 5 (pre-tests: about 4 hours)} &  &  & 0·25 & >0·99 \\\\ \n    Mean (SD) & 398 (775) & 126 (297) &  &  \\\\ \n    Median (Q1, Q3) & 22 (2, 391) & 5 (3, 76) &  &  \\\\ \n    Min, Max & 1, 3 364 & 1, 1 464 &  &  \\\\ \n    Missing & 58 & 58 &  &  \\\\ \n{\\bfseries Module 6 (pre-tests: about 4 hours)} &  &  & 0·95 & >0·99 \\\\ \n    Mean (SD) & 202 (603) & 139 (361) &  &  \\\\ \n    Median (Q1, Q3) & 2 (1, 93) & 2 (1, 40) &  &  \\\\ \n    Min, Max & 1, 3 564 & 0, 1 655 &  &  \\\\ \n    Missing & 66 & 60 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n:::\n\n\n{{< pagebreak >}}\n\n## Primary Outcomes\n\n### CARES\n\n<!-- RAIN PLOT -->\n![Rainplot of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score).](_figures/fig-cares-rainplot.png){#fig-cares-rainplot}\n\n<!-- ESTIMATED MARGINAL MEANS -->\n![Estimated marginal means of the MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score).](_figures/fig-cares-estimated-marginal-means.png){#fig-cares-estimated-marginal-means}\n\n<!-- MMRM -->\n\n::: {#tbl-prim-cares-mmrm-time-since-baseline .cell tbl-cap='Explorative MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) with time since baseline as additional factor. Time since baseline is defined as the time between the baseline measurement and the respective consecutive measurement time-point.'}\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- fit2_c %>%\n    tbl_regression(\n      add_estimate_to_reference_rows = TRUE,\n      intercept = TRUE,\n      label = list(\n        static99_modified_calc = \"Static recidivism risk\",\n        Aktuelle_Betreuung = \"Type of supervision\",\n        Aktuelle_zusatzliche_Behandlung = \"Additional treatment\",\n        Indexdelikt = \"Offense type\",\n        IoD_reduced_baseline = \"Baseline value\",\n        Zeit_seit_Beginn_Modul_1_in_Jahren = \"Time since baseline (years)\",\n        treatment = \"Treatment\",\n        timepoint = \"Timepoint\",\n        `Timepoint * treatment` = \"Timepoint * treatment\"\n      )\n    ) %>%\n    modify_header(label ~ \"**Variable**\") %>%\n    remove_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"StGB = German penalty law\") %>%\n    modify_column_alignment(columns = everything(), align = \"left\") %>%\n    modify_table_styling(\n        columns = c(estimate, conf.low, conf.high),\n        rows = reference_row %in% TRUE,\n        missing_symbol = \"Ref.\"\n    ) %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-mmrm-time-since-baseline.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f2a95cf33.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-mmrm-time-since-baseline.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-mmrm-time-since-baseline.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f11ed601b.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}llll}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & -0·09 & -1·7 to 1·5 & 0·91 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & 0·31 & -1·2 to 1·8 & 0·68 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & -1·0 & -2·2 to 0·19 & 0·10 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 0·99 & -0·24 to 2·2 & 0·11 \\\\ \n{\\bfseries Baseline value} & 0·84 & 0·77 to 0·91 & <0·0001 \\\\ \n{\\bfseries Static recidivism risk} & 0·40 & -0·11 to 0·90 & 0·12 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 (post) * Intervention & 0·47 & -0·75 to 1·7 & 0·45 \\\\ \n    Module 2 (post) * Intervention & -0·87 & -2·5 to 0·76 & 0·29 \\\\ \n    Module 3 (post) * Intervention & -0·19 & -1·8 to 1·4 & 0·82 \\\\ \n    Module 4 (post) * Intervention & -0·07 & -1·6 to 1·5 & 0·93 \\\\ \n    Module 5 (post) * Intervention & 0·07 & -1·8 to 2·0 & 0·94 \\\\ \n    Module 6 (post) * Intervention & -0·39 & -2·4 to 1·6 & 0·70 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 (post) & 0·00 & Ref. &  \\\\ \n    Module 2 (post) & 1·2 & 0·17 to 2·2 & 0·022 \\\\ \n    Module 3 (post) & -0·09 & -1·1 to 0·94 & 0·86 \\\\ \n    Module 4 (post) & -0·01 & -1·2 to 1·2 & 0·98 \\\\ \n    Module 5 (post) & 0·75 & -0·65 to 2·1 & 0·29 \\\\ \n    Module 6 (post) & 0·99 & -0·41 to 2·4 & 0·17 \\\\ \n{\\bfseries Time since baseline (years)} & -1·2 & -2·4 to 0·01 & 0·051 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, StGB = German penalty law\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n![Estimated marginal means  of the MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) with time since baseline as additional factor.](_figures/fig-cares-estimated-marginal-means-time-since-baseline.png){#fig-cares-estimated-marginal-means-time-since-baseline}\n\n<!-- SENSITIVITY ANALYSIS -->\n\n::: {#tbl-prim-cares-sensitivity-analysis .cell tbl-cap='Sensitivity analysis for primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score). The table summarizes the results of a reference-based multiple imputation followed by ANCOVA models for the difference in the CARES compared to baseline.'}\n\n```{.r .cell-code .hidden}\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- rbmi_cares_tab %>%\n      gt() %>%\n      gt::cols_label(\n        \"est\" = \"Estimate\",\n        \"ci\" = \"95% CI\",\n        \"pval\" = \"p\",\n        \"parameter\" = \"Parameter\"\n      ) %>%\n      gt::tab_options(\n          table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n      ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-sensitivity-analysis.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f3cf2b8cf.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-sensitivity-analysis.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-sensitivity-analysis.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f4c6a97de.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lrrl}\n\\toprule\nParameter & Estimate & 95\\% CI & p \\\\ \n\\midrule\\addlinespace[2.5pt]\nGroup differences Module 1 (post) & -0.90 & (-2.21, 1.06) & 0.385 \\\\ \nLeast square mean [intervention] Module 1 (post) & 24.20 & (22.07, 25.21) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 1 (post) & 23.30 & (21.28, 24.98) & *< 0.001* \\\\ \nGroup differences Module 2 (post) & 0.46 & (-1.35, 2.91) & 0.994 \\\\ \nLeast square mean [intervention] Module 2 (post) & 22.89 & (20.56, 24.74) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 2 (post) & 23.35 & (20.23, 25.45) & *< 0.001* \\\\ \nGroup differences Module 3 (post) & 0.88 & (-1.08, 3.53) & 0.169 \\\\ \nLeast square mean [intervention] Module 3 (post) & 20.30 & (17.36, 22.49) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 3 (post) & 21.18 & (19.1, 23.89) & *< 0.001* \\\\ \nGroup differences Module 4 (post) & 0.41 & (-1.6, 3.04) & 0.964 \\\\ \nLeast square mean [intervention] Module 4 (post) & 20.09 & (17.56, 21.86) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 4 (post) & 20.50 & (18, 22.75) & *< 0.001* \\\\ \nGroup differences Module 5 (post) & 0.36 & (-2.65, 3.61) & 0.832 \\\\ \nLeast square mean [intervention] Module 5 (post) & 20.53 & (15.88, 22.31) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 5 (post) & 20.89 & (17.85, 23.46) & *< 0.001* \\\\ \nGroup differences Module 6 (post) & 2.27 & (-0.81, 4.84) & 0.172 \\\\ \nLeast square mean [intervention] Module 6 (post) & 18.09 & (15.81, 19.75) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 6 (post) & 20.35 & (18.22, 22.75) & *< 0.001* \\\\ \n\\bottomrule\n\\end{tabular*}\n\\end{table}\n\n:::\n:::\n\n\n<!-- PAIRWISE COMPARISONS -->\n\n::: {#tbl-prim-cares-pairwise-intervention .cell tbl-cap='Pairwise comparisons of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) for the intervention arm.'}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nsource(here::here(\"_scripts/prim_pairwise_functions.R\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'purrr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:car':\n\n    some\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:magrittr':\n\n    set_names\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD_reduced\"\ntbl <- create_prim_pairwise_tbls(variable, subgroup_str = \"Intervention\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Using an external vector in selections was deprecated in tidyselect 1.1.0.\ni Please use `all_of()` or `any_of()` instead.\n  # Was:\n  data %>% select(variable)\n\n  # Now:\n  data %>% select(all_of(variable))\n\nSee <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1557e18a.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f633c779c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·0050 & 0·030 \\\\ \n    Mean (SD) & 14 (8) & 12 (9) &  &  \\\\ \n    Median (Q1, Q3) & 13 (8, 18) & 12 (6, 16) &  &  \\\\ \n    Min, Max & 1, 40 & 0, 40 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·58 & >0·99 \\\\ \n    Mean (SD) & 12 (8) & 12 (8) &  &  \\\\ \n    Median (Q1, Q3) & 12 (6, 15) & 11 (5, 17) &  &  \\\\ \n    Min, Max & 0, 40 & 0, 30 &  &  \\\\ \n    Missing & 22 & 22 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·010 & 0·050 \\\\ \n    Mean (SD) & 11 (8) & 10 (8) &  &  \\\\ \n    Median (Q1, Q3) & 11 (4, 17) & 9 (5, 16) &  &  \\\\ \n    Min, Max & 0, 28 & 0, 39 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·89 & >0·99 \\\\ \n    Mean (SD) & 11 (8) & 11 (8) &  &  \\\\ \n    Median (Q1, Q3) & 10 (6, 16) & 10 (5, 16) &  &  \\\\ \n    Min, Max & 0, 39 & 0, 30 &  &  \\\\ \n    Missing & 46 & 46 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·44 & >0·99 \\\\ \n    Mean (SD) & 10 (7) & 11 (9) &  &  \\\\ \n    Median (Q1, Q3) & 9 (4, 14) & 10 (4, 15) &  &  \\\\ \n    Min, Max & 0, 30 & 0, 50 &  &  \\\\ \n    Missing & 56 & 56 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & >0·99 & >0·99 \\\\ \n    Mean (SD) & 10 (7) & 9 (6) &  &  \\\\ \n    Median (Q1, Q3) & 8 (4, 15) & 9 (5, 13) &  &  \\\\ \n    Min, Max & 0, 25 & 0, 24 &  &  \\\\ \n    Missing & 64 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-prim-cares-pairwise-placebo .cell tbl-cap='Pairwise comparisons of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) for the placebo arm.'}\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD_reduced\"\ntbl <- create_prim_pairwise_tbls(variable, subgroup_str = \"Placebo\")\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f66d4a196.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f23f9de7f.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & <0·0001 & <0·0001 \\\\ \n    Mean (SD) & 12 (7) & 11 (8) &  &  \\\\ \n    Median (Q1, Q3) & 11 (7, 16) & 9 (4, 16) &  &  \\\\ \n    Min, Max & 0, 31 & 0, 35 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·050 & 0·21 \\\\ \n    Mean (SD) & 10 (8) & 11 (8) &  &  \\\\ \n    Median (Q1, Q3) & 8 (4, 16) & 10 (5, 14) &  &  \\\\ \n    Min, Max & 0, 35 & 0, 36 &  &  \\\\ \n    Missing & 15 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·041 & 0·21 \\\\ \n    Mean (SD) & 12 (9) & 10 (8) &  &  \\\\ \n    Median (Q1, Q3) & 10 (5, 18) & 8 (5, 14) &  &  \\\\ \n    Min, Max & 0, 36 & 0, 32 &  &  \\\\ \n    Missing & 31 & 31 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·98 & >0·99 \\\\ \n    Mean (SD) & 10 (7) & 10 (7) &  &  \\\\ \n    Median (Q1, Q3) & 8 (5, 14) & 8 (5, 14) &  &  \\\\ \n    Min, Max & 0, 29 & 0, 37 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·78 & >0·99 \\\\ \n    Mean (SD) & 9 (8) & 10 (8) &  &  \\\\ \n    Median (Q1, Q3) & 7 (4, 13) & 7 (4, 14) &  &  \\\\ \n    Min, Max & 0, 37 & 1, 32 &  &  \\\\ \n    Missing & 51 & 51 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & 0·62 & >0·99 \\\\ \n    Mean (SD) & 10 (8) & 10 (8) &  &  \\\\ \n    Median (Q1, Q3) & 7 (4, 14) & 7 (4, 13) &  &  \\\\ \n    Min, Max & 1, 32 & 1, 35 &  &  \\\\ \n    Missing & 53 & 53 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-prim-cares-diffscore .cell tbl-cap='Pairwise comparisons of difference from baseline of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score).'}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nsource(here::here(\"_scripts/prim_diffscore_functions.R\"))\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD_reduced\"\ntbl <- create_prim_diffscore_tbl(variable)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Using an external vector in selections was deprecated in tidyselect 1.1.0.\ni Please use `all_of()` or `any_of()` instead.\n  # Was:\n  data %>% select(grouping_var)\n\n  # Now:\n  data %>% select(all_of(grouping_var))\n\nSee <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-diffscore.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f4bc5688c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-diffscore.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-cares-diffscore.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f380526ff.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 106 & \\textbf{Intervention}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·68 & >0·99 \\\\ \n    Mean (SD) & -1·5 (4·2) & -1·3 (5·0) &  &  \\\\ \n    Median (Q1, Q3) & -1·0 (-4·0, 1·0) & -1·0 (-4·0, 2·0) &  &  \\\\ \n    Min, Max & -13·0, 12·0 & -21·0, 15·0 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·052 & 0·31 \\\\ \n    Mean (SD) & 1·0 (5·5) & -0·3 (3·9) &  &  \\\\ \n    Median (Q1, Q3) & 1·0 (-2·0, 4·0) & -1·0 (-2·0, 2·0) &  &  \\\\ \n    Min, Max & -17·0, 32·0 & -14·0, 8·0 &  &  \\\\ \n    Missing & 15 & 22 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·51 & >0·99 \\\\ \n    Mean (SD) & -1·5 (5·5) & -0·8 (4·1) &  &  \\\\ \n    Median (Q1, Q3) & -1·0 (-3·0, 1·0) & -1·0 (-3·0, 1·0) &  &  \\\\ \n    Min, Max & -34·0, 11·0 & -13·0, 12·0 &  &  \\\\ \n    Missing & 31 & 38 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·98 & >0·99 \\\\ \n    Mean (SD) & 0·0 (4·3) & -0·2 (3·5) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-2·0, 2·0) & 0·0 (-2·0, 2·0) &  &  \\\\ \n    Min, Max & -11·0, 13·0 & -9·0, 9·0 &  &  \\\\ \n    Missing & 38 & 46 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·86 & >0·99 \\\\ \n    Mean (SD) & 0·6 (4·9) & 0·7 (4·8) &  &  \\\\ \n    Median (Q1, Q3) & 1·0 (-3·0, 3·0) & 0·0 (-2·0, 2·0) &  &  \\\\ \n    Min, Max & -14·0, 16·0 & -10·0, 21·0 &  &  \\\\ \n    Missing & 51 & 56 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & 0·85 & >0·99 \\\\ \n    Mean (SD) & 0·21 (3·01) & -0·17 (3·88) &  &  \\\\ \n    Median (Q1, Q3) & 0·00 (-1·00, 2·00) & 0·00 (-2·00, 2·00) &  &  \\\\ \n    Min, Max & -9·00, 6·00 & -16·00, 9·00 &  &  \\\\ \n    Missing & 53 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- RAIN PLOT -->\n![Rainplot of primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES difference from baseline scores).](_figures/fig-cares-rainplot-difference-from-baseline.png){#fig-cares-rainplot-difference-from-baseline}\n\n{{< pagebreak >}}\n\n### Index of Desistance (IoD)\n\n<!-- RAIN PLOT -->\n![Rainplot of the Index of Desistance (IoD total score). Note, that the IoD is the preliminary version of the CARES and mentioned in the Statistical analysis protocol as primary outcome.](_figures/fig-iod-rainplot.png){#fig-iod-rainplot}\n\n\n<!-- MMRM -->\n\n::: {#tbl-prim-iod-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for the Index of Desistance (IoD total score).'}\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- fit %>%\n    tbl_regression(\n      add_estimate_to_reference_rows = TRUE,\n      intercept = TRUE,\n      label = list(\n        static99_modified_calc = \"Static recidivism risk\",\n        Aktuelle_Betreuung = \"Type of supervision\",\n        Aktuelle_zusatzliche_Behandlung = \"Additional treatment\",\n        Indexdelikt = \"Offense type\",\n        IoD_reduced_baseline = \"Baseline value\",\n        Zeit_seit_Beginn_Modul_1_in_Jahren = \"Time since baseline (years)\",\n        treatment = \"Treatment\",\n        timepoint = \"Timepoint\",\n        `Timepoint * treatment` = \"Timepoint * Treatment\"\n      )\n    ) %>%\n    modify_header(label ~ \"**Variable**\") %>%\n    remove_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"CI = Confidence Interval, StGB = German penalty law.\") %>%\n    modify_column_alignment(columns = everything(), align = \"left\") %>%\n    modify_table_styling(\n        columns = c(estimate, conf.low, conf.high),\n        rows = reference_row %in% TRUE,\n        missing_symbol = \"Ref.\"\n    ) %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f301bbbc9.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f70676fb6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm.docx\")))\n\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}llll}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 3·1 & 1·2 to 5·0 & 0·0017 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & 1·2 & -0·29 to 2·8 & 0·11 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & -1·3 & -2·5 to -0·10 & 0·034 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 1·2 & -0·08 to 2·4 & 0·065 \\\\ \n{\\bfseries IoD\\_baseline} & 0·88 & 0·83 to 0·92 & <0·0001 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Baseline & 0·00 & Ref. &  \\\\ \n    Module 1 (post) & -2·2 & -4·2 to -0·27 & 0·027 \\\\ \n    Module 2 (post) & -2·9 & -4·9 to -0·95 & 0·0040 \\\\ \n    Module 3 (post) & -5·0 & -7·0 to -2·9 & <0·0001 \\\\ \n    Module 4 (post) & -5·4 & -7·5 to -3·2 & <0·0001 \\\\ \n    Module 5 (post) & -3·9 & -6·2 to -1·6 & 0·0009 \\\\ \n    Module 6 (post) & -4·7 & -7·1 to -2·3 & 0·0001 \\\\ \n{\\bfseries Treatment} &  &  &  \\\\ \n    Intervention & 0·00 & Ref. &  \\\\ \n    Placebo & -0·30 & -2·2 to 1·5 & 0·75 \\\\ \n{\\bfseries Treatment * Timepoint} &  &  &  \\\\ \n    Placebo * Module 1 (post) & -0·50 & -3·3 to 2·3 & 0·71 \\\\ \n    Placebo * Module 2 (post) & 0·71 & -2·1 to 3·5 & 0·62 \\\\ \n    Placebo * Module 3 (post) & 0·41 & -2·5 to 3·3 & 0·78 \\\\ \n    Placebo * Module 4 (post) & 1·1 & -1·9 to 4·1 & 0·47 \\\\ \n    Placebo * Module 5 (post) & 0·84 & -2·4 to 4·0 & 0·61 \\\\ \n    Placebo * Module 6 (post) & 1·9 & -1·4 to 5·1 & 0·26 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- ESTIMATED MARGINAL MEANS -->\n![Estimated marginal means of the MMRM for the IoD total score.](_figures/fig-iod-estimated-marginal-means.png){#fig-iod-estimated-marginal-means}\n\n<!-- MMRM -->\n\n::: {#tbl-prim-iod-mmrm-time-since-baseline .cell tbl-cap='Explorative MMRM for Index of Desistance (IoD total score) with the additional factor time since beginning of the first module. StGB = German penalty law.'}\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- fit1_c %>%\n    tbl_regression(\n      add_estimate_to_reference_rows = TRUE,\n      intercept = TRUE,\n      label = list(\n        static99_modified_calc = \"Static recidivism risk\",\n        Aktuelle_Betreuung = \"Type of supervision\",\n        Aktuelle_zusatzliche_Behandlung = \"Additional treatment\",\n        Indexdelikt = \"Offense type\",\n        IoD_reduced_baseline = \"Baseline value\",\n        Zeit_seit_Beginn_Modul_1_in_Jahren = \"Time since baseline (years)\",\n        treatment = \"Treatment\",\n        timepoint = \"Timepoint\",\n        `Timepoint * treatment` = \"Timepoint * Treatment\"\n      )\n    ) %>%\n    modify_header(label ~ \"**Variable**\") %>%\n    remove_abbreviation(\"CI = Confidence Interval\") %>%\n    modify_abbreviation(\"CI = Confidence Interval, StGB = German penalty law.\") %>%\n    modify_column_alignment(columns = everything(), align = \"left\") %>%\n    modify_table_styling(\n        columns = c(estimate, conf.low, conf.high),\n        rows = reference_row %in% TRUE,\n        missing_symbol = \"Ref.\"\n    ) %>%\n    bold_labels() %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm-time-since-baseline.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1d56dab8.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm-time-since-baseline.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-mmrm-time-since-baseline.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f2ab92e21.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}llll}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 0·35 & -2·5 to 3·2 & 0·81 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & 1·2 & -1·3 to 3·6 & 0·34 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & -1·7 & -3·6 to 0·27 & 0·092 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 1·8 & -0·17 to 3·8 & 0·073 \\\\ \n{\\bfseries IoD\\_baseline} & 0·83 & 0·75 to 0·90 & <0·0001 \\\\ \n{\\bfseries Static recidivism risk} & 0·57 & -0·25 to 1·4 & 0·17 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 (post) * Intervention & 0·91 & -1·0 to 2·9 & 0·36 \\\\ \n    Module 2 (post) * Intervention & -0·26 & -3·0 to 2·4 & 0·85 \\\\ \n    Module 3 (post) * Intervention & 0·26 & -2·3 to 2·8 & 0·84 \\\\ \n    Module 4 (post) * Intervention & -0·55 & -3·1 to 2·0 & 0·67 \\\\ \n    Module 5 (post) * Intervention & -0·16 & -3·3 to 3·0 & 0·92 \\\\ \n    Module 6 (post) * Intervention & -1·6 & -4·6 to 1·4 & 0·30 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 (post) & 0·00 & Ref. &  \\\\ \n    Module 2 (post) & 0·63 & -0·99 to 2·3 & 0·44 \\\\ \n    Module 3 (post) & -1·6 & -3·3 to 0·08 & 0·061 \\\\ \n    Module 4 (post) & -1·3 & -3·3 to 0·63 & 0·18 \\\\ \n    Module 5 (post) & -0·33 & -2·6 to 2·0 & 0·78 \\\\ \n    Module 6 (post) & -0·01 & -2·3 to 2·3 & >0·99 \\\\ \n{\\bfseries Time since baseline (years)} & -0·56 & -2·5 to 1·4 & 0·57 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n![Estimated marginal means of the MMRM for the Index of Desistance (IoD total score) with time since baseline as additional factor.](_figures/fig-iod-estimated-marginal-means-time-since-baseline.png){#fig-iod-estimated-marginal-means-time-since-baseline}\n\n<!-- SENSITIVITY ANALYSIS -->\n\n::: {#tbl-prim-iod-sensitivity-analysis .cell tbl-cap='Sensitivity analysis for the Index of Desistance (IoD total score). Summarized are the results of the reference-based multiple imputation followed by ANCOVA models for the difference in the IoD (total score) compared to baseline.'}\n\n```{.r .cell-code .hidden}\nlibrary(gt)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- rbmi_tab %>%\n  gt() %>%\n  gt::cols_label(\n    \"est\" = \"Estimate\",\n    \"ci\" = \"95% CI\",\n    \"pval\" = \"p\",\n    \"parameter\" = \"Parameter\"\n  ) %>%\n  gt::tab_options(\n    table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n  ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-sensitivity-analysis.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f42f56255.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-sensitivity-analysis.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-sensitivity-analysis.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f77d85ce7.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lrrl}\n\\toprule\nParameter & Estimate & 95\\% CI & p \\\\ \n\\midrule\\addlinespace[2.5pt]\nGroup differences Module 1 (post) & -0.78 & (-2.52, 0.91) & 0.372 \\\\ \nLeast square mean [intervention] Module 1 (post) & -2.09 & (-3.69, -1.49) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 1 (post) & -2.87 & (-4.4, -1.83) & *< 0.001* \\\\ \nGroup differences Module 2 (post) & 0.08 & (-2.53, 2.96) & 0.964 \\\\ \nLeast square mean [intervention] Module 2 (post) & -2.56 & (-4.53, -1.45) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 2 (post) & -2.47 & (-5.28, -0.12) & *< 0.001* \\\\ \nGroup differences Module 3 (post) & -0.38 & (-2.5, 2.41) & 0.982 \\\\ \nLeast square mean [intervention] Module 3 (post) & -4.40 & (-6.67, -2.51) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 3 (post) & -4.78 & (-6.45, -2.8) & *< 0.001* \\\\ \nGroup differences Module 4 (post) & 0.46 & (-1.95, 3.43) & 0.836 \\\\ \nLeast square mean [intervention] Module 4 (post) & -4.99 & (-6.59, -2.53) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 4 (post) & -4.54 & (-5.88, -2.89) & *< 0.001* \\\\ \nGroup differences Module 5 (post) & 0.14 & (-2.34, 3.34) & 0.878 \\\\ \nLeast square mean [intervention] Module 5 (post) & -3.75 & (-6.48, -2.2) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 5 (post) & -3.61 & (-6.38, -2.19) & *< 0.001* \\\\ \nGroup differences Module 6 (post) & 1.52 & (-1.87, 3.49) & 0.186 \\\\ \nLeast square mean [intervention] Module 6 (post) & -4.90 & (-6.01, -2.8) & *< 0.001* \\\\ \nLeast square mean [placebo] Module 6 (post) & -3.38 & (-4.82, -1.99) & *< 0.001* \\\\ \n\\bottomrule\n\\end{tabular*}\n\\end{table}\n\n:::\n:::\n\n\n<!-- PAIRWISE COMPARISONS -->\n\n\n::: {#tbl-prim-iod-pairwise-intervention .cell tbl-cap='Explorative pairwise comparison of the Index of Desistance (IoD total score) for the intervention arm.'}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nsource(here::here(\"_scripts/prim_pairwise_functions.R\"))\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD\"\ntbl <- create_prim_pairwise_tbls(variable, subgroup_str = \"Intervention\")\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5abd9077.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f764a9c5b.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·0050 & 0·025 \\\\ \n    Mean (SD) & 28 (13) & 25 (13) &  &  \\\\ \n    Median (Q1, Q3) & 26 (19, 33) & 24 (16, 30) &  &  \\\\ \n    Min, Max & 5, 70 & 2, 70 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·70 & >0·99 \\\\ \n    Mean (SD) & 24 (14) & 24 (13) &  &  \\\\ \n    Median (Q1, Q3) & 23 (15, 28) & 22 (14, 33) &  &  \\\\ \n    Min, Max & 2, 70 & 6, 63 &  &  \\\\ \n    Missing & 22 & 22 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·0010 & 0·0060 \\\\ \n    Mean (SD) & 23 (12) & 21 (13) &  &  \\\\ \n    Median (Q1, Q3) & 22 (13, 31) & 19 (11, 29) &  &  \\\\ \n    Min, Max & 6, 49 & 4, 69 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·51 & >0·99 \\\\ \n    Mean (SD) & 21 (13) & 21 (11) &  &  \\\\ \n    Median (Q1, Q3) & 20 (12, 29) & 21 (11, 28) &  &  \\\\ \n    Min, Max & 4, 69 & 4, 57 &  &  \\\\ \n    Missing & 46 & 46 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·56 & >0·99 \\\\ \n    Mean (SD) & 20 (12) & 21 (14) &  &  \\\\ \n    Median (Q1, Q3) & 21 (10, 28) & 20 (11, 28) &  &  \\\\ \n    Min, Max & 5, 57 & 4, 86 &  &  \\\\ \n    Missing & 56 & 56 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & 0·75 & >0·99 \\\\ \n    Mean (SD) & 19 (10) & 18 (8) &  &  \\\\ \n    Median (Q1, Q3) & 17 (10, 28) & 18 (11, 24) &  &  \\\\ \n    Min, Max & 4, 41 & 3, 34 &  &  \\\\ \n    Missing & 64 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-prim-iod-pairwise-placebo .cell tbl-cap='Explorative pairwise comparison of the Index of Desistance (IoD total score) for the placebo arm.'}\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD\"\ntbl <- create_prim_pairwise_tbls(variable, subgroup_str = \"Placebo\")\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240ff4f9ac6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f17082a6c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & <0·0001 & <0·0001 \\\\ \n    Mean (SD) & 25 (12) & 22 (12) &  &  \\\\ \n    Median (Q1, Q3) & 22 (16, 32) & 19 (13, 27) &  &  \\\\ \n    Min, Max & 5, 58 & 5, 70 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·68 & >0·99 \\\\ \n    Mean (SD) & 22 (13) & 22 (13) &  &  \\\\ \n    Median (Q1, Q3) & 19 (12, 27) & 19 (14, 31) &  &  \\\\ \n    Min, Max & 5, 70 & 5, 66 &  &  \\\\ \n    Missing & 15 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·040 & 0·20 \\\\ \n    Mean (SD) & 23 (14) & 20 (12) &  &  \\\\ \n    Median (Q1, Q3) & 19 (14, 31) & 18 (11, 27) &  &  \\\\ \n    Min, Max & 5, 66 & 2, 58 &  &  \\\\ \n    Missing & 31 & 31 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & >0·99 & >0·99 \\\\ \n    Mean (SD) & 20 (11) & 20 (12) &  &  \\\\ \n    Median (Q1, Q3) & 18 (11, 26) & 17 (12, 24) &  &  \\\\ \n    Min, Max & 2, 47 & 3, 64 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·67 & >0·99 \\\\ \n    Mean (SD) & 19 (12) & 20 (13) &  &  \\\\ \n    Median (Q1, Q3) & 15 (11, 24) & 16 (10, 26) &  &  \\\\ \n    Min, Max & 3, 64 & 6, 63 &  &  \\\\ \n    Missing & 51 & 51 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & 0·80 & >0·99 \\\\ \n    Mean (SD) & 20 (13) & 20 (13) &  &  \\\\ \n    Median (Q1, Q3) & 16 (10, 26) & 17 (10, 26) &  &  \\\\ \n    Min, Max & 6, 63 & 5, 65 &  &  \\\\ \n    Missing & 53 & 53 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- DIFFERENCES FROM BASELINE -->\n\n\n::: {#tbl-prim-iod-diffscore .cell tbl-cap='Difference of the Index of Desistance (IoD total score) between before (pre) and after (post) each module.'}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nsource(here::here(\"_scripts/prim_diffscore_functions.R\"))\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nvariable <- \"IoD\"\ntbl <- create_prim_diffscore_tbl(variable)\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-diffscore.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f100674cc.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-diffscore.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-prim-iod-diffscore.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f6790a24.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 106 & \\textbf{Intervention}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·45 & >0·99 \\\\ \n    Mean (SD) & -3 (7) & -2 (8) &  &  \\\\ \n    Median (Q1, Q3) & -3 (-6, 1) & -2 (-7, 3) &  &  \\\\ \n    Min, Max & -30, 17 & -37, 16 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·33 & >0·99 \\\\ \n    Mean (SD) & 1 (8) & 0 (7) &  &  \\\\ \n    Median (Q1, Q3) & 1 (-3, 5) & -1 (-4, 4) &  &  \\\\ \n    Min, Max & -33, 46 & -24, 18 &  &  \\\\ \n    Missing & 15 & 22 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·85 & >0·99 \\\\ \n    Mean (SD) & -3 (9) & -2 (7) &  &  \\\\ \n    Median (Q1, Q3) & -2 (-5, 1) & -2 (-6, 2) &  &  \\\\ \n    Min, Max & -55, 17 & -19, 24 &  &  \\\\ \n    Missing & 31 & 38 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·44 & >0·99 \\\\ \n    Mean (SD) & 0·3 (6·3) & -0·7 (5·4) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-3·0, 4·0) & 0·0 (-4·5, 3·0) &  &  \\\\ \n    Min, Max & -19·0, 21·0 & -12·0, 11·0 &  &  \\\\ \n    Missing & 38 & 46 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·88 & >0·99 \\\\ \n    Mean (SD) & 1·0 (8·4) & 0·9 (7·1) &  &  \\\\ \n    Median (Q1, Q3) & 2·0 (-4·0, 4·0) & 0·0 (-3·0, 3·0) &  &  \\\\ \n    Min, Max & -24·0, 29·0 & -16·0, 32·0 &  &  \\\\ \n    Missing & 51 & 56 &  &  \\\\ \n{\\bfseries Module 6 (post)} &  &  & 0·76 & >0·99 \\\\ \n    Mean (SD) & 0·3 (4·3) & -0·6 (5·5) &  &  \\\\ \n    Median (Q1, Q3) & -1·0 (-3·0, 3·0) & 0·0 (-4·0, 3·0) &  &  \\\\ \n    Min, Max & -7·0, 13·0 & -22·0, 9·0 &  &  \\\\ \n    Missing & 53 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- RAIN PLOT -->\n![Rainplot of the differences from baseline for the Index of Desistance (IoD total score).](_figures/fig-iod-rainplot-difference-from-baseline.png){#fig-iod-rainplot-difference-from-baseline}\n\n\n\n{{< pagebreak >}}\n\n## Secondary Outcomes\n\n### Differences from baseline\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(here)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(rlang)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'rlang'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDie folgenden Objekte sind maskiert von 'package:purrr':\n\n    flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,\n    flatten_raw, invoke, splice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:magrittr':\n\n    set_names\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\nlibrary(glue)\n\nsource(here::here(\"_scripts/sec_diffscore_functions.R\"))\nsource(here::here(\"_scripts/sec_pairwise_functions.R\"))\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndvs_mbsb <- c(\n  \"cvtrq_calc_total\",\n  \"rcq_calc_total\",\n  \"fsozu_calc_total\",\n  \"ors_calc_total\",\n  \"ucla_calc_total\",\n  \"bis_calc_total\",\n  \"cusi_calc_total\",\n  \"ders_calc_imp\",\n  \"narq_calc_ris\",\n  \"spsi_calc_total\",\n  \"kvm_score\",\n  \"esiq_calc_total\",\n  \"soi_total_score\",\n  \"ssik_calc_total\",\n  \"ekk_calc_total\",\n  \"hbi_calc_total\"\n)\n\ndvs <- c(\n  \"cvtrq_calc_total\",\n  \"rcq_calc_total\",\n  \"fsozu_calc_total\",\n  \"ors_calc_total\",\n  \"ucla_calc_total\",\n  \"bis_calc_total\",\n  \"cusi_calc_total\",\n  \"ders_calc_imp\",\n  \"narq_calc_ris\",\n  \"spsi_calc_total\",\n  \"kvm_calc_total\",\n  \"esiq_calc_total\",\n  \"soi_total_score\",\n  \"ssik_calc_total\",\n  \"ekk_calc_total\",\n  \"hbi_calc_total\"\n  \n)\n\nlabels <- c(\n  \"CVTRQ (total score)\",\n  \"RCQ (total score)\",\n  \"F-Soz-U (total score)\",\n  \"OQMPR (total score)\",\n  \"UCLA (total score)\",\n  \"BIS-15 (total score)\",\n  \"CUSI (total score)\",\n  \"DERS (subscale impulsivity)\",\n  \"NARQ (subscale externalizing strategies)\",\n  \"SPSI-R (total score)\",\n  \"BMS (total score)\",\n  \"ESIQ (total score)\",\n  \"SOI (Item 2a)\",\n  \"SSIC (total score)\",\n  \"EKK-R (total score)\",\n  \"HBI-19 (total score)\"\n)\n\ntypes <- c(\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\",\n  \"continuous2\"\n)\n\nabbreviations <- c(\n  \"*CVTRQ* = Corrections Victoria Treatment Readiness Questionnaire [@caseyAssessingSuitabilityOffender2007]\",\n  \"*RCQ* = Readiness to Change Questionnaire [@rollnickDevelopmentShortReadiness1992] - German version [@hannoverReadinessChangeQuestionnaire2002] adapted for individuals who committed sexual offenses against children by project team\",\n  \"*F-Soz-U* = Seven-item short version of the Social Support Questionnaire [@dunkelEvaluationShortformSocial2005]\",\n  \"*OQMPR* = Questionnaire for the Measurement of Psychological Reactance [@merzQuestionnaireMeasurementPsychological1983]\",\n  \"*UCLA* = UCLA Loneliness Scale [@russell_ucla_1996] - German short version [@bilskySocialSupportLoneliness1998]\",\n  \"*BIS-15* = Barratt Impulsiveness Scale-15 [@pattonFactorStructureBarratt1995]\",\n  \"*CUSI* = Coping Using Sex Inventory [@cortoniSexCopingStrategy2001]\",\n  \"*DERS* = Difficulties in Emotion Regulation Scale [@gratzMultidimensionalAssessmentEmotion2003]\",\n  \"*NARQ* = Negative Affect Repair Questionnaire [@schererNegativeAffectRepair2013]\",\n  \"*SPSI-R* = Social Problem-Solving Inventory Revised [@dzurillaManualSocialProblemSolving2002]\",\n  \"*BMS* = Bumby Molest Scale [@bumbyAssessingCognitiveDistortions]\",\n  \"*EKK-R* = Questionnaire on Emotional Congruence with Children-Revised [@mackEmotionaleKongruenzMit2012]\",\n  \"*ESIQ* = Explicit Sexual Interest Questionnaire [@banseIndirectMeasuresSexual2010]\",\n  \"*SOI-R* = Sexual Outlet Inventory revised, subscale desire for sexual activity with children [@bbrikenSexualOutletInventory2010]\",\n  \"*HBI-19* = Hypersexual Behavior Inventory-19 [@kleinValidierungsstudieDeutschenVersion2013]\",\n  \"*SSIC* = Specific self-efficacy for modifying Sexual Interest in Children [@tozdanSpezifischeSelbstwirksamkeitZur2015]\"\n)\n```\n:::\n\n\n\n::: {#tbl-sec-diffscore .cell tbl-cap='Difference between before (pre) and after (post) for each secondary endpoint. Differences (from pre to post) of secondary endpoints have been compared between the treatment groups using the Brunner-Munzel test for unpaired data.'}\n\n```{.r .cell-code .hidden}\nmbsb <- TRUE\nsample_str <- \"itt\"\n\ntbl <- create_tbl_diffscore_bm_unpaired(mbsb, sample_str, dvs, dvs_mbsb, labels, types, abbreviations)\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-diffscore.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f400ee973.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-diffscore.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-diffscore.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f21a9407f.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 113 & \\textbf{Intervention}  N = 108 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries CVTRQ (total score)} &  &  & 0·19 & >0·99 \\\\ \n    Mean (SD) & 0·5 (4·9) & 1·5 (5·7) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-3·0, 3·0) & 1·0 (-2·0, 5·0) &  &  \\\\ \n    Min, Max & -11·0, 15·0 & -12·0, 28·0 &  &  \\\\ \n{\\bfseries RCQ (total score)} &  &  & 0·21 & >0·99 \\\\ \n    Mean (SD) & 0·3 (4·5) & -0·5 (4·6) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-3·0, 3·0) & -1·0 (-4·0, 3·0) &  &  \\\\ \n    Min, Max & -14·0, 14·0 & -12·0, 13·0 &  &  \\\\ \n{\\bfseries F-Soz-U (total score)} &  &  & 0·22 & >0·99 \\\\ \n    Mean (SD) & 0·14 (0·46) & 0·01 (0·56) &  &  \\\\ \n    Median (Q1, Q3) & 0·14 (-0·14, 0·43) & 0·00 (-0·29, 0·43) &  &  \\\\ \n    Min, Max & -0·86, 1·14 & -2·29, 1·29 &  &  \\\\ \n    Missing & 19 & 17 &  &  \\\\ \n{\\bfseries OQMPR (total score)} &  &  & 0·94 & >0·99 \\\\ \n    Mean (SD) & -0·9 (5·4) & -1·3 (5·9) &  &  \\\\ \n    Median (Q1, Q3) & -1·0 (-5·0, 2·0) & -1·0 (-4·0, 3·0) &  &  \\\\ \n    Min, Max & -15·0, 18·0 & -21·0, 20·0 &  &  \\\\ \n    Missing & 19 & 17 &  &  \\\\ \n{\\bfseries UCLA (total score)} &  &  & 0·28 & >0·99 \\\\ \n    Mean (SD) & -0·11 (3·23) & -0·54 (2·98) &  &  \\\\ \n    Median (Q1, Q3) & 0·00 (-2·00, 2·00) & 0·00 (-2·00, 1·00) &  &  \\\\ \n    Min, Max & -13·00, 10·00 & -12·00, 11·00 &  &  \\\\ \n    Missing & 19 & 17 &  &  \\\\ \n{\\bfseries BIS-15 (total score)} &  &  & 0·92 & >0·99 \\\\ \n    Mean (SD) & 0·0 (3·9) & 0·0 (3·4) &  &  \\\\ \n    Median (Q1, Q3) & -0·5 (-2·0, 2·0) & 0·0 (-2·0, 2·0) &  &  \\\\ \n    Min, Max & -19·0, 11·0 & -10·0, 10·0 &  &  \\\\ \n    Missing & 35 & 36 &  &  \\\\ \n{\\bfseries CUSI (total score)} &  &  & 0·55 & >0·99 \\\\ \n    Mean (SD) & 0·8 (5·3) & 0·4 (6·5) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-2·0, 2·0) & 0·0 (-3·0, 2·5) &  &  \\\\ \n    Min, Max & -8·0, 23·0 & -11·0, 27·0 &  &  \\\\ \n    Missing & 35 & 36 &  &  \\\\ \n{\\bfseries DERS (subscale impulsivity)} &  &  & 0·024 & 0·36 \\\\ \n    Mean (SD) & -0·15 (1·24) & 0·49 (2·10) &  &  \\\\ \n    Median (Q1, Q3) & 0·00 (0·00, 0·00) & 0·00 (0·00, 1·00) &  &  \\\\ \n    Min, Max & -4·00, 5·00 & -5·00, 7·00 &  &  \\\\ \n    Missing & 35 & 36 &  &  \\\\ \n{\\bfseries NARQ (subscale externalizing strategies)} &  &  & 0·30 & >0·99 \\\\ \n    Mean (SD) & -0·29 (2·53) & 0·17 (2·22) &  &  \\\\ \n    Median (Q1, Q3) & 0·00 (-1·00, 1·00) & 0·00 (0·00, 1·00) &  &  \\\\ \n    Min, Max & -16·00, 4·00 & -12·00, 5·00 &  &  \\\\ \n    Missing & 35 & 36 &  &  \\\\ \n{\\bfseries SPSI-R (total score)} &  &  & 0·97 & >0·99 \\\\ \n    Mean (SD) & 0·02 (1·46) & 0·08 (1·66) &  &  \\\\ \n    Median (Q1, Q3) & 0·00 (-0·90, 0·80) & 0·00 (-1·00, 1·20) &  &  \\\\ \n    Min, Max & -4·20, 4·60 & -4·00, 4·40 &  &  \\\\ \n    Missing & 41 & 46 &  &  \\\\ \n{\\bfseries BMS (total score)} &  &  & 0·14 & >0·99 \\\\ \n    Mean (SD) & -1 (7) & 2 (10) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-4, 1) & 0 (-3, 5) &  &  \\\\ \n    Min, Max & -20, 23 & -12, 39 &  &  \\\\ \n    Missing & 54 & 55 &  &  \\\\ \n{\\bfseries EKK-R (total score)} &  &  & 0·49 & >0·99 \\\\ \n    Mean (SD) & 0·3 (3·8) & -0·6 (4·8) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-2·0, 3·0) & 0·0 (-2·0, 2·0) &  &  \\\\ \n    Min, Max & -9·0, 9·0 & -17·0, 9·0 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n{\\bfseries ESIQ (total score)} &  &  & 0·0020 & 0·032 \\\\ \n    Mean (SD) & -0·1 (7·9) & -3·6 (5·4) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-1·0, 2·0) & -3·0 (-8·0, 0·0) &  &  \\\\ \n    Min, Max & -22·0, 31·0 & -14·0, 11·0 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n{\\bfseries HBI-19 (total score)} &  &  & 0·92 & >0·99 \\\\ \n    Mean (SD) & 0·0 (5·5) & -1·0 (6·9) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-2·0, 2·0) & 0·0 (-4·0, 2·0) &  &  \\\\ \n    Min, Max & -11·0, 18·0 & -23·0, 18·0 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n{\\bfseries SSIC (total score)} &  &  & 0·077 & >0·99 \\\\ \n    Mean (SD) & 0·1 (4·5) & 0·6 (3·6) &  &  \\\\ \n    Median (Q1, Q3) & 0·0 (-1·0, 0·0) & 0·0 (0·0, 2·0) &  &  \\\\ \n    Min, Max & -18·0, 20·0 & -12·0, 9·0 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n{\\bfseries SOI (Item 2a)} &  &  & 0·061 & 0·85 \\\\ \n    Mean (SD) & 1 (6) & -1 (11) &  &  \\\\ \n    Median (Q1, Q3) & 0 (0, 0) & 0 (-1, 0) &  &  \\\\ \n    Min, Max & -19, 22 & -43, 45 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: BIS-15 = Barratt Impulsiveness Scale-15, BMS = Bumby Molest Scale, CUSI = Coping Using Sex Inventory, CVTRQ = Corrections Victoria Treatment Readiness Questionnaire, DERS = Difficulties in Emotion Regulation Scale, EKK-R = Questionnaire on Emotional Congruence with Children-Revised, ESIQ = Explicit Sexual Interest Questionnaire, F-Soz-U = Seven-item short version of the Social Support Questionnaire, HBI-19 = Hypersexual Behavior Inventory-19, NARQ = Negative Affect Repair Questionnaire, OQMPR = Questionnaire for the Measurement of Psychological Reactance, Q1 = 25th percentile, Q3 = 75th percentile, RCQ = Readiness to Change Questionnaire - German version, SOI-R = Sexual Outlet Inventory revised, subscale desire for sexual activity with children, SPSI-R = Social Problem-Solving Inventory Revised, SSIC = Specific self-efficacy for modifying Sexual Interest in Children, UCLA = UCLA Loneliness Scale - German short version, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- CVTRQ -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"cvtrq_calc_total\"\nvar_nice <- \"cvtrq-calc-total\"\nq_name <- \"CVTRQ (total score)\"\nfit <- fit_cvtrq_calc_total\nlm_table <- lm_Table_cvtrq_calc_total\nmodule <- \"module one (motivation)\"\ntbl_cap <- paste0(\"Linear regression model for the Corrections Victoria Treatment Readiness Questionnaire \", q_name, \"; Number of observations: \", as.character(nobs(fit)), \").\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### CVTRQ\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Corrections Victoria Treatment Readiness Questionnaire (CVTRQ, total score).](_figures/fig-sec-rainplot-cvtrq-calc-total.png){#fig-sec-rainplot-cvtrq}\n\n\n::: {#cell-fig-sec-lm-cvtrq-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttache Paket: 'ggResidpanel'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDas folgende Objekt ist maskiert 'package:datasets':\n\n    penguins\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(knitr)\n\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\ni Please use tidy evaluation idioms with `aes()`.\ni See also `vignette(\"ggplot2-in-packages\")` for more information.\ni The deprecated feature was likely used in the ggResidpanel package.\n  Please report the issue to the authors.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\ni Please use `linewidth` instead.\ni The deprecated feature was likely used in the ggResidpanel package.\n  Please report the issue to the authors.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Corrections Victoria Treatment Readiness Questionnaire (CVTRQ, total score).](_figures/fig-sec-diagnostic-plots-cvtrq-calc-total.png){#fig-sec-rainplot-cvtrq-calc-total}\n\n\n\n::: {#tbl-sec-lm-cvtrq-calc-total .cell tbl-cap='Linear regression model for the Corrections Victoria Treatment Readiness Questionnaire CVTRQ (total score); Number of observations: 221).'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cvtrq-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f2f4599b3.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cvtrq-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cvtrq-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f7ef75ac6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 221 & 18 & 9.1, 26 & <0.001 &  \\\\ \n{\\bfseries Baseline value (pre)} & 221 & 0.81 & 0.71, 0.91 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 113 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 108 & 0.89 & -0.49, 2.3 & 0.2 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 89 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 132 & -0.22 & -1.8, 1.3 & 0.8 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 176 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 45 & -0.51 & -2.4, 1.4 & 0.6 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 148 & 0.00 & Ref. &  &  \\\\ \n    Yes & 73 & 0.24 & -1.3, 1.7 & 0.7 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 221 & -0.47 & -1.1, 0.17 & 0.2 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- RCQ -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"rcq_calc_total\"\nvar_nice <- \"rcq-calc-total\"\nq_name <- \"RCQ (total score)\"\nfit1 <- fit_rcq_calc_total\nfit2 <- fit_rcq_calc_total3\nlm_table <- lm_Table_rcq_calc_total\nmodule <- \"module one (motivation)\"\ntbl_cap <- paste0(\"Linear regression model for the Readiness to Change Questionnaire \", q_name, \"; Number of observations: \", as.character(nobs(fit1)), \").\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \". The plot on the left correspond to the model fitted with all data points, the plot on the right correspond to the model after the removal of identified outliers. Both models showed similar results.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### RCQ\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Readiness to Change Questionnaire (RCQ, total score).](_figures/fig-sec-rainplot-rcq-calc-total.png){#fig-sec-rainplot-cvtrq-calc-total}\n\n\n::: {#cell-fig-sec-lm-rcq-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_compare(list(fit1, fit2), plots = c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Readiness to Change Questionnaire (RCQ, total score). The plots on the left correspond to the model fitted with all data points, the plots on the right correspond to the model after the removal of identified outliers. Both models models showed similar results. ](_figures/fig-sec-diagnostic-plots-rcq-calc-total.png){#fig-sec-rainplot-rcq-calc-total}\n\n\n\n::: {#tbl-sec-lm-rcq-calc-total .cell tbl-cap='Linear regression model for the Readiness to Change Questionnaire RCQ (total score); Number of observations: 221).'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-rcq-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240fe10121a.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-rcq-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-rcq-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f38bc5533.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 221 & 19 & 16, 23 & <0.001 &  \\\\ \n{\\bfseries Baseline value (pre)} & 221 & 0.27 & 0.15, 0.40 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 113 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 108 & -0.89 & -1.8, 0.07 & 0.069 & 0.826 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 89 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 132 & 0.12 & -0.95, 1.2 & 0.8 & 1.000 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 176 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 45 & -0.84 & -2.2, 0.48 & 0.2 & 1.000 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 148 & 0.00 & Ref. &  &  \\\\ \n    Yes & 73 & -0.40 & -1.4, 0.64 & 0.4 & 1.000 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 221 & -0.08 & -0.53, 0.36 & 0.7 & 1.000 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- Fsoz-U -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"fsozu_calc_total\"\nvar_nice <- \"fsozu-calc-total\"\nq_name <- \"F-Soz-U (total score)\"\nfit <- fit_fsozu_calc_total\nlm_table <- lm_Table_fsozu_calc_total\nmodule <- \"module two (supervision and social relationship)\"\ntbl_cap <- paste0(\"Linear regression model for the Social Support Questionnaire \", q_name, \"; Number of observations: \", as.character(nobs(fit)), \").\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### F-Soz-U\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Social Support Questionnaire (F-Soz-U, total score).](_figures/fig-sec-rainplot-fsozu-calc-total.png){#fig-sec-rainplot-cvtrq-calc-total}\n\n\n::: {#cell-fig-sec-lm-fsozu-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Social Support Questionnaire (F-Soz-U, total score).](_figures/fig-sec-diagnostic-plots-fsozu-calc-total.png){#fig-sec-rainplot-fsozu-calc-total}\n\n\n\n::: {#tbl-sec-lm-fsozu-calc-total .cell tbl-cap='Linear regression model for the Social Support Questionnaire F-Soz-U (total score); Number of observations: 185).'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-fsozu-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f13bf4068.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-fsozu-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-fsozu-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f25bde6e7.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 185 & 0.50 & 0.12, 0.89 & 0.010 &  \\\\ \n{\\bfseries Baseline value (pre)} & 185 & 0.94 & 0.85, 1.0 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 94 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 91 & -0.13 & -0.28, 0.02 & 0.092 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 72 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 113 & -0.05 & -0.22, 0.12 & 0.5 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 151 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 34 & -0.04 & -0.25, 0.17 & 0.7 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 122 & 0.00 & Ref. &  &  \\\\ \n    Yes & 63 & -0.10 & -0.26, 0.06 & 0.2 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 185 & -0.04 & -0.11, 0.03 & 0.3 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- OQMPR -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"ors_calc_total\"\nvar_nice <- \"ors-calc-total\"\nq_name <- \"OQMPR (total score)\"\nfit <- fit_ors_calc_total\nlm_table <- lm_Table_ors_calc_total\nmodule <- \"module two (supervision and social relationship)\"\ntbl_cap <- paste0(\"Linear regression model for the Questionnaire for the Measurement of Psychological Reactance \", q_name, \" with n = \", as.character(nobs(fit)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### OQMPR\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Questionnaire for the Measurement of Psychological Reactance (OQMPR, total score).](_figures/fig-sec-rainplot-ors-calc-total.png){#fig-sec-rainplot-ors-total-score}\n\n\n::: {#cell-fig-sec-lm-ors-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Questionnaire for the Measurement of Psychological Reactance (OQMPR, total score).](_figures/fig-sec-diagnostic-plots-ors-calc-total.png){#fig-sec-rainplot-ors-calc-total}\n\n\n\n::: {#tbl-sec-lm-ors-calc-total .cell tbl-cap='Linear regression model for the Questionnaire for the Measurement of Psychological Reactance OQMPR (total score) with n = 185 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ors-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f65a3c922.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ors-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ors-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5464bc69.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 185 & 1.8 & -2.0, 5.6 & 0.3 &  \\\\ \n{\\bfseries Baseline value (pre)} & 185 & 0.89 & 0.79, 1.0 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 94 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 91 & -0.36 & -2.0, 1.3 & 0.7 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 72 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 113 & -1.1 & -2.9, 0.68 & 0.2 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 151 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 34 & -0.44 & -2.7, 1.8 & 0.7 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 122 & 0.00 & Ref. &  &  \\\\ \n    Yes & 63 & -0.13 & -1.9, 1.6 & 0.9 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 185 & 0.68 & -0.09, 1.4 & 0.083 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- SOI -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"soi_total_score\"\nvar_nice <- \"soi-total-score\"\nq_name <- \"SOI (subscale desire for sexual activity with children)\"\nfit <- fit_soi_calc_total\n#lm_table <- lm_Table_soi_calc_total\nmodule <- \"module six (sexuality)\"\ntbl_cap <- paste0(\"Linear regression model for the Sexual Outlet Inventory revised \", q_name, \"; Number of observations: \", as.character(nobs(fit)), \").\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### SOI-R\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Sexual Outlet Inventory revised (SOI-R, Item 2a).](_figures/fig-sec-rainplot-soi-total-score.png){#fig-sec-rainplot-soi-total-score}\n\n\n::: {#cell-fig-sec-lm-soi-total-score .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Sexual Outlet Inventory revised (SOI-R, Item 2a).](_figures/fig-sec-diagnostic-plots-soi-total-score.png){#fig-sec-rainplot-soi-total-score}\n\n\n\n::: {#tbl-sec-lm-soi-total-score .cell tbl-cap='Linear regression model for the Sexual Outlet Inventory revised SOI (subscale desire for sexual activity with children); Number of observations: 95).'}\n\n```{.r .cell-code .hidden}\n#lm_table\n```\n:::\n\n\n<!-- UCLA -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"ucla_calc_total\"\nvar_nice <- \"ucla-calc-total\"\nq_name <- \"UCLA (total score)\"\nfit1 <- fit_ucla_calc_total\nfit2 <- fit_ucla_calc_total3\nlm_table <- lm_Table_ucla_calc_total\nmodule <- \"module two (supervision and social relationship)\"\ntbl_cap <- paste0(\"Linear regression model for the UCLA Loneliness Scale \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \". The plot on the left correspond to the model fitted with all data points, the plot on the right correspond to the model after the removal of identified outliers. Both models showed similar results.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### UCLA\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the UCLA Loneliness Scale (UCLA, total score).](_figures/fig-sec-rainplot-ucla-calc-total.png){#fig-sec-rainplot-ucla-total-score}\n\n\n::: {#cell-fig-sec-lm-ucla-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_compare(list(fit1, fit2), plots = c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16\n)\n```\n:::\n\n\n![Diagnostic plots for the UCLA Loneliness Scale (UCLA, total score). The plots on the left correspond to the model fitted with all data points, the plots on the right correspond to the model after the removal of identified outliers. Both models models showed similar results.](_figures/fig-sec-diagnostic-plots-ucla-calc-total.png){#fig-sec-rainplot-ucla-calc-total}\n\n\n\n::: {#tbl-sec-lm-ucla-calc-total .cell tbl-cap='Linear regression model for the UCLA Loneliness Scale UCLA (total score) with n = 185 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ucla-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f7f0b279.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ucla-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ucla-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1f4590c2.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 185 & 5.2 & 1.8, 8.6 & 0.003 &  \\\\ \n{\\bfseries Baseline value (pre)} & 185 & 0.82 & 0.70, 0.94 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 94 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 91 & -0.40 & -1.3, 0.49 & 0.4 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 72 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 113 & -0.62 & -1.6, 0.37 & 0.2 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 151 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 34 & -0.47 & -1.7, 0.77 & 0.5 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 122 & 0.00 & Ref. &  &  \\\\ \n    Yes & 63 & 0.08 & -0.88, 1.0 & 0.9 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 185 & 0.11 & -0.31, 0.52 & 0.6 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- BIS -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"bis_calc_total\"\nvar_nice <- \"bis-calc-total\"\nq_name <- \"BIS-15 (total score)\"\nfit1 <- fit_bis_calc_total2\nfit2 <- fit_bis_calc_total\nlm_table <- lm_Table_bis_calc_total\nmodule <- \"module three (emotion management)\"\ntbl_cap <- paste0(\"Linear regression model for the Barratt Impulsiveness Scale-15 \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \". The plots on the left correspond to an ordinary linear model, the plots on the right correspond to the model where the score was log-transformed.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### BIS-15\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Barratt Impulsiveness Scale-15 (BIS-15, total score).](_figures/fig-sec-rainplot-bis-calc-total.png){#fig-sec-rainplot-bis-total-score}\n\n\n::: {#cell-fig-sec-lm-bis-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_compare(list(fit1, fit2), plots = c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16\n)\n```\n:::\n\n\n![Diagnostic plots for the Barratt Impulsiveness Scale-15 (BIS-15, total score). The plots on the left correspond to an ordinary linear model, the plots on the right correspond to the model where the bis score was log-transformed. ](_figures/fig-sec-diagnostic-plots-bis-calc-total.png){#fig-sec-rainplot-bis-calc-total}\n\n\n\n::: {#tbl-sec-lm-bis-calc-total .cell tbl-cap='Linear regression model for the Barratt Impulsiveness Scale-15 BIS-15 (total score) with n = 150 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bis-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5bc3512b.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bis-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bis-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f13183a1d.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 150 & 3.2 & 0.41, 6.0 & 0.025 &  \\\\ \n{\\bfseries Baseline value (pre)} & 150 & 0.88 & 0.80, 0.97 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 78 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 72 & 0.15 & -1.0, 1.3 & 0.8 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 58 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 92 & 0.77 & -0.56, 2.1 & 0.3 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 120 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 30 & 0.67 & -0.93, 2.3 & 0.4 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 95 & 0.00 & Ref. &  &  \\\\ \n    Yes & 55 & 0.01 & -1.2, 1.2 & >0.9 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 150 & -0.27 & -0.83, 0.28 & 0.3 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- CUSI -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"cusi_calc_total\"\nvar_nice <- \"cusi-calc-total\"\nq_name <- \"CUSI (total score)\"\nfit1 <- fit_cusi_calc_total\nfit2 <- fit_cusi_calc_total3\nlm_table <- lm_Table_cusi_calc_total\nmodule <- \"module two (supervision and social relationship)\"\ntbl_cap <- paste0(\"Linear regression model for \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \". The plot on the left correspond to the model fitted with all data points, the plot on the right correspond to the model after the removal of identified outliers. Both models showed similar results.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### CUSI\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Coping Using Sex Inventory (CUSI, total score).](_figures/fig-sec-rainplot-cusi-calc-total.png){#fig-sec-rainplot-cusi-total-score}\n\n\n::: {#cell-fig-sec-lm-cusi-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_compare(list(fit1, fit2), plots = c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for Coping Using Sex Inventory (CUSI, total score). The plots on the left correspond to the model fitted with all data points, the plots on the right correspond to the model after the removal of identified outliers. Both models models showed similar results.](_figures/fig-sec-diagnostic-plots-cusi-calc-total.png){#fig-sec-rainplot-cusi-calc-total}\n\n\n\n::: {#tbl-sec-lm-cusi-calc-total .cell tbl-cap='Linear regression model for CUSI (total score) with n = 150 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cusi-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f78c7454f.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cusi-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-cusi-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1c9c9c14.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 150 & 3.5 & -0.24, 7.3 & 0.066 &  \\\\ \n{\\bfseries Baseline value (pre)} & 150 & 0.82 & 0.71, 0.94 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 78 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 72 & -0.09 & -2.0, 1.8 & >0.9 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 58 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 92 & 1.8 & -0.33, 4.0 & 0.10 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 120 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 30 & 1.9 & -0.68, 4.4 & 0.15 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 95 & 0.00 & Ref. &  &  \\\\ \n    Yes & 55 & 0.41 & -1.6, 2.4 & 0.7 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 150 & 0.29 & -0.58, 1.2 & 0.5 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- SPSI-R -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"spsi_calc_total\"\nvar_nice <- \"spsi-calc-total\"\nq_name <- \"SPSI-R (total score)\"\nfit <- fit_spsi_calc_total\nlm_table <- lm_Table_spsi_calc_total\nmodule <- \"module four (problem solving)\"\ntbl_cap <- paste0(\"Linear regression model for Social Problem-Solving Inventory Revised \", q_name, \" with n = \", as.character(nobs(fit)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### SPSI-R\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Social Problem-Solving Inventory Revised (SPSI-R, total score).](_figures/fig-sec-rainplot-spsi-calc-total.png){#fig-sec-rainplot-spsi-total-score}\n\n\n::: {#cell-fig-sec-lm-spsi-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for the Social Problem-Solving Inventory Revised (SPSI-R, total score).](_figures/fig-sec-diagnostic-plots-spsi-calc-total.png){#fig-sec-rainplot-spsi-calc-total}\n\n\n\n::: {#tbl-sec-lm-spsi-calc-total .cell tbl-cap='Linear regression model for Social Problem-Solving Inventory Revised SPSI-R (total score) with n = 134 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-spsi-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f2ba85759.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-spsi-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-spsi-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f592971e0.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 134 & 1.3 & -0.24, 2.8 & 0.10 &  \\\\ \n{\\bfseries Baseline value (pre)} & 134 & 0.90 & 0.81, 1.0 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 72 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 62 & 0.03 & -0.51, 0.56 & >0.9 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 53 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 81 & 0.08 & -0.52, 0.67 & 0.8 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 109 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 25 & -0.44 & -1.2, 0.30 & 0.2 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 88 & 0.00 & Ref. &  &  \\\\ \n    Yes & 46 & 0.23 & -0.34, 0.81 & 0.4 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 134 & 0.01 & -0.23, 0.25 & >0.9 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- EKK-R -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"ekk_calc_total\"\nvar_nice <- \"ekk-calc-total\"\nq_name <- \"EKK-R (total score)\"\nfit <- fit_ekk_calc_total\nmodule <- \"module six (sexuality)\"\nlm_table <- lm_Table_ekk_calc_total\ntbl_cap <- paste0(\"Linear regression model for \", q_name, \" with n = \", as.character(nobs(fit)), \" observations.\")\nfig_cap <- paste(\"Diagnostic plots for linear regression models with \", q_name, \".\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### EKK-R\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Emotional Congruence with Children-Revised (EKK-R, total score).](_figures/fig-sec-rainplot-ekk-calc-total.png){#fig-sec-rainplot-ekk-total-score}\n\n\n::: {#cell-fig-sec-lm-ekk-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit, plots=c(\"qq\", \"resid\"))\nplt <- add_gg_theme(plt)\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\nNo shared levels found between `names(values)` of the manual scale and the\ndata's colour values.\n```\n\n\n:::\n:::\n\n\n![Diagnostic plots for Emotional Congruence with Children-Revised (EKK-R, total score).](_figures/fig-sec-diagnostic-plots-ekk-calc-total.png){#fig-sec-rainplot-ekk-calc-total}\n\n\n\n::: {#tbl-sec-lm-ekk-calc-total .cell tbl-cap='Linear regression model for EKK-R (total score) with n = 95 observations.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ekk-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f427ac035.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ekk-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ekk-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f824a635.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{β} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 95 & 5.4 & 1.6, 9.3 & 0.006 &  \\\\ \n{\\bfseries Baseline value (pre)} & 95 & 0.81 & 0.70, 0.92 & <0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  \\\\ \n    Placebo & 53 & 0.00 & Ref. &  &  \\\\ \n    Intervention & 42 & -0.90 & -2.6, 0.81 & 0.3 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 38 & 0.00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 57 & 0.27 & -1.7, 2.2 & 0.8 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 77 & 0.00 & Ref. &  &  \\\\ \n    post-release supervision & 18 & 0.40 & -2.0, 2.8 & 0.7 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 59 & 0.00 & Ref. &  &  \\\\ \n    Yes & 36 & 0.57 & -1.3, 2.5 & 0.6 &  1.00 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & 95 & 0.04 & -0.78, 0.86 & >0.9 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: CI = Confidence Interval\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- DERS -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"ders_calc_imp\"\nvar_nice <- \"ders-calc-imp\"\nq_name <- \"DERS (subscore impulsivity)\"\nfit1 <- fit_ders_calc_imp_ordinal\nfit2 <- fit_ders_calc_imp\nlm_table <- glm_Table_ders_calc_imp\nmodule <- \"module three (emotion management)\"\ntbl_cap <- paste0(\"Ordinal regression model for the Difficulties in Emotion Regulation Scale \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. For the dependent variable, values greater than 9 were merged into a single category.\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". As shown, prerequisites of an linear regression model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### DERS\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Difficulties in Emotion Regulation Scale (DERS, subscale impulsivity). Note, that for the dependent variable, values greater than 9 were merged into a single category.](_figures/fig-sec-rainplot-ders-calc-imp.png){#fig-sec-rainplot-ders-imp-score}\n\n\n::: {#cell-fig-sec-lm-ders-calc-imp .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for Difficulties in Emotion Regulation Scale (DERS, subscale impulsivity). Note, that for the dependent variable, values greater than 9 were merged into a single category..](_figures/fig-sec-diagnostic-plots-ders-calc-imp.png){#fig-sec-rainplot-ders-calc-imp}\n\n\n\n::: {#tbl-sec-lm-ders-calc-imp .cell tbl-cap='Ordinal regression model for the Difficulties in Emotion Regulation Scale DERS (subscore impulsivity) with n = 150 observations. For the dependent variable, values greater than 9 were merged into a single category.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ders-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f28084015.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ders-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ders-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240fbb443ab.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Baseline value (pre)} & 150 & 2·08 & 1·70, 2·59 & < 0.001 &  \\\\ \n{\\bfseries treatment} &  &  &  &  &  \\\\ \n    Placebo & 78 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 72 & 2·35 & 1·22, 4·61 & 0.012 & 0.176 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 58 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 92 & 1·02 & 0·47, 2·29 & 0.955 & 1.000 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 120 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 30 & 1·87 & 0·74, 4·75 & 0.182 & 1.000 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 95 & 1·00 & Ref. &  &  \\\\ \n    Yes & 55 & 0·69 & 0·33, 1·41 & 0.313 & 1.000 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 150 & 0·89 & 0·64, 1·21 & 0.459 & 1.000 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- NARQ -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"narq_calc_ris\"\nvar_nice <- \"narq-calc-ris\"\nq_name <- \"NARQ (subscale externalizing strategies)\"\nfit1 <- fit_narq_calc_ris_ordinal\nfit2 <- fit_narq_calc_ris\nlm_table <- glm_Table_narq_calc_ris\nmodule <- \"module three (emotion management)\"\ntbl_cap <- paste0(\"Ordinal regression model for the Negative Affect Repair Questionnaire \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. Note, that for the dependent variable, values greater than 4 were merged into a single category.\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". The plot shows that the assumptions of a linear model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### NARQ\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Negative Affect Repair Questionnaire (NARQ, subscale externalizing strategies). Note, that for the dependent variable, values greater than 4 were merged into a single category.](_figures/fig-sec-rainplot-narq-calc-ris.png){#fig-sec-rainplot-narq-ris-score}\n\n\n::: {#cell-fig-sec-lm-narq-calc-ris .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for the Negative Affect Repair Questionnaire (NARQ, subscale externalizing strategies). Note, that for the dependent variable, values greater than 4 were merged into a single category](_figures/fig-sec-diagnostic-plots-narq-calc-ris.png){#fig-sec-rainplot-narq-calc-ris}\n\n\n\n::: {#tbl-sec-lm-narq-calc-ris .cell tbl-cap='Ordinal regression model for the Negative Affect Repair Questionnaire NARQ (subscale externalizing strategies) with n = 150 observations. Note, that for the dependent variable, values greater than 4 were merged into a single category.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-narq-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f426e747d.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-narq-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-narq-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f7fd96875.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Baseline value (pre)} & 150 & 1·69 & 1·44, 2·02 & < 0.001 &  \\\\ \n{\\bfseries treatment} &  &  &  &  &  \\\\ \n    Placebo & 78 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 72 & 1·46 & 0·81, 2·66 & 0.212 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 58 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 92 & 1·35 & 0·68, 2·71 & 0.395 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 120 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 30 & 1·04 & 0·47, 2·32 & 0.922 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 95 & 1·00 & Ref. &  &  \\\\ \n    Yes & 55 & 0·98 & 0·52, 1·84 & 0.952 &  1.00 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 150 & 0·85 & 0·63, 1·13 & 0.273 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- ESIQ -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"esiq_calc_total\"\nvar_nice <- \"esiq-calc-total\"\nq_name <- \"ESIQ (total score)\"\nfit1 <- fit_esiq_calc_total_ordinal_diff\nfit2 <- fit_esiq_calc_total\nlm_table <- glm_Table_esiq_calc_total_ordinal_diff\nmodule <- \"module six (sexuality)\"\ntbl_cap <- paste0(\"Ordinal regression model for the Explicit Sexual Interest Questionnaire \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. Note, that the dependent variable has 3 ordered categories: worsening (increase), no change, improvement (decrease).\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". The plot shows that the assumptions of a linear model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### ESIQ\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Explicit Sexual Interest Questionnaire (ESIQ, total score). Note, that the dependent variable has 3 ordered categories: worsening (increase), no change, improvement (decrease).](_figures/fig-sec-rainplot-esiq-calc-total.png){#fig-sec-rainplot-esiq-calc-total}\n\n\n::: {#cell-fig-sec-lm-esiq-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for the Explicit Sexual Interest Questionnaire (ESIQ, total score). Note, that the dependent variable has 3 ordered categories: worsening (increase), no change, improvement (decrease)](_figures/fig-sec-diagnostic-plots-esiq-calc-total.png){#fig-sec-rainplot-esiq-calc-total}\n\n\n\n::: {#tbl-sec-lm-esiq-calc-total .cell tbl-cap='Ordinal regression model for the Explicit Sexual Interest Questionnaire ESIQ (total score) with n = 95 observations. Note, that the dependent variable has 3 ordered categories: worsening (increase), no change, improvement (decrease).'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-esiq-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5d898448.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-esiq-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-esiq-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f559f40b5.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries treatment} &  &  &  &  &  \\\\ \n    Placebo & 53 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 42 & 4·36 & 1·93, 10·3 & < 0.001 & 0.009 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 38 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 57 & 0·87 & 0·34, 2·19 & 0.764 & 1.000 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  \\\\ \n    community supervision & 77 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 18 & 0·88 & 0·29, 2·75 & 0.822 & 1.000 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  \\\\ \n    No & 59 & 1·00 & Ref. &  &  \\\\ \n    Yes & 36 & 1·19 & 0·49, 2·95 & 0.701 & 1.000 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 95 & 0·98 & 0·66, 1·45 & 0.904 & 1.000 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- BMS -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"kvm_score\"\nvar_nice <- \"kvm-score\"\nq_name <- \"BMS (total score)\"\nfit1 <- fit_kvm_score_logistic\nfit2 <- fit_kvm_score\nlm_table <- glm_Table_kvm_score\nmodule <- \"module five (offense-supportive attitudes)\"\ntbl_cap <- paste0(\"Logistic regression model for the Bumby Molest Scale \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 43.\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". The plot shows that the assumptions of a linear model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### BMS\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Bumby Molest Scale (BMS, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 43.](_figures/fig-sec-rainplot-kvm-score.png){#fig-sec-rainplot-kvm-score}\n\n\n::: {#cell-fig-sec-lm-kvm-score .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for the Bumby Molest Scale (BMS, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 43.](_figures/fig-sec-diagnostic-plots-kvm-score.png){#fig-sec-rainplot-kvm-score}\n\n\n\n::: {#tbl-sec-lm-kvm-score .cell tbl-cap='Logistic regression model for the Bumby Molest Scale BMS (total score) with n = 112 observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 43.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n        table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bms-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f269abf43.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bms-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-bms-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f7b828d24.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{Event N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Baseline value (pre)} &  &  &  &  &  &  \\\\ \n    FALSE & 48 & 6 & 1·00 & Ref. &  &  \\\\ \n    TRUE & 64 & 51 & 31·2 & 10·7, 111 & < 0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  &  \\\\ \n    Placebo & 59 & 24 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 53 & 33 & 3·51 & 1·22, 11·3 & 0.025 & 0.348 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 43 & 27 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 69 & 30 & 0·47 & 0·13, 1·60 & 0.229 & 1.000 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  &  \\\\ \n    community supervision & 91 & 45 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 21 & 12 & 1·27 & 0·28, 6·28 & 0.764 & 1.000 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  &  \\\\ \n    No & 70 & 32 & 1·00 & Ref. &  &  \\\\ \n    Yes & 42 & 25 & 1·60 & 0·52, 5·08 & 0.415 & 1.000 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 112 & 57 & 1·05 & 0·61, 1·77 & 0.866 & 1.000 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- HBI-19 -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"hbi_calc_total\"\nvar_nice <- \"hbi-calc-total\"\nq_name <- \"HBI-19 (total score)\"\nfit1 <- fit_hbi_calc_total_logistic\nfit2 <- fit_hbi_calc_total\nlm_table <- glm_Table_hbi_calc_total\nmodule <- \"module six (sexuality)\"\ntbl_cap <- paste0(\"Logistic regression model for the Hypersexual Behavior Inventory-19 \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 24.\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". The plot shows that the assumptions of a linear model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### HBI-19\n<!-- RAIN PLOT -->\n\n![Rainplot of the Hypersexual Behavior Inventory-19 (HBI-19, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 24.](_figures/fig-sec-rainplot-hbi-calc-total.png){#fig-sec-rainplot-hbi-total-score}\n\n\n::: {#cell-fig-sec-lm-hbi-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for the Hypersexual Behavior Inventory-19 (HBI-19, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 24.](_figures/fig-sec-diagnostic-plots-hbi-calc-total.png){#fig-sec-rainplot-hbi-calc-total}\n\n\n\n::: {#tbl-sec-lm-hbi-calc-total .cell tbl-cap='Logistic regression model for the Hypersexual Behavior Inventory-19 HBI-19 (total score) with n = 95 observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 24.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-hbi-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f374ea7a0.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-hbi-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-hbi-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f44287f19.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{Event N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Baseline value (pre)} &  &  &  &  &  &  \\\\ \n    FALSE & 50 & 13 & 1·00 & Ref. &  &  \\\\ \n    TRUE & 45 & 38 & 16·9 & 5·95, 55·5 & < 0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  &  \\\\ \n    Placebo & 53 & 24 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 42 & 27 & 2·84 & 0·98, 8·84 & 0.060 & 0.782 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 38 & 18 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 57 & 33 & 2·48 & 0·74, 8·92 & 0.148 & 1.000 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  &  \\\\ \n    community supervision & 77 & 42 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 18 & 9 & 0·65 & 0·14, 2·97 & 0.572 & 1.000 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  &  \\\\ \n    No & 59 & 29 & 1·00 & Ref. &  &  \\\\ \n    Yes & 36 & 22 & 2·63 & 0·85, 8·73 & 0.102 & 1.000 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 95 & 51 & 0·72 & 0·43, 1·17 & 0.190 & 1.000 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n<!-- SSIC -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nvar <- \"ssik_calc_total\"\nvar_nice <- \"ssik-calc-total\"\nq_name <- \"SSIC (total score)\"\nfit1 <- fit_ssik_calc_total_logistic\nfit2 <- fit_ssik_calc_total\nmodule <- \"module six (sexuality)\"\nlm_table <- glm_Table_ssik_calc_total\ntbl_cap <- paste0(\"Logistic regression model for the Specific self-efficacy for modifying Sexual Interest in Children \", q_name, \" with n = \", as.character(nobs(fit1)), \" observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 30.\")\nfig_cap <- paste(\"Diagnostic plot for a linear regression models with \", q_name, \". The plot shows that the assumptions of a linear model are not met.\")\n```\n:::\n\n\n{{< pagebreak >}}\n\n### SSIC\n\n<!-- RAIN PLOT -->\n\n![Rainplot of the Specific self-efficacy for modifying Sexual Interest in Children (SSIC, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 30.](_figures/fig-sec-rainplot-ssik-calc-total.png){#fig-sec-rainplot-ssik-calc-total}\n\n\n::: {#cell-fig-sec-lm-ssik-calc-total .cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggResidpanel)\nplt <- ggResidpanel::resid_panel(fit2, plots=c(\"qq\", \"resid\"))\n\nname_png <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.png\")\nname_pdf <- glue(\"_figures/fig-sec-diagnostic-plots-{var_nice}.pdf\")\n\nggsave(\n    here::here(name_png),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8,\n)\n\nggsave(\n    here::here(name_pdf),\n    plot = plt,\n    dpi = 300,\n    width = 16,\n    height = 8\n)\n```\n:::\n\n\n![Diagnostic plots for the Specific self-efficacy for modifying Sexual Interest in Children (SSIC, total score). Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 30.](_figures/fig-sec-diagnostic-plots-ssik-calc-total.png){#fig-sec-rainplot-ssik-calc-total}\n\n\n::: {#tbl-sec-lm-ssik-calc-total .cell tbl-cap='Logistic regression model for the Specific self-efficacy for modifying Sexual Interest in Children SSIC (total score) with n = 95 observations. Note, that for the dependent variable, values were dichotomized based on the cut-off greater or equal to 30.'}\n\n```{.r .cell-code .hidden}\ntbl <- lm_table %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ssic-calc-total.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f39f3ea22.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ssic-calc-total.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-sec-lm-ssic-calc-total.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f3e23b1e5.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccccc}\n\\toprule\n\\textbf{Variable} & \\textbf{N} & \\textbf{Event N} & \\textbf{OR} & \\textbf{95\\% CI} & \\textbf{p-value} & \\textbf{adjusted p value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Baseline value (pre)} &  &  &  &  &  &  \\\\ \n    FALSE & 51 & 18 & 1·00 & Ref. &  &  \\\\ \n    TRUE & 44 & 36 & 10·4 & 3·77, 33·0 & < 0.001 &  \\\\ \n{\\bfseries Treatment} &  &  &  &  &  &  \\\\ \n    Placebo & 53 & 31 & 1·00 & Ref. &  &  \\\\ \n    Intervention & 42 & 23 & 1·51 & 0·57, 4·24 & 0.411 &  1.00 \\\\ \n{\\bfseries Offense type} &  &  &  &  &  &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 38 & 23 & 1·00 & Ref. &  &  \\\\ \n    Hands-off (only §184b StGB) & 57 & 31 & 0·51 & 0·16, 1·54 & 0.239 &  1.00 \\\\ \n{\\bfseries Type of supervision} &  &  &  &  &  &  \\\\ \n    community supervision & 77 & 42 & 1·00 & Ref. &  &  \\\\ \n    post-release supervision & 18 & 12 & 0·86 & 0·21, 3·46 & 0.834 &  1.00 \\\\ \n{\\bfseries Additional treatment} &  &  &  &  &  &  \\\\ \n    No & 59 & 31 & 1·00 & Ref. &  &  \\\\ \n    Yes & 36 & 23 & 1·15 & 0·40, 3·25 & 0.797 &  1.00 \\\\ \n{\\bfseries Static recidivsm risk (baseline)} & 95 & 54 & 1·04 & 0·66, 1·64 & 0.868 &  1.00 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, OR = Odds Ratio\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n{{< pagebreak >}}\n\n## Adverse events\n\n### Mood and Risk Questionnaire (MRQ)\n\n::: {.landscape}\n<!-- MRQ Post-->\n\n::: {#tbl-mrq-frequency-highest-value-post .cell tbl-cap='Frequencies of adverse events during working on the WBI. The MRQ Post questionnaire explicitly asks for the time during working on one session. Shown are the frequency of participants reported at least once the highest possible score (= adverse event) on one of the measurement time-points (after each session of the WBI).'}\n\n```{.r .cell-code .hidden}\nlibrary(gtsummary)\nlibrary(gt)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(glue)\nlibrary(stringr)\n\n# global theme for gtsummary\ngtsummary::theme_gtsummary_journal(journal = \"lancet\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSetting theme \"The Lancet\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncramers_v <- function(tab) {\n  chi2 <- suppressWarnings(chisq.test(tab, correct = FALSE)$statistic)\n  n <- sum(tab)\n  min_dim <- min(dim(tab)) - 1\n  v <- sqrt(chi2 / (n * min_dim))\n  return(as.numeric(v))\n}\n\nfishers_test <- function(data, variable, by, ...) {\n\n  # Kreuztabelle erzeugen\n  tab <- table(data[[by]], data[[variable]])\n\n  # Fisher's Exact Test\n  fl <- stats::fisher.test(tab)\n\n  # 2×2: Odds Ratio + CI, sonst Cramér's V\n\n  estimate <- cramers_v(tab)\n\n  # Ergebnis als data.frame zurück für gtsummary\n  df <- data.frame(\n    estimate = estimate,\n    p.value = fl$p.value\n  )\n\n  return(df)\n}\n\nget_mrq_data <- function() {\n\n  make_timepoint <- function(df) {\n    df %>%\n      mutate(\n        timepoint = case_when(\n          current_module_nr == 0 & current_session_nr == 0 ~ \"Baseline\",\n          TRUE ~ glue(\"Module {current_module_nr}-Sitzung {current_session_nr}\")\n        )\n      )\n  }\n\n  factor_flashlight <- function(df, prefix) {\n\n    df %>%\n      mutate(\n        across(\n          all_of(paste0(prefix, \"_\", 1:8)),\n          ~ factor(.x, levels = c(0, 1, 2),\n                   labels = c(\"No\", \"Sometimes\", \"Often\"))\n        ),\n        !!paste0(prefix, \"_9\") := factor(\n          .data[[paste0(prefix, \"_9\")]],\n          levels = 1:5,\n          labels = c(\"Strongly disagree\", \"Disagree\",\n                     \"Partly agree\", \"Agree\", \"Strongly agree\")\n        ),\n        !!paste0(prefix, \"_10\") := factor(\n          .data[[paste0(prefix, \"_10\")]],\n          levels = 1:6,\n          labels = c(\"Very good\", \"Good\", \"Rather good\",\n                     \"Rather bad\", \"Bad\", \"Very bad\")\n        )\n      )\n  }\n\n  read_flashlight <- function(file, prefix, q_type) {\n    readRDS(file) %>%\n      as_tibble() %>%\n      make_timepoint() %>%\n      factor_flashlight(prefix) %>%\n      select(client_id, timepoint, starts_with(prefix)) %>%\n      pivot_longer(\n        cols = starts_with(prefix),\n        names_to = \"item\",\n        values_to = \"value\"\n      ) %>%\n      mutate(\n        q_type = q_type,\n        item = str_replace(item, paste0(prefix, \"_\"), \"flashlight_\")\n      )\n  }\n\n  fl_pre <- read_flashlight(\n    file = file.path(exportDirmyTabu, \"questionnaires_api_flashlightpre.rds\"),\n    prefix = \"flashlight_pre\",\n    q_type = \"pre\"\n  )\n\n  fl_post <- read_flashlight(\n    file = file.path(exportDirmyTabu, \"questionnaires_api_flashlightpost.rds\"),\n    prefix = \"flashlight_post\",\n    q_type = \"post\"\n  )\n\n  fl <- bind_rows(fl_pre, fl_post) %>%\n    pivot_wider(\n      id_cols = c(client_id, timepoint, q_type),\n      names_from = item,\n      values_from = value\n    ) %>%\n    arrange(client_id, timepoint, q_type)\n\n  return(fl)\n}\n\ndat_mrq <- get_mrq_data()\n\nmrq_at_least_one_highest_score <- dat_mrq %>%\n  mutate(\n    across(starts_with(\"flashlight_\"), ~ factor(.x, ordered = TRUE))\n  ) %>%\n  group_by(client_id, q_type) %>%\n  summarise(\n    # Item 1 bis 8: höchste Antwort = \"Often\"\n    flashlight_1_max_once = any(flashlight_1 == \"Often\"),\n    flashlight_2_max_once = any(flashlight_2 == \"Often\"),\n    flashlight_3_max_once = any(flashlight_3 == \"Often\"),\n    flashlight_4_max_once = any(flashlight_4 == \"Often\"),\n    flashlight_5_max_once = any(flashlight_5 == \"Often\"),\n    flashlight_6_max_once = any(flashlight_6 == \"Often\"),\n    flashlight_7_max_once = any(flashlight_7 == \"Often\"),\n    flashlight_8_max_once = any(flashlight_8 == \"Often\"),\n\n    # Item 9: höchste Antwort = \"Strongly agree\"\n    flashlight_9_max_once = any(flashlight_9 == \"Strongly agree\"),\n\n    # Item 10: extrem niedrig = \"Very bad\" (also extrem negativ, aber relevant)\n    flashlight_10_max_once = any(flashlight_10 == \"Very bad\"),\n\n    .groups = \"drop\"\n  )\n\ndat_clean_tmp_unique <- dat_clean %>%\n  dplyr::select(client_id, treatment, static99_modified_calc, \"Indexdelikt\", \"Aktuelle_Betreuung\", \"Aktuelle_zusatzliche_Behandlung\") %>%\n  group_by(client_id) %>%\n  slice_max(order_by = row_number(), n = 1) %>%  # oder slice_min(), je nach Bedarf\n  ungroup()\n\nmrq_at_least_one_highest_score_group <- mrq_at_least_one_highest_score %>%\n    mutate(\n        client_id = factor(client_id)\n    ) %>%\n    right_join(dat_clean_tmp_unique, by=c(\"client_id\"))\n\n# Dann tbl_summary mit diesen umkodierten Spalten\ntbl <- mrq_at_least_one_highest_score_group %>%\n    filter(q_type == \"post\") %>%\n    tbl_summary(\n        by = treatment,\n        include = starts_with(\"flashlight_\"),\n        #type = everything() ~ \"categorical\",\n        label = list(\n            flashlight_1_max_once ~ \"Contact planning\",\n            flashlight_2_max_once ~ \"Contact preparation\",\n            flashlight_3_max_once ~ \"Urge for CSA\",\n            flashlight_4_max_once ~ \"Urge for CSAM\",\n            flashlight_5_max_once ~ \"Sexual tension\",\n            flashlight_6_max_once ~ \"Control of sexual thoughts and activity\",\n            flashlight_7_max_once ~ \"Unable to cope with the mental burden\",\n            flashlight_8_max_once ~ \"Suicidal ideations\",\n            flashlight_9_max_once ~ \"Mental crisis\",\n            flashlight_10_max_once ~ \"Very bad current mood\"\n        ),\n        missing = \"no\"\n    ) %>%\n    add_stat(fns = everything() ~ fishers_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n        label = \"**MRQ subscale**\",\n        estimate = \"**Cramer's V**\",\n        p.value = \"**p**\"\n    ) %>%\n    add_overall() %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"p~adj~ = Holm-Bonferroni adjusted p.\") %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThere was a error for variable \"flashlight_2_max_once\"\nx 'x' muss mindestens 2 Zeilen und Spalten haben\nThere was a error for variable \"flashlight_3_max_once\"\nx 'x' muss mindestens 2 Zeilen und Spalten haben\nThere was a error for variable \"flashlight_4_max_once\"\nx 'x' muss mindestens 2 Zeilen und Spalten haben\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-post.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5104e1ba.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-post.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-post.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f46a56a51.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display  html-table-processing=none}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccccc}\n\\toprule\n\\textbf{MRQ subscale} & \\textbf{Overall}  N = 221\\textsuperscript{\\textit{1}} & \\textbf{Intervention}  N = 108\\textsuperscript{\\textit{1}} & \\textbf{Placebo}  N = 113\\textsuperscript{\\textit{1}} & \\textbf{Cramer's V} & \\textbf{p} & add\\_stat\\_1 & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Contact planning} & 2 (0·9\\%) & 1 (0·9\\%) & 1 (0·9\\%) & 0·002 & >0·99 &  & >0·99 \\\\ \n{\\bfseries Contact preparation} & 0 (0\\%) & 0 (0\\%) & 0 (0\\%) &  &  &  &  \\\\ \n{\\bfseries Urge for CSA} & 0 (0\\%) & 0 (0\\%) & 0 (0\\%) &  &  &  &  \\\\ \n{\\bfseries Urge for CSAM} & 0 (0\\%) & 0 (0\\%) & 0 (0\\%) &  &  &  &  \\\\ \n{\\bfseries Sexual tension} & 2 (0·9\\%) & 2 (1·9\\%) & 0 (0\\%) & 0·098 & 0·24 &  & >0·99 \\\\ \n{\\bfseries Control of sexual thoughts and activity} & 1 (0·5\\%) & 0 (0\\%) & 1 (0·9\\%) & 0·066 & >0·99 &  & >0·99 \\\\ \n{\\bfseries Unable to cope with the mental burden} & 9 (4·1\\%) & 7 (6·5\\%) & 2 (1·8\\%) & 0·119 & 0·10 &  & 0·57 \\\\ \n{\\bfseries Suicidal ideations} & 2 (0·9\\%) & 2 (1·9\\%) & 0 (0\\%) & 0·098 & 0·24 &  & >0·99 \\\\ \n{\\bfseries Mental crisis} & 15 (6·8\\%) & 11 (10\\%) & 4 (3·5\\%) & 0·132 & 0·062 &  & 0·44 \\\\ \n{\\bfseries Very bad current mood} & 12 (5·4\\%) & 8 (7·4\\%) & 4 (3·5\\%) & 0·085 & 0·24 &  & >0·99 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {\\textsuperscript{\\textit{1}} n (\\%)}}\\\\\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n:::\n\n::: {.landscape}\n<!-- MRQ Post-->\n\n::: {#tbl-mrq-frequency-highest-value-pre .cell tbl-cap='Frequencies of adverse events between working on sessions of the WBI. The MRQ pre questionnaire explicitly asks asks for the last week before beginning a new session. Shown are the frequency of participants reported at least once the highest possible score (= adverse event) on one of the measurement time-points (after each session of the WBI).'}\n\n```{.r .cell-code .hidden}\ntbl <- mrq_at_least_one_highest_score_group %>%\n    filter(q_type == \"pre\") %>%\n    tbl_summary(\n        by = treatment,\n        include = starts_with(\"flashlight_\"),\n        #type = everything() ~ \"categorical\",\n        label = list(\n            flashlight_1_max_once ~ \"Contact planning\",\n            flashlight_2_max_once ~ \"Contact preparation\",\n            flashlight_3_max_once ~ \"Urge for CSA\",\n            flashlight_4_max_once ~ \"Urge for CSAM\",\n            flashlight_5_max_once ~ \"Sexual tension\",\n            flashlight_6_max_once ~ \"Control of sexual thoughts and activity\",\n            flashlight_7_max_once ~ \"Unable to cope with the mental burden\",\n            flashlight_8_max_once ~ \"Suicidal ideations\",\n            flashlight_9_max_once ~ \"Mental crisis\",\n            flashlight_10_max_once ~ \"Very bad current mood\"\n        ),\n        missing = \"no\"\n    ) %>%\n    add_stat(fns = everything() ~ fishers_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n        label = \"**MRQ subscale**\",\n        estimate = \"**Cramer's V**\",\n        p.value = \"**p**\"\n    ) %>%\n    add_q(method = \"holm\") %>%\n    add_overall() %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"p~adj~ = Holm-Bonferroni adjusted p.\") %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThere was a error for variable \"flashlight_3_max_once\"\nx 'x' muss mindestens 2 Zeilen und Spalten haben\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-pre.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f44dd5a12.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-pre.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-mrq-frequency-highest-value-pre.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f622e0cdf.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccccccc}\n\\toprule\n\\textbf{MRQ subscale} & \\textbf{Overall}  N = 221\\textsuperscript{\\textit{1}} & \\textbf{Intervention}  N = 108\\textsuperscript{\\textit{1}} & \\textbf{Placebo}  N = 113\\textsuperscript{\\textit{1}} & \\textbf{Cramer's V} & \\textbf{p} & add\\_stat\\_1 & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Contact planning} & 3 (1·4\\%) & 3 (2·8\\%) & 0 (0\\%) & 0·120 & 0·12 &  & >0·99 \\\\ \n{\\bfseries Contact preparation} & 1 (0·5\\%) & 1 (0·9\\%) & 0 (0\\%) & 0·069 & 0·49 &  & >0·99 \\\\ \n{\\bfseries Urge for CSA} & 0 (0\\%) & 0 (0\\%) & 0 (0\\%) &  &  &  &  \\\\ \n{\\bfseries Urge for CSAM} & 2 (0·9\\%) & 1 (0·9\\%) & 1 (0·9\\%) & 0·002 & >0·99 &  & >0·99 \\\\ \n{\\bfseries Sexual tension} & 8 (3·6\\%) & 6 (5·6\\%) & 2 (1·8\\%) & 0·101 & 0·16 &  & >0·99 \\\\ \n{\\bfseries Control of sexual thoughts and activity} & 2 (0·9\\%) & 2 (1·9\\%) & 0 (0\\%) & 0·098 & 0·24 &  & >0·99 \\\\ \n{\\bfseries Unable to cope with the mental burden} & 20 (9·0\\%) & 11 (10\\%) & 9 (8·0\\%) & 0·039 & 0·64 &  & >0·99 \\\\ \n{\\bfseries Suicidal ideations} & 4 (1·8\\%) & 1 (0·9\\%) & 3 (2·7\\%) & 0·065 & 0·62 &  & >0·99 \\\\ \n{\\bfseries Mental crisis} & 16 (7·2\\%) & 11 (10\\%) & 5 (4·4\\%) & 0·111 & 0·12 &  & >0·99 \\\\ \n{\\bfseries Very bad current mood} & 8 (3·6\\%) & 5 (4·6\\%) & 3 (2·7\\%) & 0·053 & 0·49 &  & >0·99 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {\\textsuperscript{\\textit{1}} n (\\%)}}\\\\\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n::::\n\n{{< pagebreak >}}\n\n::: {.landscape}\n\n### Exclusion reasons\n\n\n::: {#tbl-exclusion-questionnaire .cell tbl-cap='Frequencies of exclusion reasons reported by the supervision officers. Exclusion reasons have been assessed in a structured manner by the Exclusion Questionnaire (EQ).'}\n\n```{.r .cell-code .hidden}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(gt)\nlibrary(gtsummary)\nlibrary(purrr)\n\ncramers_v <- function(tab) {\n  chi2 <- suppressWarnings(chisq.test(tab, correct = FALSE)$statistic)\n  n <- sum(tab)\n  min_dim <- min(dim(tab)) - 1\n  v <- sqrt(chi2 / (n * min_dim))\n  return(as.numeric(v))\n}\n\nfishers_test <- function(data, variable, by, ...) {\n\n  # Kreuztabelle erzeugen\n  tab <- table(data[[by]], data[[variable]])\n\n  # Fisher's Exact Test\n  fl <- stats::fisher.test(tab)\n\n  # 2×2: Odds Ratio + CI, sonst Cramér's V\n\n  estimate <- round(cramers_v(tab), 2)\n\n  # Ergebnis als data.frame zurück für gtsummary\n  df <- data.frame(\n    estimate = estimate,\n    p.value = fl$p.value\n  )\n\n  return(df)\n}\n\n# exclusion reasons by timepoint and treatment\nget_exclusion_reason_timepointxtreatment <- function() {\n\n  dat_exclusion_2 <- q_exclusion %>%\n    right_join(matching) %>%\n    left_join((randdat %>% dplyr::select(ID, treatment, `4.2 Bundesland:`))) %>%\n    filter(!is.na(treatment)) %>%\n    mutate(\n      Category = `Welche Gründe (Bitte Auflistung mittels KOMMA trennen)?` %>% sapply(categorize_reason) %>% factor(),\n      `recidivism` = if_else(`Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen`==\"Yes\" | `Klient hat eine Straftat gemäß § 184b StGB begangen` == \"Yes\" |\n                                                      (`Verstoß gegen Weisungen`==\"Yes\" & `Gegen welche Weisungen wurde verstoßen (Bitte Auflistung mittels KOMMA trennen)?` %in% c(\"erneute Straftaten\", \"Kontakt zu Kindern unter 16 Jahren\", \"Kontaktaufnahme zum Kind am Sportplatz ( darf sich nicht an Plätzen wie Sportstätten etc. aufhalten)\", \"Sich nicht an Plätzen aufzuhalten, die üblicherweise von Kindern und Jugendlichen frequentiert werden, keinerlei Tätigkeiten auszuüben, die im Zusammenhang mit der Betreuung von Kindern und Jugendlichen stehen.\") & `Kam es zu einer Verurteilung?`==\"Yes\"), \"Yes\", \"No\"),\n      `evidence_for_recidivism` = if_else(`Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen`==\"Yes\" | `Klient hat eine Straftat gemäß § 184b StGB begangen` == \"Yes\" |\n                                    (`Verstoß gegen Weisungen`==\"Yes\" & `Gegen welche Weisungen wurde verstoßen (Bitte Auflistung mittels KOMMA trennen)?` %in% c(\"erneute Straftaten\", \"Kontakt zu Kindern unter 16 Jahren\", \"Kontaktaufnahme zum Kind am Sportplatz ( darf sich nicht an Plätzen wie Sportstätten etc. aufhalten)\", \"Sich nicht an Plätzen aufzuhalten, die üblicherweise von Kindern und Jugendlichen frequentiert werden, keinerlei Tätigkeiten auszuüben, die im Zusammenhang mit der Betreuung von Kindern und Jugendlichen stehen.\") & `Kam es zu einer Verurteilung?`==\"Yes\") | `Welche Gründe (Bitte Auflistung mittels KOMMA trennen)?` %in% c(\"Handy seit mehreren Monaten bei der Polizei, weitere Straftaten unklar, arbeitet nicht mit\", \"Aufgrund neuer Strafanzeigen in U-Haft, Gerichtsverhandlung noch ausstehend\", \"Anordnung Untersuchungshaft\"#, \"Schwebendes Verfahren (bereits vor Aufnahme) ist abgeurteilt (Straftat nach 184b)\"\n                                  ), \"Yes\", \"No\"),\n      status = ifelse(excluded_at >= as.Date('2024-10-02') & status == 7,9,status)\n    ) %>%\n    mutate(\n      client_status = factor(as.numeric(status),\n                                  levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9),\n                                  labels = c('active - logged in', 'Aktive Teilnahme (Einführung abgeschlossen)', 'Aktive Teilnahme am Programm', 'Inhalt abgeschlossen', 'Programm abgeschlossen', 'Ausschluss beantragt', 'Ausgeschlossen', 'In Datenbank registriert', 'Klinischer Trial beendet vor Abschluss'))\n    )\n\n  dat_excl <- dat_exclusion_2 %>%\n    filter(\n      client_status == \"Ausgeschlossen\" | client_status == 'Klinischer Trial beendet vor Abschluss'\n    ) %>%\n    mutate(\n      end_of_trial = factor(\n        ifelse(\n          excluded_at >= \"2024-10-02\",\n          \"Yes\",\n          \"No\"\n        ),\n        levels = c(\"Yes\", \"No\")\n      ),\n      mixed_offense = factor(\n        ifelse(`Klient hat eine Straftat gemäß § 184b StGB begangen` == \"Yes\" & `Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen` == \"Yes\", \"Yes\", \"No\"),\n        levels = c(\"Yes\", \"No\")\n      )\n    ) %>%\n    mutate(\n      csem_offense_only = case_when(\n          `Klient hat eine Straftat gemäß § 184b StGB begangen` == \"Yes\" & mixed_offense == \"Yes\" ~ \"No\",\n          `Klient hat eine Straftat gemäß § 184b StGB begangen` == \"Yes\" & mixed_offense == \"No\" ~ \"Yes\",\n          `Klient hat eine Straftat gemäß § 184b StGB begangen` == \"No\" ~ \"No\"\n        ),\n      csa_offense_only = case_when(\n          `Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen` == \"Yes\" & mixed_offense == \"Yes\" ~ \"No\",\n          `Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen` == \"Yes\" & mixed_offense == \"No\" ~ \"Yes\",\n          `Klient hat eine Straftat gemäß §§ 176, 176a oder 176b StGB begangen` == \"No\" ~ \"No\"\n        ),\n      violation_probation_conditions = factor(ifelse(\n        `Verstoß gegen Weisungen` == \"Yes\" | `Verstoß gegen Auflagen` == \"Yes\",\n        \"Yes\",\n        \"No\"),\n        levels = c(\"Yes\", \"No\")\n      )\n    ) %>%\n    dplyr::select(\n      client_id,\n      treatment,\n      end_of_trial,\n      `Widerruf der Einverständniserklärung`,\n      `Die Zeit der Bewährungsaufsicht/Führungsaufsicht ist abgelaufen`,\n      `Klient hat eine andere Straftat begangen (nicht gemäß §§ 176, 176a, 176b oder 184b StGB)`,\n      `akute Selbstgefährdung des Klienten (z.B. konkrete Suizidplanung)`,\n      `andere Gründe als die bisher genannten Gründe`,\n      mixed_offense,\n      csem_offense_only,\n      csa_offense_only,\n      violation_probation_conditions\n    ) %>%\n    rename(\n      \"Withdrawal of informed consent\" = `Widerruf der Einverständniserklärung`,\n      \"Probationary supervision expired\" = `Die Zeit der Bewährungsaufsicht/Führungsaufsicht ist abgelaufen`,\n      \"Other offense (not CSA or CSEM)\" = `Klient hat eine andere Straftat begangen (nicht gemäß §§ 176, 176a, 176b oder 184b StGB)`,\n      \"Acute suicide risk\" = `akute Selbstgefährdung des Klienten (z.B. konkrete Suizidplanung)`,\n      \"Other reasons\" = `andere Gründe als die bisher genannten Gründe`,\n      \"End of RCT\" = end_of_trial,\n      \"CSA and CSEM offense\" = mixed_offense,\n      \"CSEM offense\" = csem_offense_only,\n      \"CSA offense\" = csa_offense_only,\n      \"Violation of probation conditions\" = violation_probation_conditions\n    ) %>%\n    # einige Kombinationen bieten keinen zusätzlichen Infogehalt und sind logische Konsequenz des eigentlichen Grundes\n    # - withdrawal of informed consent ist dann nicht relevant, wenn mit offense in Verbindung steht\n    # - Probationary supervision expired ist bei aufgetretenem reoffence eine logische Konsequenz, da die Bewährung in diesem Fall widerrufen wird\n    # - re-offene == Violation of probation conditions\n    mutate(\n      `Withdrawal of informed consent` = case_when(\n        `Withdrawal of informed consent` == \"Yes\" & `CSA and CSEM offense` == \"Yes\" ~ \"No\",\n        `Withdrawal of informed consent` == \"Yes\" & `CSA offense` == \"Yes\" ~ \"No\",\n        `Withdrawal of informed consent` == \"Yes\" & `CSEM offense` == \"Yes\" ~ \"No\",\n        `Withdrawal of informed consent` == \"Yes\" & `Other offense (not CSA or CSEM)` == \"Yes\" ~ \"No\",\n        `Withdrawal of informed consent` == \"Yes\" & `Violation of probation conditions` == \"Yes\" ~ \"No\",\n        `Withdrawal of informed consent` == \"Yes\" & `Probationary supervision expired` == \"Yes\" ~ \"No\",\n        TRUE ~ `Withdrawal of informed consent`\n      ),\n      # withdrawal of informed consent ist dann nicht relevant, wenn mit offense kombiniert, da offense automatisch einen Verstoß gegen probation conditions bedeutet\n      `Violation of probation conditions` = case_when(\n        `Violation of probation conditions` == \"Yes\" & `CSA and CSEM offense` == \"Yes\" ~ \"No\",\n        `Violation of probation conditions` == \"Yes\" & `CSA offense` == \"Yes\" ~ \"No\",\n        `Violation of probation conditions` == \"Yes\" & `CSEM offense` == \"Yes\" ~ \"No\",\n        `Violation of probation conditions` == \"Yes\" & `Other offense (not CSA or CSEM)` == \"Yes\" ~ \"No\",\n        TRUE ~ `Violation of probation conditions`\n      ),\n      # see above\n      `Probationary supervision expired` = case_when(\n        `Probationary supervision expired` == \"Yes\" & `CSA and CSEM offense` == \"Yes\" ~ \"No\",\n        `Probationary supervision expired` == \"Yes\" & `CSA offense` == \"Yes\" ~ \"No\",\n        `Probationary supervision expired` == \"Yes\" & `CSEM offense` == \"Yes\" ~ \"No\",\n        `Probationary supervision expired` == \"Yes\" & `Other offense (not CSA or CSEM)` == \"Yes\" ~ \"No\",\n        `Probationary supervision expired` == \"Yes\" & `End of RCT` == \"Yes\" ~ \"No\",\n        TRUE ~ `Probationary supervision expired`\n      )\n\n    )\n\n  # all NAs are in the sense of \"No\"\n  dat_excl[is.na(dat_excl)] <- \"No\"\n\n  dat_excl <- dat_excl %>%\n    filter(!client_id %in% c(253, 396)) %>%\n    mutate(\n      exclusion_reason_count = rowSums(across(c(\n        `Withdrawal of informed consent`,\n        `Probationary supervision expired`,\n        `Violation of probation conditions`,\n        `Other offense (not CSA or CSEM)`,\n        `CSA and CSEM offense`,\n        `CSEM offense`,\n        `CSA offense`,\n        `Acute suicide risk`,\n        `Other reasons`,\n        `End of RCT`), \n        ~ . == \"Yes\")),\n      exclusion_reasons_list = apply(dplyr::select(., \n        `Withdrawal of informed consent`,\n        `Probationary supervision expired`,\n        `Violation of probation conditions`,\n        `CSA and CSEM offense`,\n        `CSEM offense`,\n        `CSA offense`,\n        `Other offense (not CSA or CSEM)`,\n        `Acute suicide risk`,\n        `Other reasons`,\n        `End of RCT`),\n        1, \n        function(row) {\n          yes_cols <- names(row[row == \"Yes\"])\n          paste(yes_cols, collapse = \", \")\n        })\n    )\n\n    return(dat_excl)\n}\n\ntmp <- get_exclusion_reason_timepointxtreatment()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(client_id)`\nJoining with `by = join_by(ID)`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# ToDo: hier müsste man noch recidivism mitnehmen\ntmp_wide <- tmp %>%\n  dplyr::select(client_id, treatment, exclusion_reasons_list) %>%\n  unnest(exclusion_reasons_list) %>%\n  mutate(value = \"Yes\") %>%\n  pivot_wider(\n    names_from = exclusion_reasons_list,\n    values_from = value,\n    values_fill = \"No\"\n  )\n\ntbl <- tmp_wide %>%\n    dplyr::filter(client_id %in% client_list) %>%\n    dplyr::select(-client_id, -`Violation of probation conditions`, -`Violation of probation conditions, Acute suicide risk`, -`CSEM offense, Acute suicide risk`, -`CSA offense, Other offense (not CSA or CSEM), Acute suicide risk`) %>%\n    tbl_summary(\n        by = treatment\n        #type = everything() ~ \"categorical\"\n    ) %>%\n    add_stat(fns = everything() ~ fishers_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n        label = \"**Exclusion reason**\",\n        estimate = \"**Cramer's V**\",\n        p.value = \"**p**\"\n    ) %>%\n    add_q(method = \"holm\") %>%\n    add_overall() %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"p~adj~ = Holm-Bonferroni adjusted p.\") %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccccc}\n\\toprule\n\\textbf{Exclusion reason} & \\textbf{Overall}  N = 124\\textsuperscript{\\textit{1}} & \\textbf{Intervention}  N = 66\\textsuperscript{\\textit{1}} & \\textbf{Placebo}  N = 58\\textsuperscript{\\textit{1}} & \\textbf{Cramer's V} & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Other reasons} & 17 (14\\%) & 10 (15\\%) & 7 (12\\%) & 0·040 & 0·79 & >0·99 \\\\ \n{\\bfseries Withdrawal of informed consent} & 7 (5·6\\%) & 4 (6·1\\%) & 3 (5·2\\%) & 0·020 & >0·99 & >0·99 \\\\ \n{\\bfseries Probationary supervision expired} & 22 (18\\%) & 8 (12\\%) & 14 (24\\%) & 0·160 & 0·10 & 0·91 \\\\ \n{\\bfseries CSA offense, Other offense (not CSA or CSEM)} & 1 (0·8\\%) & 0 (0\\%) & 1 (1·7\\%) & 0·100 & 0·47 & >0·99 \\\\ \n{\\bfseries CSA and CSEM offense} & 2 (1·6\\%) & 1 (1·5\\%) & 1 (1·7\\%) & 0·010 & >0·99 & >0·99 \\\\ \n{\\bfseries Other offense (not CSA or CSEM)} & 3 (2·4\\%) & 3 (4·5\\%) & 0 (0\\%) & 0·150 & 0·25 & >0·99 \\\\ \n{\\bfseries CSA offense} & 1 (0·8\\%) & 0 (0\\%) & 1 (1·7\\%) & 0·100 & 0·47 & >0·99 \\\\ \n{\\bfseries CSEM offense} & 1 (0·8\\%) & 1 (1·5\\%) & 0 (0\\%) & 0·080 & >0·99 & >0·99 \\\\ \n{\\bfseries End of RCT} & 70 (56\\%) & 39 (59\\%) & 31 (53\\%) & 0·060 & 0·59 & >0·99 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {\\textsuperscript{\\textit{1}} n (\\%)}}\\\\\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n:::\n\n\n{{< pagebreak >}}\n\n## Ancillary Outcomes\n\n### WHO-5\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(gt)\nlibrary(gtsummary)\n\nget_who_data <- function() {\n  infile <- file.path(exportDirmyTabu, \"questionnaires_api_who.rds\")\n  who <- readRDS(infile) %>% as_tibble\n\n  # the who was assessed before and after each module (not only before m1 and then after the module)\n  #\n  who <-\n    who %>%\n    mutate(timepoint = case_when(\n      current_module_nr == 1 & current_session_nr == 1 ~ 'Baseline',\n      current_module_nr == 1 & current_session_nr == 4 ~ 'Module 1 (post)',\n      current_module_nr == 2 & current_session_nr == 1 ~ 'Module 2 (before)',\n      current_module_nr == 2 & current_session_nr == 4 ~ 'Module 2 (post)',\n      current_module_nr == 3 & current_session_nr == 1 ~ 'Module 3 (before)',\n      current_module_nr == 3 & current_session_nr == 4 ~ 'Module 3 (post)',\n      current_module_nr == 4 & current_session_nr == 1 ~ 'Module 4 (before)',\n      current_module_nr == 4 & current_session_nr == 4 ~ 'Module 4 (post)',\n      current_module_nr == 5 & current_session_nr == 1 ~ 'Module 5 (before)',\n      current_module_nr == 5 & current_session_nr == 4 ~ 'Module 5 (post)',\n      current_module_nr == 6 & current_session_nr == 1 ~ 'Module 6 (before)',\n      current_module_nr == 6 & current_session_nr == 4 ~ 'Module 6 (post)'),\n      timepoint = factor(\n        timepoint),\n      client_id = factor(client_id))\n\n  who$who_calc_total <- rowSums(who[, c('who_1', 'who_2', 'who_3', 'who_4', 'who_5')], na.rm = TRUE)*4\n\n  who_tmp <- who %>% dplyr::select(client_id, timepoint, who_calc_total)\n\n  dat_clean_tmp <- dat_clean %>%\n    filter(timepoint == \"Baseline\")\n\n  dat_clean_tmp <- dat_clean_tmp %>%\n    select(client_id, treatment, static99_modified_calc, \"Indexdelikt\", \"Aktuelle_Betreuung\", \"Aktuelle_zusatzliche_Behandlung\")\n\n  who_complete <- who_tmp %>% left_join(dat_clean_tmp, by=\"client_id\")\n\n  who_baseline <- who_complete %>%\n    filter(timepoint == \"Baseline\") %>%\n    select(\n      client_id,\n      who_calc_total\n    ) %>%\n    rename(\n      who_calc_total_baseline = who_calc_total\n    )\n\n  who_clean <- merge(\n        who_complete, who_baseline, by=\"client_id\", all=TRUE\n      ) %>%\n      mutate(client_id = as.factor(client_id)) %>%\n      filter(!client_id %in% c(194, 412, 511) & !is.na(client_id)) %>%\n      filter(client_id %in% client_list)\n\n  who_clean <- who_clean %>% janitor::clean_names(case=\"none\") %>%\n    filter(client_id %in% client_list)\n\n  who_clean <- who_clean %>%\n        dplyr::mutate_if(~inherits(., \"ordered\"), ~factor(., ordered = FALSE))\n\n  return(who_clean)\n}\n\nwho_clean <- get_who_data()\n\nvariable <- \"who_calc_total\"\nvar_name <- \"WHO-5\"\n\nformular <- as.formula(\n    paste(\n        variable, \"~\", paste0(variable, \"_baseline\"), \"+ timepoint + treatment:timepoint + `Indexdelikt` + `Aktuelle_Betreuung` + `Aktuelle_zusatzliche_Behandlung` + `static99_modified_calc` +\n            us(timepoint | client_id)\"\n    )\n)\n\nfit_who <- mmrm(\n        formula = formular,\n        data = who_clean %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n            dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n    )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncreate_who_mmrm_table <- function() {\n\n    who_clean <- get_who_data()\n\n    variable <- \"who_calc_total\"\n    var_name <- \"WHO-5\"\n\n    formular <- as.formula(\n        paste(\n            variable, \"~\", paste0(variable, \"_baseline\"), \"+ timepoint + treatment:timepoint + `Indexdelikt` + `Aktuelle_Betreuung` + `Aktuelle_zusatzliche_Behandlung` + `static99_modified_calc` +\n                us(timepoint | client_id)\"\n        )\n    )\n\n    fit1_model <- mmrm(\n            formula = formular,\n            data = who_clean %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n                dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n        )\n\n    dynamic_label_text <- paste0(\"Baseline value (\",  var_name, \")\")\n    variable_baseline_name <- paste0(variable, \"_baseline\")\n    dynamic_entry <- setNames(list(dynamic_label_text), variable_baseline_name)\n\n    label_list <- c(\n        list(\n            static99_modified_calc = \"Static recidivism risk (baseline)\",\n            Aktuelle_Betreuung = \"Type of supervision\",\n            Aktuelle_zusatzliche_Behandlung = \"Additional treatment\",\n            Indexdelikt = \"Offense type\",\n            treatment = \"Treatment\",\n            timepoint = \"Timepoint\",\n            `Timepoint * treatment` = \"Timepoint * Treatment\"\n        ),\n        dynamic_entry   # hier wird dynamisch angehängt\n    )\n\n    lm_Table <- fit1_model %>%\n        tbl_regression(\n            add_estimate_to_reference_rows = TRUE,\n            intercept = TRUE,\n            label = label_list\n        ) %>%\n        modify_header(label ~ \"**Variable**\") %>%\n        modify_table_styling(\n            columns = c(estimate, conf.low, conf.high),\n            rows = reference_row %in% TRUE,\n            missing_symbol = \"Ref.\"\n        ) %>%\n        #modify_footnote(abbreviation = TRUE) %>%\n        bold_labels() %>%\n        # abbreviations\n        modify_abbreviation(\"CI = Confidence interval, StGB = German penalty law.\") %>%\n        as_gt() %>%\n        gt::tab_options(\n          table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n        ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n    return(lm_Table)\n}\n\ncreate_who_pairwise_dataframe <- function(variable = \"who_calc_total\") {\n\n  # Paired tests for IoD:\n  df <- who_clean %>%\n    dplyr::filter(!is.na(.data[[variable]]))\n\n  dat_complete_module1_iod <- df %>% dplyr::filter(timepoint %in% c(\"Baseline\", \"Module 1 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Baseline\" ~ \"pre\",\n                                \"Module 1 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 1` = variable)\n\n  dat_complete_module2_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 2 (before)\", \"Module 2 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 2 (before)\" ~ \"pre\",\n                                \"Module 2 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 2` = variable)\n  dat_complete_module3_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 3 (before)\", \"Module 3 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 3 (before)\" ~ \"pre\",\n                                \"Module 3 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 3` = variable)\n  dat_complete_module4_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 4 (before)\", \"Module 4 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 4 (before)\" ~ \"pre\",\n                                \"Module 4 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 4` = variable)\n  dat_complete_module5_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 5 (before)\", \"Module 5 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 5 (before)\" ~ \"pre\",\n                                \"Module 5 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 5` = variable)\n  dat_complete_module6_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 6 (before)\", \"Module 6 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 6 (before)\" ~ \"pre\",\n                                \"Module 6 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 6` = variable)\n\n  df <- dat_complete_module1_iod %>%\n    dplyr::select(contains(\"pre/post\"), client_id, timepoint, treatment) %>%\n    dplyr::filter(!client_id %in% c(253, 396)) %>%\n    merge(.,\n          dat_complete_module2_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module3_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module4_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module5_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module6_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    arrange(client_id, desc(timepoint)) %>%\n    dplyr::filter(!is.na(timepoint)) %>%\n    dplyr::mutate(timepoint = relevel(timepoint, \"pre\"))\n\n    return(df)\n}\n\ncreate_who_pairwise_tbls <- function(\n  subgroup_str = \"Intervention\"\n) {\n\n  dvs <- c(\n    \"Module 1\",\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n\n  dvs_mbsb <- c(\n    \"module_1\",\n    \"module_2\",\n    \"module_3\",\n    \"module_4\",\n    \"module_5\",\n    \"module_6\"\n  )\n\n  labels <- c(\n    \"Module 1\",\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n  types = rep(\"continuous2\", 6)\n  abbreviations <- c(\"\")\n  sample_str <- \"itt\"\n  mbsb <- TRUE\n  grouping_var <- \"treatment\"\n\n  variable = \"who_calc_total\"\n\n  # create dvs and grouping_var based on mbsb\n  if (mbsb) {\n    dvs <- dvs_mbsb\n    # grouping variable (which variables should be compared - must have two levels)\n    grouping_var <- \"treatment\"\n\n    if (grepl(\"reduced\", dvs[1])) {\n      print(\"It must be a reduced variable!\")\n      dat <- create_who_pairwise_dataframe(paste0(variable, \"_reduced\"))\n        dat_i <- dat %>% filter(treatment == \"Intervention\") %>%\n                    dplyr::select(contains(\"pre/post\"), timepoint)\n        dat_p <- dat %>% filter(treatment == \"Placebo\") %>%\n        dplyr::select(contains(\"pre/post\"), timepoint)\n    } else {\n      dat <- create_pairwise_dataframe(variable)\n      dat_i <- dat %>% filter(treatment == \"Intervention\") %>%\n                  dplyr::select(contains(\"pre/post\"), timepoint)\n      dat_p <- dat %>% filter(treatment == \"Placebo\") %>%\n        dplyr::select(contains(\"pre/post\"), timepoint)\n    }\n\n    data_intervention <- rename_colnames_iod(\n      data = dat_i,\n      dv = dvs[1],\n      grouping_var\n    )\n\n    data_placebo <- rename_colnames_iod(\n      data = dat_p,\n      dv = dvs[1],\n      grouping_var\n    )\n  } else {\n    # grouping variable (which variables should be compared - must have two levels)\n    grouping_var <- \"client_group\"\n    stop(\"Only mbsb = TRUE is implemented\")\n  }\n\n  # create label_list\n  label_list <- purrr::map2(dvs, labels, ~rlang::new_formula(sym(.x), .y))\n\n  # create list of types\n  type_list <- purrr::map2(dvs, types, ~rlang::new_formula(sym(.x), .y))\n\n  if (subgroup_str == \"Intervention\") {\n    tbl <- create_prim_pairwise_tbl(data_intervention, dvs, label_list, type_list, abbreviations)\n  } else if (subgroup_str == \"Placebo\") {\n    tbl <- create_prim_pairwise_tbl(data_placebo, dvs, label_list, type_list, abbreviations)\n  } else {\n    stop(\"subgroup_str must be either 'Intervention' or 'Placebo'\")\n  }\n\n  return(tbl)\n}\n\ncreate_who_diffscore_dataframe <- function(variable) {\n\n  df <- who_clean %>%\n    dplyr::filter(!is.na(.data[[variable]]))\n\n  dat_complete_module1_iod <- df %>% dplyr::filter(timepoint %in% c(\"Baseline\", \"Module 1 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Baseline\" ~ \"pre\",\n                                \"Module 1 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 1` = variable)\n\n  dat_complete_module2_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 2 (before)\", \"Module 2 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 2 (before)\" ~ \"pre\",\n                                \"Module 2 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 2` = variable)\n  dat_complete_module3_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 3 (before)\", \"Module 3 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 3 (before)\" ~ \"pre\",\n                                \"Module 3 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 3` = variable)\n  dat_complete_module4_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 4 (before)\", \"Module 4 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 4 (before)\" ~ \"pre\",\n                                \"Module 4 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 4` = variable)\n  dat_complete_module5_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 5 (before)\", \"Module 5 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 5 (before)\" ~ \"pre\",\n                                \"Module 5 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 5` = variable)\n  dat_complete_module6_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 6 (before)\", \"Module 6 (post)\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 6 (before)\" ~ \"pre\",\n                                \"Module 6 (post)\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 6` = variable)\n\n  df <- dat_complete_module1_iod %>%\n    dplyr::select(contains(\"pre/post\"), client_id, timepoint, treatment) %>%\n    dplyr::filter(!client_id %in% c(253, 396)) %>%\n    merge(.,\n          dat_complete_module2_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module3_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module4_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module5_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module6_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    arrange(client_id, desc(timepoint)) %>%\n    dplyr::filter(!is.na(timepoint)) %>%\n    dplyr::mutate(timepoint = relevel(timepoint, \"pre\"))\n\n  # Reshape the data: separate \"pre\" and \"post\" values into columns\n  df_wide <- df %>%\n    dplyr::select(contains(\"pre/post\"), timepoint, client_id, treatment) %>%\n    tidyr::pivot_wider(names_from = timepoint, values_from = -c(client_id, timepoint, treatment)) %>%\n    dplyr::mutate(`treatment` = `treatment` %>% relevel(ref = \"Placebo\"))\n\n  names(df_wide) %<>% gsub(\"pre/post \", \"\", .)\n\n  # Compute the differences (post - pre)\n  df_diff <- df_wide %>%\n    mutate(across(ends_with(\"post\"), ~ . - get(sub(\"post\", \"pre\", cur_column())), .names = \"diff_{.col}\")) %>%\n    rename_with(~ sub(\"_post$\", \"\", .), starts_with(\"diff_\")) %>%\n    dplyr::select(client_id, starts_with(\"diff_\"), treatment)\n\n  df_diff <- df_diff %>%\n    dplyr::select(-client_id) %>%\n    filter(!is.na(treatment))\n\n   return(df_diff)\n}\n\ncreate_who_diffscore_tbl <- function(\n  variable = \"who_calc_total\"\n) {\n\n  who_clean <- get_who_data()\n\n  mbsb <- TRUE\n  grouping_var <- \"treatment\"\n\n  dvs <- c(\n    \"Module 1\",\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n\n  dvs_mbsb <- c(\n    \"diff_module_1\",\n    \"diff_module_2\",\n    \"diff_module_3\",\n    \"diff_module_4\",\n    \"diff_module_5\",\n    \"diff_module_6\"\n  )\n\n  labels <- c(\n    \"Module 1\",\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n  types = rep(\"continuous2\", 6)\n\n  abbreviations <- c(\"\")\n\n  sample_str <- \"itt\"\n\n  dvs <- dvs_mbsb\n\n  # create label_list\n  label_list <- purrr::map2(dvs, labels, ~rlang::new_formula(sym(.x), .y))\n\n  # create list of types\n  type_list <- purrr::map2(dvs, types, ~rlang::new_formula(sym(.x), .y))\n\n  df_diff <- create_who_diffscore_dataframe(variable)\n\n  tbl_data <- get_diffscore_mbsb_prim(df_diff, dvs, grouping_var)\n\n  tbl <- create_prim_diff_tbl(tbl_data, dvs, label_list, grouping_var, abbreviations, type_list)\n\n  # show table\n  return(tbl)\n}\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggrain)\n\nscale_colour_group <- function(...) {\n  scale_colour_manual(\n    values = c(\n      \"Intervention\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[2],\n      \"Placebo\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[1]\n    )\n  )\n}\n\nscale_fill_group <- function(...) {\n  scale_fill_manual(\n    values = c(\n      \"Intervention\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[2],\n      \"Placebo\" = ggsci::pal_lancet(palette = \"lanonc\", alpha = 1)(2)[1]\n    )\n  )\n}\n\nadd_gg_theme <- function(plt) {\n  plt <- plt +\n    scale_fill_group() +\n    scale_colour_group() +\n    ggplot2::theme_classic() +  \n    ggplot2::theme(\n          axis.title = element_text(size = 16),\n          axis.text = element_text(size = 14),\n          legend.title = element_text(size = 16),\n          legend.text = element_text(size = 14),\n      )\n\n  return(plt)\n}\n\nwho_clean <- get_who_data()\n\n# RAIN plot (descriptive)\nplt <- ggplot(\n    data = who_clean,\n    aes(fill = treatment, x = timepoint, y = who_calc_total, color = treatment)\n  ) +\n  geom_rain(\n    seed = 42,\n    rain.side = 'r',\n    #id.long.var = \"IoD_reduced\",\n    point.args = list(\n      alpha = 0.3,\n      shape = 21\n    ),\n    point.args.pos = rlang::list2(\n      position = position_jitter(\n        width = 0.1,\n        height = 0.1\n      )\n    ),\n    boxplot.args = list(\n      outlier.shape = NA,\n      color = \"black\",\n      alpha = .7\n    ),\n    boxplot.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .25,\n        width = 0.2\n      ), \n      width = 0.15\n    ),\n    violin.args = list(\n      alpha = .2\n    ),\n    violin.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .4,\n        width = 0\n      ), \n      width = 1.2\n    ),\n  ) +\n  labs(\n    y = \"WHO-5 (total score)\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n\nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-anc-who-5-rainplot.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-anc-who-5-rainplot.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n:::\n\n\n::: {.landscape}\n\n![Rainplot for the WHO-5 Well-Being Index (WHO-5, total score).](_figures/fig-anc-who-5-rainplot.png){#fig-anc-who-5-rainplot}\n\n:::\n\n\n::: {#tbl-anc-who-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for the WHO-5 Well-Being Index (WHO-5, total score).'}\n\n```{.r .cell-code .hidden}\nwho_clean <- get_who_data()\n\ntbl <- create_who_mmrm_table()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1751f5d4.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-mmrm.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f16db3ebc.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccc}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 22 & 14 to 29 & <0·0001 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & -2·9 & -8·2 to 2·4 & 0·29 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & 0·25 & -3·9 to 4·4 & 0·91 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & 1·9 & -2·5 to 6·2 & 0·40 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & -0·94 & -2·7 to 0·84 & 0·30 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 (post) * Intervention & 1·7 & -3·1 to 6·5 & 0·49 \\\\ \n    Module 2 (before) * Intervention & -1·8 & -6·4 to 2·7 & 0·43 \\\\ \n    Module 2 (post) * Intervention & -1·6 & -6·6 to 3·3 & 0·52 \\\\ \n    Module 3 (before) * Intervention & -0·86 & -6·3 to 4·6 & 0·76 \\\\ \n    Module 3 (post) * Intervention & -4·5 & -10 to 1·1 & 0·11 \\\\ \n    Module 4 (before) * Intervention & 0·10 & -5·9 to 6·1 & 0·97 \\\\ \n    Module 4 (post) * Intervention & -4·3 & -10 to 1·6 & 0·15 \\\\ \n    Module 5 (before) * Intervention & -2·4 & -8·8 to 4·1 & 0·47 \\\\ \n    Module 5 (post) * Intervention & -2·9 & -10 to 4·4 & 0·43 \\\\ \n    Module 6 (before) * Intervention & -1·9 & -9·2 to 5·3 & 0·60 \\\\ \n    Module 6 (post) * Intervention & -0·15 & -7·6 to 7·3 & 0·97 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 (post) & 0·00 & Ref. &  \\\\ \n    Module 2 (before) & -0·22 & -3·1 to 2·6 & 0·88 \\\\ \n    Module 2 (post) & 0·72 & -2·6 to 4·0 & 0·67 \\\\ \n    Module 3 (before) & -0·02 & -3·9 to 3·9 & >0·99 \\\\ \n    Module 3 (post) & 1·8 & -2·0 to 5·5 & 0·35 \\\\ \n    Module 4 (before) & -2·4 & -6·4 to 1·6 & 0·24 \\\\ \n    Module 4 (post) & 1·1 & -2·8 to 5·0 & 0·57 \\\\ \n    Module 5 (before) & 0·90 & -3·4 to 5·2 & 0·68 \\\\ \n    Module 5 (post) & -0·31 & -5·2 to 4·6 & 0·90 \\\\ \n    Module 6 (before) & 1·4 & -3·7 to 6·5 & 0·58 \\\\ \n    Module 6 (post) & 3·1 & -2·2 to 8·5 & 0·24 \\\\ \n{\\bfseries Baseline value (WHO-5)} & 0·68 & 0·60 to 0·77 & <0·0001 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, CI = Confidence interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#cell-fig-anc-who-estimated-marginal-means .cell}\n\n```{.r .cell-code .hidden}\n# Estimated marginal means\nemm <- emmeans(fit_who, ~ treatment | timepoint)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nNOTE: A nesting structure was detected in the fitted model:\n    treatment %in% timepoint\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm_df <- as.data.frame(emm)\n\nplt <- ggplot(\n    emm_df, \n    aes(\n      x = timepoint,\n      y = emmean, \n      color = treatment, \n      group = treatment\n    )\n  ) +\n  geom_line() +\n  geom_point(size = 3) +\n  geom_ribbon(\n    aes(\n      ymin = lower.CL, \n      ymax = upper.CL\n    ),\n    alpha = 0.2\n  ) +\n  labs(\n    y = \"Estimated marginal means ± 95%-CI\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n  \nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-anc-who-estimated-marginal-means.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-anc-who-estimated-marginal-means.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n:::\n\n\n::: {.landscape}\n\n![Estimated marginal means of the MMRM for the WHO-5 Well-Being Index (WHO-5 total score).](_figures/fig-anc-who-estimated-marginal-means.png){#fig-anc-who-estimated-marginal-means}\n\n:::\n\n\n::: {#tbl-anc-who-pre-post-pairwise-intervention .cell tbl-cap='Pairwise comparison of the WHO-5 Well-Being Index (WHO-5, total score, pre-post module) for the intervention arm.'}\n\n```{.r .cell-code .hidden}\ntbl <- create_who_pairwise_tbls(subgroup_str = \"Intervention\")\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1db2c234.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f4b8be07f.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1} &  &  & 0·054 & 0·27 \\\\ \n    Mean (SD) & 58 (23) & 62 (24) &  &  \\\\ \n    Median (Q1, Q3) & 64 (40, 76) & 68 (40, 80) &  &  \\\\ \n    Min, Max & 8, 100 & 12, 100 &  &  \\\\ \n{\\bfseries Module 2} &  &  & 0·52 & >0·99 \\\\ \n    Mean (SD) & 63 (23) & 62 (23) &  &  \\\\ \n    Median (Q1, Q3) & 70 (44, 80) & 64 (44, 80) &  &  \\\\ \n    Min, Max & 12, 100 & 0, 100 &  &  \\\\ \n    Missing & 22 & 22 &  &  \\\\ \n{\\bfseries Module 3} &  &  & 0·041 & 0·25 \\\\ \n    Mean (SD) & 63 (24) & 60 (23) &  &  \\\\ \n    Median (Q1, Q3) & 68 (44, 80) & 62 (42, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 4} &  &  & 0·77 & >0·99 \\\\ \n    Mean (SD) & 60 (24) & 58 (27) &  &  \\\\ \n    Median (Q1, Q3) & 62 (38, 80) & 64 (36, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 46 & 46 &  &  \\\\ \n{\\bfseries Module 5} &  &  & 0·48 & >0·99 \\\\ \n    Mean (SD) & 59 (27) & 60 (28) &  &  \\\\ \n    Median (Q1, Q3) & 62 (36, 80) & 66 (32, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 56 & 56 &  &  \\\\ \n{\\bfseries Module 6} &  &  & 0·13 & 0·50 \\\\ \n    Mean (SD) & 61 (29) & 66 (26) &  &  \\\\ \n    Median (Q1, Q3) & 70 (32, 80) & 72 (52, 84) &  &  \\\\ \n    Min, Max & 0, 100 & 12, 100 &  &  \\\\ \n    Missing & 64 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-who-pre-post-pairwise-placebo .cell tbl-cap='Pairwise comparison of the WHO-5 Well-Being Index (WHO-5, total score, pre-post module) for the placebo arm.'}\n\n```{.r .cell-code .hidden}\ntbl_placebo <- create_who_pairwise_tbls(subgroup_str = \"Placebo\")\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-placebo.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f187cb322.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-placebo.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-pre-post-pairwise-placebo.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f20882c3e.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 106 & \\textbf{post}  N = 106 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1} &  &  & 0·054 & 0·27 \\\\ \n    Mean (SD) & 58 (23) & 62 (24) &  &  \\\\ \n    Median (Q1, Q3) & 64 (40, 76) & 68 (40, 80) &  &  \\\\ \n    Min, Max & 8, 100 & 12, 100 &  &  \\\\ \n{\\bfseries Module 2} &  &  & 0·52 & >0·99 \\\\ \n    Mean (SD) & 63 (23) & 62 (23) &  &  \\\\ \n    Median (Q1, Q3) & 70 (44, 80) & 64 (44, 80) &  &  \\\\ \n    Min, Max & 12, 100 & 0, 100 &  &  \\\\ \n    Missing & 22 & 22 &  &  \\\\ \n{\\bfseries Module 3} &  &  & 0·041 & 0·25 \\\\ \n    Mean (SD) & 63 (24) & 60 (23) &  &  \\\\ \n    Median (Q1, Q3) & 68 (44, 80) & 62 (42, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 38 & 38 &  &  \\\\ \n{\\bfseries Module 4} &  &  & 0·77 & >0·99 \\\\ \n    Mean (SD) & 60 (24) & 58 (27) &  &  \\\\ \n    Median (Q1, Q3) & 62 (38, 80) & 64 (36, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 46 & 46 &  &  \\\\ \n{\\bfseries Module 5} &  &  & 0·48 & >0·99 \\\\ \n    Mean (SD) & 59 (27) & 60 (28) &  &  \\\\ \n    Median (Q1, Q3) & 62 (36, 80) & 66 (32, 80) &  &  \\\\ \n    Min, Max & 0, 100 & 0, 100 &  &  \\\\ \n    Missing & 56 & 56 &  &  \\\\ \n{\\bfseries Module 6} &  &  & 0·13 & 0·50 \\\\ \n    Mean (SD) & 61 (29) & 66 (26) &  &  \\\\ \n    Median (Q1, Q3) & 70 (32, 80) & 72 (52, 84) &  &  \\\\ \n    Min, Max & 0, 100 & 12, 100 &  &  \\\\ \n    Missing & 64 & 64 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-who-difference-from-baseline .cell tbl-cap='Pairwise comparisons of the WHO-5 Well-Being Index (WHO-5, total score, difference score).'}\n\n```{.r .cell-code .hidden}\ntbl <- create_who_diffscore_tbl()\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-difference-from-baseline.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f505f5ffa.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-difference-from-baseline.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-who-difference-from-baseline.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f4451c4e7.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 113 & \\textbf{Intervention}  N = 108 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1} &  &  & 0·31 & >0·99 \\\\ \n    Mean (SD) & 1 (18) & 4 (20) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-8, 12) & 4 (-4, 12) &  &  \\\\ \n    Min, Max & -68, 64 & -60, 76 &  &  \\\\ \n{\\bfseries Module 2} &  &  & 0·86 & >0·99 \\\\ \n    Mean (SD) & 1 (12) & 0 (16) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-4, 8) & 0 (-8, 8) &  &  \\\\ \n    Min, Max & -40, 40 & -48, 36 &  &  \\\\ \n    Missing & 19 & 17 &  &  \\\\ \n{\\bfseries Module 3} &  &  & 0·26 & >0·99 \\\\ \n    Mean (SD) & 1 (19) & -2 (19) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-8, 12) & 0 (-12, 6) &  &  \\\\ \n    Min, Max & -48, 72 & -100, 48 &  &  \\\\ \n    Missing & 35 & 36 &  &  \\\\ \n{\\bfseries Module 4} &  &  & 0·15 & 0·89 \\\\ \n    Mean (SD) & 4 (18) & -1 (17) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-2, 8) & 0 (-12, 8) &  &  \\\\ \n    Min, Max & -44, 64 & -36, 48 &  &  \\\\ \n    Missing & 41 & 46 &  &  \\\\ \n{\\bfseries Module 5} &  &  & 0·95 & >0·99 \\\\ \n    Mean (SD) & -1 (18) & -2 (15) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-4, 4) & 0 (-8, 8) &  &  \\\\ \n    Min, Max & -100, 40 & -60, 28 &  &  \\\\ \n    Missing & 54 & 55 &  &  \\\\ \n{\\bfseries Module 6} &  &  & 0·63 & >0·99 \\\\ \n    Mean (SD) & 2 (12) & 2 (13) &  &  \\\\ \n    Median (Q1, Q3) & 0 (-4, 8) & 0 (0, 8) &  &  \\\\ \n    Min, Max & -24, 32 & -40, 28 &  &  \\\\ \n    Missing & 60 & 66 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndf_diff <- create_who_diffscore_dataframe(\"who_calc_total\")\n\ndf_diff_long <- df_diff %>% pivot_longer(\n    cols = matches(\"^diff_IoD Module \\\\d+$\"),\n    names_to  = \"timepoint\",\n    values_to = \"who_calc_total\"\n  ) %>%\n  mutate(\n    timepoint = sub(\"^diff_IoD Module \", \"\", timepoint),\n    timepoint= factor(timepoint, levels = as.character(1:6), labels = paste(\"Module\", 1:6))\n  )\n\n# RAIN plot (descriptive)\nplt <- ggplot(\n    data = df_diff_long,\n    aes(fill = treatment, x = timepoint, y = who_calc_total, color = treatment)\n  ) +\n  geom_rain(\n    seed = 42,\n    rain.side = 'r',\n    #id.long.var = \"IoD_reduced\",\n    point.args = list(\n      alpha = 0.3,\n      shape = 21\n    ),\n    point.args.pos = rlang::list2(\n      position = position_jitter(\n        width = 0.1,\n        height = 0.1\n      )\n    ),\n    boxplot.args = list(\n      outlier.shape = NA,\n      color = \"black\",\n      alpha = .7\n    ),\n    boxplot.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .25,\n        width = 0.2\n      ), \n      width = 0.15\n    ),\n    violin.args = list(\n      alpha = .2\n    ),\n    violin.args.pos = list(\n      position = ggpp::position_dodgenudge(\n        x = .4,\n        width = 0\n      ), \n      width = 1.2\n    ),\n  ) +\n  labs(\n    y = \"WHO-5 (total score)\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n\nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-anc-who-5-difference-from-baseline-rainplot.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16,\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-anc-who-5-difference-from-baseline-rainplot.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 32,\n  height = 16\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing non-finite outside the scale range\n(`stat_half_ydensity()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: `position_dodge()` requires non-overlapping x intervals.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 429 rows containing missing values or values outside the scale range\n(`geom_point_sorted()`).\n```\n\n\n:::\n:::\n\n\n![Rainplot for the WHO-5 Well-Being Index (WHO-5 difference from baseline).](_figures/fig-anc-who-5-difference-from-baseline-rainplot.png){#fig-anc-who-5-difference-from-baseline-rainplot}\n\n{{< pagebreak >}}\n\n### WAI-SR: Online-Coach\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nget_wai_data_full <- function() {\n  infile <- file.path(exportDirmyTabu, \"questionnaires_api_wai.rds\")\n  wai <- readRDS(infile) %>% as_tibble\n\n  # timepoints\n  # 1-2-1\n  # 2-2-1\n  # 3-2-1\n  # 4-2-1\n  # 5-2-1\n  # 6-2-1\n\n  # Goal Items: 4, 6, 8, 11; \n\n  # Task Items: 1, 2, 10, 12; \n\n  # Bond Items Online Coach: 3, 5, 7, 9\n\n  # ---------------------------\n\n  # Bond Items Supervisor: 13, 14, 15, 16\n\n  wai <-\n    wai %>%\n    mutate(timepoint = case_when(\n      # current_module_nr == 1 ~ 'Baseline',\n      # current_module_nr == 2 ~ 'Module 2',\n      # current_module_nr == 3 ~ 'Module 3',\n      # current_module_nr == 4 ~ 'Module 4',\n      # current_module_nr == 5 ~ 'Module 5',\n      # current_module_nr == 6 ~ 'Module 6'\n\n      current_module_nr == 1 ~ 'Baseline',\n      current_module_nr == 2 ~ 'Module 1',\n      current_module_nr == 3 ~ 'Module 2',\n      current_module_nr == 4 ~ 'Module 3',\n      current_module_nr == 5 ~ 'Module 4',\n      current_module_nr == 6 ~ 'Module 5'\n    ),\n    timepoint = factor(\n      timepoint),\n    client_id = factor(client_id)\n  )\n    \n\n  wai$wai_calc_total_coach <- rowSums(\n    wai[, c('wai_1', 'wai_2', 'wai_3', 'wai_4', 'wai_5', 'wai_6', 'wai_7', 'wai_8', 'wai_9', 'wai_10', 'wai_11', 'wai_12')], na.rm = TRUE)\n\n  wai$wai_calc_total_supervisor <- rowSums(\n    wai[, c('wai_1', 'wai_2', 'wai_3', 'wai_4', 'wai_5', 'wai_6', 'wai_7', 'wai_8', 'wai_13', 'wai_14', 'wai_15', 'wai_16')], na.rm = TRUE)\n\n  wai$wai_calc_goal <- rowSums(\n    wai[, c('wai_4', 'wai_6', 'wai_8', 'wai_11')], na.rm = TRUE)\n\n  wai$wai_calc_task <- rowSums(\n    wai[, c('wai_1', 'wai_2', 'wai_10', 'wai_12')], na.rm = TRUE)\n\n  wai$wai_calc_bond_coach <- rowSums(\n    wai[, c('wai_3', 'wai_5', 'wai_7', 'wai_9')], na.rm = TRUE)\n\n  wai$wai_calc_bond_supervisor <- rowSums(\n    wai[, c('wai_13', 'wai_14', 'wai_15', 'wai_16')], na.rm = TRUE)\n\n  return(wai)\n}\n\n\ncreate_wai_clean_data <- function(variable) {\n\n  wai <- get_wai_data_full()\n\n  wai_tmp <- wai %>% dplyr::select(client_id, timepoint, .data[[variable]])\n\n  dat_clean_tmp <- dat_clean %>%\n    filter(timepoint == \"Baseline\")\n\n  dat_clean_tmp <- dat_clean_tmp %>%\n    dplyr::select(client_id, treatment, static99_modified_calc, \"Indexdelikt\", \"Aktuelle_Betreuung\", \"Aktuelle_zusatzliche_Behandlung\")\n\n  wai_complete <- wai_tmp %>% left_join(dat_clean_tmp, by=\"client_id\")\n\n  wai_baseline <- wai_complete %>%\n    filter(timepoint == \"Baseline\") %>%\n    dplyr::select(\n      client_id,\n      .data[[variable]]\n    ) %>%\n    rename(\n      wai_baseline = variable\n    )\n\n  wai_clean <- merge(\n        wai_complete, wai_baseline, by=\"client_id\", all=TRUE\n      ) %>%\n      mutate(client_id = as.factor(client_id)) %>%\n      filter(!client_id %in% c(194, 412, 511) & !is.na(client_id)) %>%\n      filter(client_id %in% client_list)\n\n  wai_clean <- wai_clean %>% janitor::clean_names(case=\"none\") %>%\n    filter(client_id %in% client_list)\n\n  wai_clean <- wai_clean %>%\n        dplyr::mutate_if(~inherits(., \"ordered\"), ~factor(., ordered = FALSE))\n\n  return(wai_clean)\n}\n\ncreate_wai_mmrm_table <- function(variable, var_name) {\n\n  variable <- variable\n  var_name <- var_name\n\n    \n  who_clean <- create_wai_clean_data(variable)\n\n    formular <- as.formula(\n        paste(\n            variable, \"~ wai_baseline + timepoint + treatment:timepoint + `Indexdelikt` + `Aktuelle_Betreuung` + `Aktuelle_zusatzliche_Behandlung` + `static99_modified_calc` +\n                us(timepoint | client_id)\"\n        )\n    )\n\n    fit1_model <- mmrm(\n        formula = formular,\n        data = who_clean %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n            dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n    )\n\n    dynamic_label_text <- paste0(\"Baseline value (\",  var_name, \")\")\n    dynamic_entry <- setNames(list(dynamic_label_text), \"wai_baseline\")\n\n    label_list <- c(\n        list(\n            static99_modified_calc = \"Static recidivism risk (baseline)\",\n            Aktuelle_Betreuung = \"Type of supervision\",\n            Aktuelle_zusatzliche_Behandlung = \"Additional treatment\",\n            Indexdelikt = \"Offense type\",\n            treatment = \"Treatment\",\n            timepoint = \"Timepoint\",\n            `Timepoint * treatment` = \"Timepoint * Treatment\"\n        ),\n        dynamic_entry   # hier wird dynamisch angehängt\n    )\n\n    lm_Table <- fit1_model %>%\n        tbl_regression(\n            add_estimate_to_reference_rows = TRUE,\n            intercept = TRUE,\n            label = label_list\n        ) %>%\n        modify_header(label ~ \"**Variable**\") %>%\n        modify_table_styling(\n            columns = c(estimate, conf.low, conf.high),\n            rows = reference_row %in% TRUE,\n            missing_symbol = \"Ref.\"\n        ) %>%\n        bold_labels() %>%\n        # abbreviations\n        modify_abbreviation(\"CI = Confidence interval, StGB = German penalty law.\") %>%\n        as_gt() %>%\n        gt::tab_options(\n          table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n        ) %>%\n        tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n        tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n    return(lm_Table)\n}\n\ncreate_wai_pairwise_dataframe <- function(variable) {\n\n  df <- create_wai_clean_data(variable)\n\n  # Paired tests for IoD:\n  df <- df %>%\n    dplyr::filter(!is.na(.data[[variable]]))\n\n  dat_complete_module2_iod <- df %>% dplyr::filter(timepoint %in% c(\"Baseline\", \"Module 1\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Baseline\" ~ \"pre\",\n                                \"Module 1\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 2` = variable)\n\n  dat_complete_module3_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 1\", \"Module 2\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 1\" ~ \"pre\",\n                                \"Module 2\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 3` = variable)\n\n  dat_complete_module4_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 2\", \"Module 3\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 2\" ~ \"pre\",\n                                \"Module 3\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 4` = variable)\n\n  dat_complete_module5_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 3\", \"Module 4\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 3\" ~ \"pre\",\n                                \"Module 4\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 5` = variable)\n\n  dat_complete_module6_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 4\", \"Module 5\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 4\" ~ \"pre\",\n                                \"Module 5\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 6` = variable)\n\n  df <- dat_complete_module2_iod %>%\n    dplyr::select(contains(\"pre/post\"), client_id, timepoint, treatment) %>%\n    dplyr::filter(!client_id %in% c(253, 396)) %>%\n    merge(.,\n          dat_complete_module3_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module4_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module5_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module6_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    arrange(client_id, desc(timepoint)) %>%\n    dplyr::filter(!is.na(timepoint)) %>%\n    dplyr::mutate(timepoint = relevel(timepoint, \"pre\"))\n    \n    df <- df %>% mutate(\n      module_2 = `IoD pre/post Module 2`,\n      module_3 = `IoD pre/post Module 3`,\n      module_4 = `IoD pre/post Module 4`,\n      module_5 = `IoD pre/post Module 5`,\n      module_6 = `IoD pre/post Module 6`\n    )\n\n    return(df)\n}\n\ncreate_wai_pairwise_tbls <- function(\n  subgroup_str = \"Intervention\",\n  variable\n) {\n\n  dvs <- c(\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n\n  dvs_mbsb <- c(\n    \"module_2\",\n    \"module_3\",\n    \"module_4\",\n    \"module_5\",\n    \"module_6\"\n  )\n\n  labels <- c(\n    \"Module 1 (post)\",\n    \"Module 2 (post)\",\n    \"Module 3 (post)\",\n    \"Module 4 (post)\",\n    \"Module 5 (post)\"\n  )\n\n  types = rep(\"continuous2\", 5)\n  abbreviations <- c(\"\")\n  sample_str <- \"itt\"\n  mbsb <- TRUE\n  grouping_var <- \"treatment\"\n\n  # create dvs and grouping_var based on mbsb\n  dvs <- dvs_mbsb\n  # grouping variable (which variables should be compared - must have two levels)\n  grouping_var <- \"treatment\"\n\n\n  dat <- create_wai_pairwise_dataframe(variable)\n  dat_i <- dat %>% filter(treatment == \"Intervention\") %>%\n      dplyr::select(contains(\"_\"), timepoint)\n  dat_p <- dat %>% filter(treatment == \"Placebo\") %>%\n    dplyr::select(contains(\"_\"), timepoint)\n\n\n  data_intervention <- dat_i\n\n  data_placebo <- dat_p\n\n  # create label_list\n  label_list <- purrr::map2(dvs, labels, ~rlang::new_formula(sym(.x), .y))\n\n  # create list of types\n  type_list <- purrr::map2(dvs, types, ~rlang::new_formula(sym(.x), .y))\n\n  if (subgroup_str == \"Intervention\") {\n    tbl <- create_prim_pairwise_tbl(data_intervention, dvs, label_list, type_list, abbreviations)\n  } else if (subgroup_str == \"Placebo\") {\n    tbl <- create_prim_pairwise_tbl(data_placebo, dvs, label_list, type_list, abbreviations)\n  } else {\n    stop(\"subgroup_str must be either 'Intervention' or 'Placebo'\")\n  }\n\n  return(tbl)\n}\n\ncreate_wai_diffscore_dataframe <- function(variable) {\n\n  df <- create_wai_clean_data(variable)\n\n  df <- df %>%\n    dplyr::filter(!is.na(.data[[variable]]))\n\n  dat_complete_module2_iod <- df %>% dplyr::filter(timepoint %in% c(\"Baseline\", \"Module 1\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Baseline\" ~ \"pre\",\n                                \"Module 1\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 2` = variable)\n\n  dat_complete_module3_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 1\", \"Module 2\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 1\" ~ \"pre\",\n                                \"Module 2\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 3` = variable)\n\n  dat_complete_module4_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 2\", \"Module 3\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 2\" ~ \"pre\",\n                                \"Module 3\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 4` = variable)\n\n  dat_complete_module5_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 3\", \"Module 4\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 3\" ~ \"pre\",\n                                \"Module 4\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 5` = variable)\n\n  dat_complete_module6_iod <- df %>% dplyr::filter(timepoint %in% c(\"Module 4\", \"Module 5\"))  %>%\n    group_by(client_id) %>%\n    filter(n()==2) %>%\n    mutate(timepoint=case_match(timepoint,\n                                \"Module 4\" ~ \"pre\",\n                                \"Module 5\" ~ \"post\") %>%\n            factor()) %>%\n    dplyr::rename(`IoD pre/post Module 6` = variable)\n\n  df <- dat_complete_module2_iod %>%\n    dplyr::select(contains(\"pre/post\"), client_id, timepoint, treatment) %>%\n    dplyr::filter(!client_id %in% c(253, 396)) %>%\n    merge(.,\n          dat_complete_module3_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module4_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module5_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    merge(.,\n          dat_complete_module6_iod %>%\n            dplyr::select(contains(\"pre/post\"), client_id, timepoint) %>%\n            dplyr::filter(!client_id %in% c(253, 396)),\n          by=c(\"client_id\", \"timepoint\"),\n          all=TRUE) %>%\n    arrange(client_id, desc(timepoint)) %>%\n    dplyr::filter(!is.na(timepoint)) %>%\n    dplyr::mutate(timepoint = relevel(timepoint, \"pre\"))\n\n  # Reshape the data: separate \"pre\" and \"post\" values into columns\n  df_wide <- df %>%\n    dplyr::select(contains(\"pre/post\"), timepoint, client_id, treatment) %>%\n    tidyr::pivot_wider(names_from = timepoint, values_from = -c(client_id, timepoint, treatment)) %>%\n    dplyr::mutate(`treatment` = `treatment` %>% relevel(ref = \"Placebo\"))\n\n  names(df_wide) %<>% gsub(\"pre/post \", \"\", .)\n\n  # Compute the differences (post - pre)\n  df_diff <- df_wide %>%\n    mutate(across(ends_with(\"post\"), ~ . - get(sub(\"post\", \"pre\", cur_column())), .names = \"diff_{.col}\")) %>%\n    rename_with(~ sub(\"_post$\", \"\", .), starts_with(\"diff_\")) %>%\n    dplyr::select(client_id, starts_with(\"diff_\"), treatment)\n\n  df_diff <- df_diff %>%\n    dplyr::select(-client_id) %>%\n    filter(!is.na(treatment))\n\n  df_diff <- df_diff %>% mutate(\n      module_2 = `diff_IoD Module 2`,\n      module_3 = `diff_IoD Module 3`,\n      module_4 = `diff_IoD Module 4`,\n      module_5 = `diff_IoD Module 5`,\n      module_6 = `diff_IoD Module 6`\n    ) %>%\n    dplyr::select(treatment, module_2, module_3, module_4, module_5, module_6)\n    \n\n   return(df_diff)\n}\n\ncreate_prim_wai_diff_tbl <- function(data, dvs, label_list, grouping_var, abbreviations, type_list) {\n\n  tbl <- data %>%\n    tbl_summary(\n      by = grouping_var,\n      type = type_list,\n      missing_text = \"Missing\",\n      label = label_list\n    ) %>%\n    # brunner-munzel test\n    add_stat(fns = everything() ~ bm_unpaired_test) %>%\n    add_q(method = \"holm\") %>%\n    modify_header(\n      p.value = \"**p**\"\n    ) %>%\n    bold_labels() %>%\n    # damit quarto citations im footer erkeent, dürfen keine footnotes vorhanden sein!\n    remove_footnote_header(columns = \"q.value\") %>%\n    # abbreviations\n    modify_abbreviation(\"Q1 = 25th percentile, Q3 = 75th percentile, SD = Standard deviance, p~adj~ = Holm-Bonferroni adjusted p.\")\n\n  return(tbl)\n}\n\ncreate_wai_diffscore_tbl <- function(\n  variable = \"who_calc_total\"\n) {\n\n  mbsb <- TRUE\n  grouping_var <- \"treatment\"\n\n  dvs <- c(\n    \"Module 2\",\n    \"Module 3\",\n    \"Module 4\",\n    \"Module 5\",\n    \"Module 6\"\n  )\n\n\n  dvs_mbsb <- c(\n    \"module_2\",\n    \"module_3\",\n    \"module_4\",\n    \"module_5\",\n    \"module_6\"\n  )\n\n  labels <- c(\n    \"Module 1 (post)\",\n    \"Module 2 (post)\",\n    \"Module 3 (post)\",\n    \"Module 4 (post)\",\n    \"Module 5 (post)\"\n  )\n\n  types = rep(\"continuous2\", 5)\n  abbreviations <- c(\"\")\n  sample_str <- \"itt\"\n  mbsb <- TRUE\n  grouping_var <- \"treatment\"\n\n  dvs <- dvs_mbsb\n\n  # create label_list\n  label_list <- purrr::map2(dvs, labels, ~rlang::new_formula(sym(.x), .y))\n\n  # create list of types\n  type_list <- purrr::map2(dvs, types, ~rlang::new_formula(sym(.x), .y))\n\n  tbl_data <- create_wai_diffscore_dataframe(variable)\n\n  tbl <- create_prim_wai_diff_tbl(tbl_data, dvs, label_list, grouping_var, abbreviations, type_list)\n\n  # show table\n  return(tbl)\n}\n```\n:::\n\n\n\n::: {#tbl-anc-wai-coach-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for the Working Alliance Inventory-Short Revised (WAI-SR COACH).'}\n\n```{.r .cell-code .hidden}\nvariable <- \"wai_calc_total_coach\"\nvar_name <- \"WAI-SR COACH (total score)\"\n\ntbl <- create_wai_mmrm_table(variable, var_name)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0.\ni Please use `all_of(var)` (or `any_of(var)`) instead of `.data[[var]]`\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f28ebae55.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-mmrm.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f13cee4b5.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccc}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 15 & 11 to 20 & <0·0001 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & 1·2 & -1·6 to 4·0 & 0·39 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & 1·1 & -1·1 to 3·3 & 0·34 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & -1·2 & -3·4 to 1·1 & 0·31 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & -0·59 & -1·5 to 0·35 & 0·22 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 * Intervention & 2·4 & 0·30 to 4·5 & 0·025 \\\\ \n    Module 2 * Intervention & 3·8 & 1·2 to 6·5 & 0·0044 \\\\ \n    Module 3 * Intervention & 3·4 & 0·96 to 5·9 & 0·0067 \\\\ \n    Module 4 * Intervention & 2·1 & -0·63 to 4·9 & 0·13 \\\\ \n    Module 5 * Intervention & 4·3 & 1·3 to 7·3 & 0·0051 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 & 0·00 & Ref. &  \\\\ \n    Module 2 & -0·96 & -2·3 to 0·35 & 0·15 \\\\ \n    Module 3 & 0·39 & -0·92 to 1·7 & 0·56 \\\\ \n    Module 4 & 0·46 & -1·1 to 2·0 & 0·55 \\\\ \n    Module 5 & 1·1 & -0·68 to 2·9 & 0·22 \\\\ \n{\\bfseries Baseline value (WAI-SR COACH (total score))} & 0·67 & 0·58 to 0·77 & <0·0001 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, CI = Confidence interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#cell-fig-anc-wai-coach-estimated-marginal-means .cell}\n\n```{.r .cell-code .hidden}\nvariable <- \"wai_calc_total_coach\"\nwho_clean <- create_wai_clean_data(variable)\n\nformular <- as.formula(\n    paste(\n        variable, \"~ wai_baseline + timepoint + treatment:timepoint + `Indexdelikt` + `Aktuelle_Betreuung` + `Aktuelle_zusatzliche_Behandlung` + `static99_modified_calc` +\n            us(timepoint | client_id)\"\n    )\n)\n\nfit <- mmrm(\n    formula = formular,\n    data = who_clean %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n        dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm <- emmeans(fit, ~ treatment | timepoint)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nNOTE: A nesting structure was detected in the fitted model:\n    treatment %in% timepoint\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm_df <- as.data.frame(emm)\n\nplt <- ggplot(\n    emm_df, \n    aes(\n      x = timepoint,\n      y = emmean, \n      color = treatment, \n      group = treatment\n    )\n  ) +\n  geom_line() +\n  geom_point(size = 3) +\n  geom_ribbon(\n    aes(\n      ymin = lower.CL, \n      ymax = upper.CL\n    ),\n    alpha = 0.2\n  ) +\n  labs(\n    y = \"Estimated marginal means ± 95%-CI\",\n    x = \"Timepoint\",\n    color = \"Treatment\",\n    fill = \"Treatment\"\n  )\n  \nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-anc-wai-coach-estimated-marginal-means.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-anc-wai-coach-estimated-marginal-means.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIgnoring unknown labels:\n* fill : \"Treatment\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n:::\n\n\n![Estimated marginal means from the MMRM of the Working Alliance Inventory-Short Revised (WAI-SR COACH).](_figures/fig-anc-wai-coach-estimated-marginal-means.png){#fig-anc-wai-coach-estimated-marginal-means}\n\n\n::: {#tbl-anc-wai-coach-pre-post-pairwise-intervention .cell tbl-cap='Pairwise comparison of the Working Alliance Inventory-Short Revised (WAI-SR COACH total score) for the intervention arm.'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_pairwise_tbls(\"Intervention\", variable)\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f47876943.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f6c7674e6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 97 & \\textbf{post}  N = 97 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·0020 & 0·010 \\\\ \n    Mean (SD) & 42 (11) & 44 (9) &  &  \\\\ \n    Median (Q1, Q3) & 43 (34, 49) & 47 (39, 51) &  &  \\\\ \n    Min, Max & 14, 60 & 22, 60 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·21 & 0·62 \\\\ \n    Mean (SD) & 45 (9) & 46 (10) &  &  \\\\ \n    Median (Q1, Q3) & 47 (41, 52) & 48 (39, 54) &  &  \\\\ \n    Min, Max & 23, 60 & 12, 60 &  &  \\\\ \n    Missing & 15 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·61 & 0·62 \\\\ \n    Mean (SD) & 47 (9) & 48 (9) &  &  \\\\ \n    Median (Q1, Q3) & 48 (40, 55) & 48 (42, 55) &  &  \\\\ \n    Min, Max & 27, 60 & 24, 60 &  &  \\\\ \n    Missing & 29 & 29 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·24 & 0·62 \\\\ \n    Mean (SD) & 47 (9) & 46 (10) &  &  \\\\ \n    Median (Q1, Q3) & 48 (42, 55) & 47 (39, 56) &  &  \\\\ \n    Min, Max & 24, 60 & 23, 60 &  &  \\\\ \n    Missing & 39 & 39 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·0040 & 0·016 \\\\ \n    Mean (SD) & 46 (11) & 49 (9) &  &  \\\\ \n    Median (Q1, Q3) & 47 (37, 57) & 49 (41, 57) &  &  \\\\ \n    Min, Max & 23, 60 & 23, 60 &  &  \\\\ \n    Missing & 50 & 50 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-wai-coach-pre-post-pairwise-placebo .cell tbl-cap='Pairwise comparison of the Working Alliance Inventory-Short Revised (WAI-SR COACH) for the placebo arm.'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_pairwise_tbls(\"Placebo\", variable)\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-placebo.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f38025565.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-placebo.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-pre-post-pairwise-placebo.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f448dfabd.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 98 & \\textbf{post}  N = 98 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·59 & >0·99 \\\\ \n    Mean (SD) & 42 (11) & 42 (11) &  &  \\\\ \n    Median (Q1, Q3) & 43 (34, 51) & 44 (34, 50) &  &  \\\\ \n    Min, Max & 12, 60 & 13, 60 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·52 & >0·99 \\\\ \n    Mean (SD) & 42 (12) & 41 (13) &  &  \\\\ \n    Median (Q1, Q3) & 44 (34, 50) & 42 (30, 53) &  &  \\\\ \n    Min, Max & 13, 60 & 12, 60 &  &  \\\\ \n    Missing & 16 & 16 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·28 & >0·99 \\\\ \n    Mean (SD) & 42 (14) & 43 (13) &  &  \\\\ \n    Median (Q1, Q3) & 44 (30, 53) & 46 (35, 53) &  &  \\\\ \n    Min, Max & 12, 60 & 12, 60 &  &  \\\\ \n    Missing & 24 & 24 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·56 & >0·99 \\\\ \n    Mean (SD) & 43 (13) & 43 (13) &  &  \\\\ \n    Median (Q1, Q3) & 46 (35, 53) & 47 (34, 54) &  &  \\\\ \n    Min, Max & 12, 60 & 12, 60 &  &  \\\\ \n    Missing & 32 & 32 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·40 & >0·99 \\\\ \n    Mean (SD) & 44 (13) & 44 (13) &  &  \\\\ \n    Median (Q1, Q3) & 48 (34, 54) & 48 (34, 55) &  &  \\\\ \n    Min, Max & 12, 60 & 14, 60 &  &  \\\\ \n    Missing & 43 & 43 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-wai-coach-difference-from-baseline .cell tbl-cap='Pairwise comparisons of the pre-post differences of the Working Alliance Inventory-Short Revised (WAI-SR COACH).'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_diffscore_tbl(variable)\n\ntbl <- tbl %>%\n    as_gt() %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-difference-from-baseline.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f651626fb.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-difference-from-baseline.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-coach-difference-from-baseline.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f1335231e.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 98 & \\textbf{Intervention}  N = 97 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·025 & 0·13 \\\\ \n    Median (Q1 – Q3) & 1 (-3 – 5) & 3 (-2 – 8) &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·059 & 0·18 \\\\ \n    Median (Q1 – Q3) & 0 (-4 – 3) & 1 (-2 – 4) &  &  \\\\ \n    Missing & 16 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·39 & 0·39 \\\\ \n    Median (Q1 – Q3) & 0·0 (-2·0 – 4·0) & 0·0 (-3·0 – 2·0) &  &  \\\\ \n    Missing & 24 & 29 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·19 & 0·39 \\\\ \n    Median (Q1 – Q3) & 0·0 (-2·0 – 4·0) & -1·0 (-5·0 – 2·0) &  &  \\\\ \n    Missing & 32 & 39 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·036 & 0·14 \\\\ \n    Median (Q1 – Q3) & 0·0 (-2·0 – 4·0) & 2·0 (0·0 – 6·0) &  &  \\\\ \n    Missing & 43 & 50 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, SD = Standard deviance, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n{{< pagebreak >}}\n\n### WAI-SR: Community supervisor\n\n\n::: {#tbl-anc-wai-supervisor-mmrm .cell tbl-cap='Mixed model for repeated measures (MMRM) for the Working Alliance Inventory-Short Revised (WAI-SR SUPERVISOR).'}\n\n```{.r .cell-code .hidden}\nvariable <- \"wai_calc_total_supervisor\"\nvar_name <- \"WAI-SR SUPERVISOR (total score)\"\n\ntbl <- create_wai_mmrm_table(variable, var_name)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-mmrm.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5786e806.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-mmrm.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-mmrm.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f37fffc3c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lccc}\n\\toprule\n\\textbf{Variable} & \\textbf{Beta} & \\textbf{95\\% CI} & \\textbf{p-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries (Intercept)} & 15 & 10 to 19 & <0·0001 \\\\ \n{\\bfseries Type of supervision} &  &  &  \\\\ \n    community supervision & 0·00 & Ref. &  \\\\ \n    post-release supervision & 1·6 & -0·61 to 3·9 & 0·15 \\\\ \n{\\bfseries Additional treatment} &  &  &  \\\\ \n    No & 0·00 & Ref. &  \\\\ \n    Yes & 1·0 & -0·75 to 2·8 & 0·26 \\\\ \n{\\bfseries Offense type} &  &  &  \\\\ \n    Hands-off (only §184b StGB) & 0·00 & Ref. &  \\\\ \n    Hands-on (at least one conviction §176 ff StGB) & -1·2 & -3·0 to 0·62 & 0·20 \\\\ \n{\\bfseries Static recidivism risk (baseline)} & -0·66 & -1·4 to 0·09 & 0·086 \\\\ \n{\\bfseries Timepoint * treatment} &  &  &  \\\\ \n    Module 1 * Intervention & 2·3 & 0·64 to 4·1 & 0·0073 \\\\ \n    Module 2 * Intervention & 3·0 & 0·87 to 5·2 & 0·0061 \\\\ \n    Module 3 * Intervention & 3·2 & 1·2 to 5·3 & 0·0022 \\\\ \n    Module 4 * Intervention & 2·1 & -0·16 to 4·3 & 0·068 \\\\ \n    Module 5 * Intervention & 3·6 & 1·2 to 6·0 & 0·0038 \\\\ \n{\\bfseries Timepoint} &  &  &  \\\\ \n    Module 1 & 0·00 & Ref. &  \\\\ \n    Module 2 & -0·14 & -1·3 to 0·96 & 0·80 \\\\ \n    Module 3 & 0·72 & -0·36 to 1·8 & 0·19 \\\\ \n    Module 4 & 1·1 & -0·04 to 2·3 & 0·059 \\\\ \n    Module 5 & 1·8 & 0·30 to 3·3 & 0·019 \\\\ \n{\\bfseries Baseline value (WAI-SR SUPERVISOR (total score))} & 0·70 & 0·62 to 0·79 & <0·0001 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviations: CI = Confidence Interval, CI = Confidence interval, StGB = German penalty law.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#cell-fig-anc-wai-supervisor-estimated-marginal-means .cell}\n\n```{.r .cell-code .hidden}\nvariable <- \"wai_calc_total_supervisor\"\nwho_clean <- create_wai_clean_data(variable)\n\nformular <- as.formula(\n    paste(\n        variable, \"~ wai_baseline + timepoint + treatment:timepoint + `Indexdelikt` + `Aktuelle_Betreuung` + `Aktuelle_zusatzliche_Behandlung` + `static99_modified_calc` +\n            us(timepoint | client_id)\"\n    )\n)\n\nfit <- mmrm(\n    formula = formular,\n    data = who_clean %>% filter(timepoint!=\"Baseline\" & !client_id %in% c(253, 396) ) %>% #  & client_id 533 hat kein Modul abgeschlossen\n        dplyr::mutate(treatment = relevel(treatment, ref=\"Placebo\"))\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nIn timepoint there are dropped visits: Baseline.\n Additional attributes including contrasts are lost.\nTo avoid this behavior, make sure use `drop_visit_levels = FALSE`.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm <- emmeans(fit, ~ treatment | timepoint)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nNOTE: A nesting structure was detected in the fitted model:\n    treatment %in% timepoint\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemm_df <- as.data.frame(emm)\n\nplt <- ggplot(\n    emm_df, \n    aes(\n      x = timepoint,\n      y = emmean, \n      color = treatment, \n      group = treatment\n    )\n  ) +\n  geom_line() +\n  geom_point(size = 3) +\n  geom_ribbon(\n    aes(\n      ymin = lower.CL, \n      ymax = upper.CL\n    ),\n    alpha = 0.2\n  ) +\n  labs(\n    y = \"Estimated marginal means ± 95%-CI\",\n    x = \"Timepoint\",\n    color = \"Treatment\"\n  )\n  \nplt <- add_gg_theme(plt)\n\nggsave(\n  here::here(\"_figures/fig-anc-wai-supervisor-estimated-marginal-means.png\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  here::here(\"_figures/fig-anc-wai-supervisor-estimated-marginal-means.pdf\"),\n  plot = plt,\n  dpi = 300,\n  width = 16,\n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: No shared levels found between `names(values)` of the manual scale and the\ndata's fill values.\n```\n\n\n:::\n:::\n\n\n![Estimated marginal means from the MMRM of Working Alliance Inventory-Short Revised (WAI-SR SUPERVISOR).](_figures/fig-anc-wai-supervisor-estimated-marginal-means.png){#ffig-anc-wai-supervisor-estimated-marginal-means}\n\n\n::: {#tbl-anc-wai-supervisor-pre-post-pairwise-intervention .cell tbl-cap='Pairwise comparison of the Working Alliance Inventory-Short Revised (WAI-SR SUPERVISOR) for the intervention arm.'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_pairwise_tbls(\"Intervention\", variable)\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-intervention.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f2c076896.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-intervention.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-intervention.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f3ba4bd97.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 97 & \\textbf{post}  N = 97 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & <0·0001 & <0·0001 \\\\ \n    Mean (SD) & 43 (9) & 46 (8) &  &  \\\\ \n    Median (Q1, Q3) & 44 (36, 49) & 47 (42, 53) &  &  \\\\ \n    Min, Max & 22, 60 & 24, 60 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·14 & 0·35 \\\\ \n    Mean (SD) & 47 (8) & 47 (9) &  &  \\\\ \n    Median (Q1, Q3) & 48 (42, 53) & 48 (42, 54) &  &  \\\\ \n    Min, Max & 24, 60 & 12, 60 &  &  \\\\ \n    Missing & 15 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·12 & 0·35 \\\\ \n    Mean (SD) & 49 (8) & 50 (8) &  &  \\\\ \n    Median (Q1, Q3) & 51 (43, 55) & 51 (46, 57) &  &  \\\\ \n    Min, Max & 27, 60 & 27, 60 &  &  \\\\ \n    Missing & 29 & 29 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·44 & 0·44 \\\\ \n    Mean (SD) & 49 (8) & 49 (9) &  &  \\\\ \n    Median (Q1, Q3) & 51 (46, 57) & 49 (41, 57) &  &  \\\\ \n    Min, Max & 27, 60 & 31, 60 &  &  \\\\ \n    Missing & 39 & 39 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·046 & 0·18 \\\\ \n    Mean (SD) & 49 (9) & 50 (8) &  &  \\\\ \n    Median (Q1, Q3) & 49 (41, 57) & 52 (46, 57) &  &  \\\\ \n    Min, Max & 31, 60 & 33, 60 &  &  \\\\ \n    Missing & 50 & 50 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-wai-supervisor-pre-post-pairwise-placebo .cell tbl-cap='Pairwise comparisons of the Working Alliance Inventory-Short Revised (WAI-SR SUPERVISOR) for the placebo arm.'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_pairwise_tbls(\"Placebo\", variable)\n\ntbl <- tbl %>%\n    gt::tab_options(\n      table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-placebo.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f664ee109.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-placebo.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-pre-post-pairwise-placebo.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f5cf01544.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Module} & \\textbf{pre}  N = 98 & \\textbf{post}  N = 98 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·32 & >0·99 \\\\ \n    Mean (SD) & 44 (10) & 45 (10) &  &  \\\\ \n    Median (Q1, Q3) & 45 (38, 52) & 47 (37, 51) &  &  \\\\ \n    Min, Max & 16, 60 & 19, 60 &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·72 & >0·99 \\\\ \n    Mean (SD) & 44 (10) & 44 (11) &  &  \\\\ \n    Median (Q1, Q3) & 47 (37, 52) & 47 (37, 53) &  &  \\\\ \n    Min, Max & 19, 60 & 14, 60 &  &  \\\\ \n    Missing & 16 & 16 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·21 & >0·99 \\\\ \n    Mean (SD) & 45 (11) & 45 (11) &  &  \\\\ \n    Median (Q1, Q3) & 48 (37, 53) & 48 (36, 55) &  &  \\\\ \n    Min, Max & 14, 60 & 16, 60 &  &  \\\\ \n    Missing & 24 & 24 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·45 & >0·99 \\\\ \n    Mean (SD) & 46 (11) & 46 (11) &  &  \\\\ \n    Median (Q1, Q3) & 48 (38, 54) & 49 (39, 54) &  &  \\\\ \n    Min, Max & 16, 60 & 16, 60 &  &  \\\\ \n    Missing & 32 & 32 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·59 & >0·99 \\\\ \n    Mean (SD) & 47 (10) & 47 (10) &  &  \\\\ \n    Median (Q1, Q3) & 49 (40, 55) & 48 (40, 57) &  &  \\\\ \n    Min, Max & 20, 60 & 23, 60 &  &  \\\\ \n    Missing & 43 & 43 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n::: {#tbl-anc-wai-supervisor-difference-from-baseline .cell tbl-cap='Differences from baseline of the Working Alliance Inventory-Short Revised (WAI-SR SUPERVISOR).'}\n\n```{.r .cell-code .hidden}\ntbl <- create_wai_diffscore_tbl(variable)\n\ntbl <- tbl %>%\n    as_gt() %>%\n    gt::tab_options(\n        table.font.names = \"Times New Roman\",\n          table.font.size = 10,\n          quarto.use_bootstrap = FALSE,\n          quarto.disable_processing = TRUE,\n          data_row.padding = px(1),\n          summary_row.padding = gt::px(1),\n          grand_summary_row.padding = gt::px(1),\n          #footnotes.padding = gt::px(2),\n          #source_notes.padding = gt::px(2),\n          row_group.padding = gt::px(1)\n    ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n\n# save tbl as image\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-difference-from-baseline.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f49668a2a.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-difference-from-baseline.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-anc-wai-supervisor-difference-from-baseline.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f409efe42.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lcccc}\n\\toprule\n\\textbf{Characteristic} & \\textbf{Placebo}  N = 98 & \\textbf{Intervention}  N = 97 & \\textbf{p} & \\textbf{q-value} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Module 1 (post)} &  &  & 0·0090 & 0·045 \\\\ \n    Median (Q1 – Q3) & 1 (-3 – 4) & 4 (-1 – 6) &  &  \\\\ \n{\\bfseries Module 2 (post)} &  &  & 0·19 & 0·40 \\\\ \n    Median (Q1 – Q3) & 0·0 (-3·0 – 2·0) & 1·0 (-1·0 – 4·0) &  &  \\\\ \n    Missing & 16 & 15 &  &  \\\\ \n{\\bfseries Module 3 (post)} &  &  & 0·51 & 0·51 \\\\ \n    Median (Q1 – Q3) & 1·0 (-2·0 – 3·0) & 0·0 (-2·0 – 3·0) &  &  \\\\ \n    Missing & 24 & 29 &  &  \\\\ \n{\\bfseries Module 4 (post)} &  &  & 0·13 & 0·40 \\\\ \n    Median (Q1 – Q3) & 0·0 (-2·0 – 3·0) & -0·5 (-4·0 – 2·0) &  &  \\\\ \n    Missing & 32 & 39 &  &  \\\\ \n{\\bfseries Module 5 (post)} &  &  & 0·061 & 0·24 \\\\ \n    Median (Q1 – Q3) & 0·0 (-2·0 – 2·0) & 1·0 (0·0 – 4·0) &  &  \\\\ \n    Missing & 43 & 50 &  &  \\\\ \n\\bottomrule\n\\end{tabular*}\n\\begin{minipage}{\\linewidth}\n\\vspace{.05em}\n\\parbox{\\linewidth}{\\raggedright {Abbreviation: Q1 = 25th percentile, Q3 = 75th percentile, SD = Standard deviance, p\\textsubscript{adj} = Holm-Bonferroni adjusted p.\\\\\n}}\\end{minipage}\n\\end{table}\n\n:::\n:::\n\n\n\n\n<!-- \n##################\n# CONSORT checklist\n##################\n-->\n{{< pagebreak >}}\n\n## CONSORT checklist\n\n\n::: {#tbl-consort-checklist .cell tbl-cap='CONSORT 2025 checklist. Adapated from [@hopewellCONSORT2025Statement2025].'}\n\n```{.r .cell-code .hidden}\nlibrary(gt)\nlibrary(tibble)\nlibrary(dplyr)\n\nconsort_data <- tibble::tribble(\n  ~Section, ~Subsection, ~Number, ~Description, ~Page,\n  # Title and abstract\n  \"Title and abstract\", NA, NA, NA, NA,\n  NA, \"Title and structured abstract\", \"1a\", \"Identification as a randomised trial\", \"p. 2 (Summary)\",\n  NA, \"\", \"1b\", \"Structured summary of the trial design, methods, results, and conclusions\", \"p. 2 (Summary)\",\n  # Open science\n  \"Open science\", NA, NA, NA, NA,\n  NA, \"Trial registration\", \"2\", \"Name of trial registry, identifying number (with URL) and date of registration\", \"p. 5 (Section 2.1)\",\n  NA, \"Protocol and statistical analysis plan\", \"3\", \"Where the trial protocol and statistical analysis plan can be accessed\", \"appendix section 1 (trial protocol); appendix section 11 (SAP)\",\n  NA, \"Data sharing\", \"4\", \"Where and how the individual de-identified participant data (including data dictionary), statistical code, and any other materials can be accessed\", \"p. 13 (Data sharing)\",\n  NA, \"Funding and conflicts of interest\", \"5a\", \"Sources of funding and other support (eg, supply of drugs), and role of funders in the design, conduct, analysis, and reporting of the trial\", \"Summary; p. 8 (Section 2.6); p. 13 (Acknowledgements)\",\n  NA, \"\", \"5b\", \"Financial and other conflicts of interest of the manuscript authors\", \"p. 13 (Declaration of interests)\",\n  # Introduction\n  \"Introduction\", NA, NA, NA, NA,\n  NA, \"Background and rationale\", \"6\", \"Scientific background and rationale\", \"p. 4-5 (Section 1)\",\n  NA, \"Objectives\", \"7\", \"Specific objectives related to benefits and harms\", \"p. 5 (Section 1)\",\n  # Methods\n  \"Methods\", NA, NA, NA, NA,\n  NA, \"Patient and public involvement\", \"8\", \"Details of patient or public involvement in the design, conduct, and reporting of the trial\", \"p. 5 Section 2.1)\",\n  NA, \"Trial design\", \"9\", \"Description of trial design including type of trial (eg, parallel group, crossover), allocation ratio, and framework (eg, superiority, equivalence, non-inferiority, or exploratory)\", \"p. 5 (Section 2.1)\",\n  NA, \"Changes to trial protocol\", \"10\", \"Important changes to the trial after it commenced including any outcomes or analyses that were not prespecified, with reason\", \"p. 6 (Section 2.4)\",\n  NA, \"Trial setting\", \"11\", \"Settings (eg, community, hospital) and locations (eg, countries, sites) where the trial was conducted\", \"p. 5 (Section 2.1)\",\n  NA, \"Eligibility criteria\", \"12a\", \"Eligibility criteria for participants\", \"p. 5 (Section 2.1)\",\n  NA, \"\", \"12b\", \"If applicable, eligibility criteria for sites and for individuals delivering the interventions (eg, surgeons, physiotherapists)\", \"not applicable\",\n  NA, \"Intervention and comparator\", \"13\", \"Intervention and comparator with sufficient details to allow replication. If relevant, where additional materials describing the intervention and comparator (eg, intervention manual) can be accessed\", \"p. 5 (Section 2.3)\",\n  NA, \"Outcomes\", \"14\", \"Prespecified primary and secondary outcomes, including the specific measurement variable (eg, systolic blood pressure), analysis metric (eg, change from baseline, final value, time to event), method of aggregation (eg, median, proportion), and timepoint for each outcome\", \"p. 6-7 (Section 2.4); Table 2; appendix Section 3\",\n  NA, \"Harms\", \"15\", \"How harms were defined and assessed (eg, systematically, non-systematically)\", \"p. 6 (Section 2.4)\",\n  NA, \"Sample size\", \"16a\", \"How sample size was determined, including all assumptions supporting the sample size calculation\", \"p. 7 (Section 2.5)\",\n  NA, \"\", \"16b\", \"Explanation of any interim analyses and stopping guidelines\", \"p. 7 (Section 2.5)\",\n  # Randomisation\n  \"Randomisation\", NA, NA, NA, NA,\n  NA, \"Sequence generation\", \"17a\", \"Who generated the random allocation sequence and the method used\", \"p. 5 (Section 2.2)\",\n  NA, \"\", \"17b\", \"Type of randomisation and details of any restriction (eg, stratification, blocking and block size)\", \"p. 5 (Section 2.2)\",\n  NA, \"Allocation concealment mechanism\", \"18\", \"Mechanism used to implement the random allocation sequence (eg, central computer/telephone; sequentially numbered, opaque, sealed containers), describing any steps to conceal the sequence until interventions were assigned\", \"p. 5 (Section 2.2)\",\n  NA, \"Implementation\", \"19\", \"Whether the personnel who enrolled and those who assigned participants to the interventions had access to the random allocation sequence\", \"p. 5 (Section 2.2)\",\n  NA, \"Blinding\", \"20a\", \"Who was blinded after assignment to interventions (eg, participants, care providers, outcome assessors, data analysts)\", \"p. 5 (Section 2.2)\",\n  NA, \"\", \"20b\", \"If blinded, how blinding was achieved and description of the similarity of interventions\", \"p. 5 (Section 2.2)\",\n  NA, \"Statistical methods\", \"21a\", \"Statistical methods used to compare groups for primary and secondary outcomes, including harms\", \"p. 7-8 (Section 2.5)\",\n  NA, \"\", \"21b\", \"Definition of who is included in each analysis (eg, all randomised participants), and in which group\", \"p. 7-8 (Section 2.5)\",\n  NA, \"\", \"21c\", \"How missing data were handled in the analysis\", \"p. 7-8 (Section 2.5)\",\n  NA, \"\", \"21d\", \"Methods for any additional analyses (eg, subgroup and sensitivity analyses), distinguishing prespecified from post hoc\", \"p. 7-8 (Section 2.5)\",\n  # Results\n  \"Results\", NA, NA, NA, NA,\n  NA, \"Participant flow, including flow diagram\", \"22a\", \"For each group, the numbers of participants who were randomly assigned, received intended intervention, and were analysed for the primary outcome\", \"p. 8 (Section 3) and Figure 1\",\n  NA, \"\", \"22b\", \"For each group, losses and exclusions after randomisation, together with reasons\", \"Figure 1\",\n  NA, \"Recruitment\", \"23a\", \"Dates defining the periods of recruitment and follow-up for outcomes of benefits and harms\", \"p. 8 (Section 3)\",\n  NA, \"\", \"23b\", \"If relevant, why the trial ended or was stopped\", \"p. 8 (Section 3)\",\n  NA, \"Intervention and comparator delivery\", \"24a\", \"Intervention and comparator as they were actually administered (eg, where appropriate, who delivered the intervention/comparator, how participants adhered, whether they were delivered as intended [fidelity])\", \"Table 1; Figure 1; p. 5-6 (Section 2.3)\",\n  NA, \"\", \"24b\", \"Concomitant care received during the trial for each group\", \"p. 8 (Section 3)\",\n  NA, \"Baseline data\", \"25\", \"A table showing baseline demographic and clinical characteristics for each group\", \"Table 3\",\n  NA, \"Numbers analysed, outcomes and estimation\", \"26\", \"For each primary and secondary outcome, by group: •the number of participants included in the analysis •the number of participants with available data at the outcome timepoint •result for each group, and the estimated effect size and its precision (such as 95% confidence interval) •for binary outcomes, presentation of both absolute and relative effect size\", \"p. 8-11 (Section 3); appendix\",\n  NA, \"Harms\", \"27\", \"All harms or unintended events in each group\", \"p. 10 (Section 3)\",\n  NA, \"Ancillary analyses\", \"28\", \"Any other analyses performed, including subgroup and sensitivity analyses, distinguishing prespecified from post hoc\", \"pp. 10-11 (Section 3); appendix\",\n  # Discussion\n  \"Discussion\", NA, NA, NA, NA,\n  NA, \"Interpretation\", \"29\", \"Interpretation consistent with results, balancing benefits and harms, and considering other relevant evidence\", \"p. 11-12 (Section 4)\",\n  NA, \"Limitations\", \"30\", \"Trial limitations, addressing sources of potential bias, imprecision, generalisability, and, if relevant, multiplicity of analyses\", \"p. 11-12 (Section 4)\"\n)\n\n# Markiere die Überschriften-Zeilen (wo Section nicht NA)\nheader_rows <- which(!is.na(consort_data$Section))\n# gt bauen\n\ntbl <- consort_data %>%\n  gt() %>%\n  cols_label(\n    Subsection = \"Subsection\",\n    Section = \"Section\",\n    Number = \"Number\",\n    Page = \"Reference\"\n  ) %>%\n  tab_style(\n    style = list(cell_text(weight = \"bold\")),\n    locations = cells_body(rows = header_rows)\n  ) %>%\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_column_labels(columns = everything())\n  ) %>%\n  fmt_missing(\n    columns = everything(), # NA überall durch \"\" ersetzen\n    missing_text = \"\"\n  ) %>%\n  cols_width(\n    Section ~ px(80),\n    Description ~ px(150),\n    Subsection ~ px(80),\n    Number  ~ px(80),\n    Page ~ px(80),\n  ) %>%\n  gt::tab_options(\n    table.font.names = \"Times New Roman\",\n    table.font.size = 10,\n    quarto.use_bootstrap = FALSE,\n    quarto.disable_processing = TRUE,\n    data_row.padding = px(1),\n    summary_row.padding = gt::px(1),\n    grand_summary_row.padding = gt::px(1),\n    #footnotes.padding = gt::px(2),\n    #source_notes.padding = gt::px(2),\n    row_group.padding = gt::px(1)\n  ) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_source_notes()) %>%\n  tab_style(style = cell_text(align = \"left\"), locations = cells_footnotes())\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Since gt v0.6.0 `fmt_missing()` is deprecated and will soon be removed.\ni Use `sub_missing()` instead.\nThis warning is displayed once every 8 hours.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-consort-checklist.pdf\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f52cf900.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-consort-checklist.docx\")))\ngt::gtsave(tbl, file = file.path(here::here(\"_tables/tbl-consort-checklist.png\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////tmp/RtmpubfKk5/file12240f420d0ab6.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntbl\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{8.0pt}{9.0pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}>{\\raggedright\\arraybackslash}p{\\dimexpr 60.00pt -2\\tabcolsep-1.5\\arrayrulewidth}>{\\raggedright\\arraybackslash}p{\\dimexpr 60.00pt -2\\tabcolsep-1.5\\arrayrulewidth}>{\\raggedright\\arraybackslash}p{\\dimexpr 60.00pt -2\\tabcolsep-1.5\\arrayrulewidth}>{\\raggedright\\arraybackslash}p{\\dimexpr 112.50pt -2\\tabcolsep-1.5\\arrayrulewidth}>{\\raggedright\\arraybackslash}p{\\dimexpr 60.00pt -2\\tabcolsep-1.5\\arrayrulewidth}}\n\\toprule\n{\\bfseries Section} & {\\bfseries Subsection} & {\\bfseries Number} & {\\bfseries Description} & {\\bfseries Reference} \\\\ \n\\midrule\\addlinespace[2.5pt]\n{\\bfseries Title and abstract} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Title and structured abstract & 1a & Identification as a randomised trial & p. 2 (Summary) \\\\ \n &  & 1b & Structured summary of the trial design, methods, results, and conclusions & p. 2 (Summary) \\\\ \n{\\bfseries Open science} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Trial registration & 2 & Name of trial registry, identifying number (with URL) and date of registration & p. 5 (Section 2.1) \\\\ \n & Protocol and statistical analysis plan & 3 & Where the trial protocol and statistical analysis plan can be accessed & appendix section 1 (trial protocol); appendix section 11 (SAP) \\\\ \n & Data sharing & 4 & Where and how the individual de-identified participant data (including data dictionary), statistical code, and any other materials can be accessed & p. 13 (Data sharing) \\\\ \n & Funding and conflicts of interest & 5a & Sources of funding and other support (eg, supply of drugs), and role of funders in the design, conduct, analysis, and reporting of the trial & Summary; p. 8 (Section 2.6); p. 13 (Acknowledgements) \\\\ \n &  & 5b & Financial and other conflicts of interest of the manuscript authors & p. 13 (Declaration of interests) \\\\ \n{\\bfseries Introduction} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Background and rationale & 6 & Scientific background and rationale & p. 4-5 (Section 1) \\\\ \n & Objectives & 7 & Specific objectives related to benefits and harms & p. 5 (Section 1) \\\\ \n{\\bfseries Methods} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Patient and public involvement & 8 & Details of patient or public involvement in the design, conduct, and reporting of the trial & p. 5 Section 2.1) \\\\ \n & Trial design & 9 & Description of trial design including type of trial (eg, parallel group, crossover), allocation ratio, and framework (eg, superiority, equivalence, non-inferiority, or exploratory) & p. 5 (Section 2.1) \\\\ \n & Changes to trial protocol & 10 & Important changes to the trial after it commenced including any outcomes or analyses that were not prespecified, with reason & p. 6 (Section 2.4) \\\\ \n & Trial setting & 11 & Settings (eg, community, hospital) and locations (eg, countries, sites) where the trial was conducted & p. 5 (Section 2.1) \\\\ \n & Eligibility criteria & 12a & Eligibility criteria for participants & p. 5 (Section 2.1) \\\\ \n &  & 12b & If applicable, eligibility criteria for sites and for individuals delivering the interventions (eg, surgeons, physiotherapists) & not applicable \\\\ \n & Intervention and comparator & 13 & Intervention and comparator with sufficient details to allow replication. If relevant, where additional materials describing the intervention and comparator (eg, intervention manual) can be accessed & p. 5 (Section 2.3) \\\\ \n & Outcomes & 14 & Prespecified primary and secondary outcomes, including the specific measurement variable (eg, systolic blood pressure), analysis metric (eg, change from baseline, final value, time to event), method of aggregation (eg, median, proportion), and timepoint for each outcome & p. 6-7 (Section 2.4); Table 2; appendix Section 3 \\\\ \n & Harms & 15 & How harms were defined and assessed (eg, systematically, non-systematically) & p. 6 (Section 2.4) \\\\ \n & Sample size & 16a & How sample size was determined, including all assumptions supporting the sample size calculation & p. 7 (Section 2.5) \\\\ \n &  & 16b & Explanation of any interim analyses and stopping guidelines & p. 7 (Section 2.5) \\\\ \n{\\bfseries Randomisation} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Sequence generation & 17a & Who generated the random allocation sequence and the method used & p. 5 (Section 2.2) \\\\ \n &  & 17b & Type of randomisation and details of any restriction (eg, stratification, blocking and block size) & p. 5 (Section 2.2) \\\\ \n & Allocation concealment mechanism & 18 & Mechanism used to implement the random allocation sequence (eg, central computer/telephone; sequentially numbered, opaque, sealed containers), describing any steps to conceal the sequence until interventions were assigned & p. 5 (Section 2.2) \\\\ \n & Implementation & 19 & Whether the personnel who enrolled and those who assigned participants to the interventions had access to the random allocation sequence & p. 5 (Section 2.2) \\\\ \n & Blinding & 20a & Who was blinded after assignment to interventions (eg, participants, care providers, outcome assessors, data analysts) & p. 5 (Section 2.2) \\\\ \n &  & 20b & If blinded, how blinding was achieved and description of the similarity of interventions & p. 5 (Section 2.2) \\\\ \n & Statistical methods & 21a & Statistical methods used to compare groups for primary and secondary outcomes, including harms & p. 7-8 (Section 2.5) \\\\ \n &  & 21b & Definition of who is included in each analysis (eg, all randomised participants), and in which group & p. 7-8 (Section 2.5) \\\\ \n &  & 21c & How missing data were handled in the analysis & p. 7-8 (Section 2.5) \\\\ \n &  & 21d & Methods for any additional analyses (eg, subgroup and sensitivity analyses), distinguishing prespecified from post hoc & p. 7-8 (Section 2.5) \\\\ \n{\\bfseries Results} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Participant flow, including flow diagram & 22a & For each group, the numbers of participants who were randomly assigned, received intended intervention, and were analysed for the primary outcome & p. 8 (Section 3) and Figure 1 \\\\ \n &  & 22b & For each group, losses and exclusions after randomisation, together with reasons & Figure 1 \\\\ \n & Recruitment & 23a & Dates defining the periods of recruitment and follow-up for outcomes of benefits and harms & p. 8 (Section 3) \\\\ \n &  & 23b & If relevant, why the trial ended or was stopped & p. 8 (Section 3) \\\\ \n & Intervention and comparator delivery & 24a & Intervention and comparator as they were actually administered (eg, where appropriate, who delivered the intervention/comparator, how participants adhered, whether they were delivered as intended [fidelity]) & Table 1; Figure 1; p. 5-6 (Section 2.3) \\\\ \n &  & 24b & Concomitant care received during the trial for each group & p. 8 (Section 3) \\\\ \n & Baseline data & 25 & A table showing baseline demographic and clinical characteristics for each group & Table 3 \\\\ \n & Numbers analysed, outcomes and estimation & 26 & For each primary and secondary outcome, by group: •the number of participants included in the analysis •the number of participants with available data at the outcome timepoint •result for each group, and the estimated effect size and its precision (such as 95\\% confidence interval) •for binary outcomes, presentation of both absolute and relative effect size & p. 8-11 (Section 3); appendix \\\\ \n & Harms & 27 & All harms or unintended events in each group & p. 10 (Section 3) \\\\ \n & Ancillary analyses & 28 & Any other analyses performed, including subgroup and sensitivity analyses, distinguishing prespecified from post hoc & pp. 10-11 (Section 3); appendix \\\\ \n{\\bfseries Discussion} & {\\bfseries } & {\\bfseries } & {\\bfseries } & {\\bfseries } \\\\ \n & Interpretation & 29 & Interpretation consistent with results, balancing benefits and harms, and considering other relevant evidence & p. 11-12 (Section 4) \\\\ \n & Limitations & 30 & Trial limitations, addressing sources of potential bias, imprecision, generalisability, and, if relevant, multiplicity of analyses & p. 11-12 (Section 4) \\\\ \n\\bottomrule\n\\end{tabular*}\n\\end{table}\n\n:::\n:::\n\n\n<!-- \n##################\n# SAP\n##################\n-->\n\n{{< pagebreak >}}\n\n## Statistical analysis plan\n\n::: {.content-visible when-format=\"pdf\"}\n\n\\includepdf[pages=-, fitpaper=true]{resources/myTabu_SAP_signed.pdf}\n\n:::\n\n::: {.content-visible when-format=\"html\"}\n```{=html}\n<p>\n    Please <a href=\"resources/myTabu_SAP_signed.pdf\">click here</a> to\n    download the PDF file.\n</p>\n```\n:::\n\n<!-- \n##################\n# SUPP References\n##################\n-->\n\n{{< pagebreak >}}\n\n## References\n\n::: {#refs}\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n\\usepackage{anyfontsize}\n\\usepackage{multirow}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}