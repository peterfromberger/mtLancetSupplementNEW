### CARES

<!-- RAIN PLOT -->
![Rainplot of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score).](_figures/fig-cares-rainplot.png){#fig-cares-rainplot}

<!-- ESTIMATED MARGINAL MEANS -->
![Estimated marginal means of the MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score).](_figures/fig-cares-estimated-marginal-means.png){#fig-cares-estimated-marginal-means}

<!-- MMRM -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-cares-mmrm-time-since-baseline
#| tbl-cap: "Explorative MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) with time since baseline as additional factor. Time since baseline is defined as the time between the baseline measurement and the respective consecutive measurement time-point."

library(gtsummary)
library(gt)

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

tbl <- fit2_c %>%
    tbl_regression(
      add_estimate_to_reference_rows = TRUE,
      intercept = TRUE,
      label = list(
        static99_modified_calc = "Static recidivism risk",
        Aktuelle_Betreuung = "Type of supervision",
        Aktuelle_zusatzliche_Behandlung = "Additional treatment",
        Indexdelikt = "Offense type",
        IoD_reduced_baseline = "Baseline value",
        Zeit_seit_Beginn_Modul_1_in_Jahren = "Time since baseline (years)",
        treatment = "Treatment",
        timepoint = "Timepoint",
        `Timepoint * treatment` = "Timepoint * treatment"
      )
    ) %>%
    modify_header(label ~ "**Variable**") %>%
    remove_abbreviation("CI = Confidence Interval") %>%
    modify_abbreviation("CI = Confidence Interval") %>%
    modify_abbreviation("StGB = German penalty law") %>%
    modify_column_alignment(columns = everything(), align = "left") %>%
    modify_table_styling(
        columns = c(estimate, conf.low, conf.high),
        rows = reference_row %in% TRUE,
        missing_symbol = "Ref."
    ) %>%
    bold_labels() %>%
    as_gt() %>%
    gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = TRUE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-mmrm-time-since-baseline.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-mmrm-time-since-baseline.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-mmrm-time-since-baseline.png")))

tbl
```

![Estimated marginal means  of the MMRM for the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) with time since baseline as additional factor.](_figures/fig-cares-estimated-marginal-means-time-since-baseline.png){#fig-cares-estimated-marginal-means-time-since-baseline}

<!-- SENSITIVITY ANALYSIS -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-cares-sensitivity-analysis
#| tbl-cap: "Sensitivity analysis for primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score). The table summarizes the results of a reference-based multiple imputation followed by ANCOVA models for the difference in the CARES compared to baseline."
library(gt)

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

tbl <- rbmi_cares_tab %>%
      gt() %>%
      gt::cols_label(
        "est" = "Estimate",
        "ci" = "95% CI",
        "pval" = "p-value",
        "parameter" = "Parameter"
      ) %>%
      gt::tab_options(
          table.font.size = 10,
          data_row.padding = gt::px(2),
          summary_row.padding = gt::px(2),
          grand_summary_row.padding = gt::px(2),
          #footnotes.padding = gt::px(2),
          #source_notes.padding = gt::px(2),
          row_group.padding = gt::px(2)
      )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-sensitivity-analysis.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-sensitivity-analysis.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-sensitivity-analysis.png")))

tbl
```

<!-- PAIRWISE COMPARISONS -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-cares-pairwise-intervention
#| tbl-cap: "Pairwise comparisons of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) for the intervention arm."

library(here)
source(here::here("_scripts/prim_pairwise_functions.R"))

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

variable <- "IoD_reduced"
tbl <- create_prim_pairwise_tbls(variable, subgroup_str = "Intervention")

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.png")))

tbl
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-cares-pairwise-placebo
#| tbl-cap: "Pairwise comparisons of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score) for the placebo arm."

variable <- "IoD_reduced"
tbl <- create_prim_pairwise_tbls(variable, subgroup_str = "Placebo")

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-pairwise-intervention.png")))

tbl
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-cares-diffscore
#| tbl-cap: "Pairwise comparisons of difference from baseline of the primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES total score)."

library(here)
source(here::here("_scripts/prim_diffscore_functions.R"))

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

variable <- "IoD_reduced"
tbl <- create_prim_diffscore_tbl(variable)

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-diffscore.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-diffscore.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-cares-diffscore.png")))

tbl
```

<!-- RAIN PLOT -->
![Rainplot of primary endpoint Child Sexual Abuse Risk Evaluation Self-Report (CARES difference from baseline scores).](_figures/fig-cares-rainplot-difference-from-baseline.png){#fig-cares-rainplot-difference-from-baseline}

{{< pagebreak >}}

### Index of Desistance (IoD)

<!-- RAIN PLOT -->
![Rainplot of the Index of Desistance (IoD total score). Note, that the IoD is the preliminary version of the CARES and mentioned in the Statistical analysis protocol as primary outcome.](_figures/fig-iod-rainplot.png){#fig-iod-rainplot}


<!-- MMRM -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-mmrm
#| tbl-cap: "Mixed model for repeated measures (MMRM) for the Index of Desistance (IoD total score)."

library(gtsummary)
library(gt)

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

tbl <- fit %>%
    tbl_regression(
      add_estimate_to_reference_rows = TRUE,
      intercept = TRUE,
      label = list(
        static99_modified_calc = "Static recidivism risk",
        Aktuelle_Betreuung = "Type of supervision",
        Aktuelle_zusatzliche_Behandlung = "Additional treatment",
        Indexdelikt = "Offense type",
        IoD_reduced_baseline = "Baseline value",
        Zeit_seit_Beginn_Modul_1_in_Jahren = "Time since baseline (years)",
        treatment = "Treatment",
        timepoint = "Timepoint",
        `Timepoint * treatment` = "Timepoint * Treatment"
      )
    ) %>%
    modify_header(label ~ "**Variable**") %>%
    remove_abbreviation("CI = Confidence Interval") %>%
    modify_abbreviation("CI = Confidence Interval, StGB = German penalty law.") %>%
    modify_column_alignment(columns = everything(), align = "left") %>%
    modify_table_styling(
        columns = c(estimate, conf.low, conf.high),
        rows = reference_row %in% TRUE,
        missing_symbol = "Ref."
    ) %>%
    bold_labels() %>%
    as_gt() %>%
    gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = TRUE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm.png")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm.docx")))

tbl
```

<!-- ESTIMATED MARGINAL MEANS -->
![Estimated marginal means of the MMRM for the IoD total score.](_figures/fig-iod-estimated-marginal-means.png){#fig-iod-estimated-marginal-means}

<!-- MMRM -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-mmrm-time-since-baseline
#| tbl-cap: "Explorative MMRM for Index of Desistance (IoD total score) with the additional factor time since beginning of the first module. StGB = German penalty law."

library(gtsummary)
library(gt)

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

tbl <- fit1_c %>%
    tbl_regression(
      add_estimate_to_reference_rows = TRUE,
      intercept = TRUE,
      label = list(
        static99_modified_calc = "Static recidivism risk",
        Aktuelle_Betreuung = "Type of supervision",
        Aktuelle_zusatzliche_Behandlung = "Additional treatment",
        Indexdelikt = "Offense type",
        IoD_reduced_baseline = "Baseline value",
        Zeit_seit_Beginn_Modul_1_in_Jahren = "Time since baseline (years)",
        treatment = "Treatment",
        timepoint = "Timepoint",
        `Timepoint * treatment` = "Timepoint * Treatment"
      )
    ) %>%
    modify_header(label ~ "**Variable**") %>%
    remove_abbreviation("CI = Confidence Interval") %>%
    modify_abbreviation("CI = Confidence Interval, StGB = German penalty law.") %>%
    modify_column_alignment(columns = everything(), align = "left") %>%
    modify_table_styling(
        columns = c(estimate, conf.low, conf.high),
        rows = reference_row %in% TRUE,
        missing_symbol = "Ref."
    ) %>%
    bold_labels() %>%
    as_gt() %>%
    gt::tab_options(
      table.font.names = "Times New Roman",
      table.font.size = 10,
      quarto.use_bootstrap = FALSE,
      quarto.disable_processing = TRUE,
      data_row.padding = px(2),
      summary_row.padding = gt::px(2),
      grand_summary_row.padding = gt::px(2),
      #footnotes.padding = gt::px(2),
      #source_notes.padding = gt::px(2),
      row_group.padding = gt::px(2)
    )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm-time-since-baseline.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm-time-since-baseline.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-mmrm-time-since-baseline.png")))

tbl
```

![Estimated marginal means of the MMRM for the Index of Desistance (IoD total score) with time since baseline as additional factor.](_figures/fig-iod-estimated-marginal-means-time-since-baseline.png){#fig-iod-estimated-marginal-means-time-since-baseline}

<!-- SENSITIVITY ANALYSIS -->
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-sensitivity-analysis
#| tbl-cap: "Sensitivity analysis for the Index of Desistance (IoD total score). Summarized are the results of the reference-based multiple imputation followed by ANCOVA models for the difference in the IoD (total score) compared to baseline."
library(gt)

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

tbl <- rbmi_tab %>%
  gt() %>%
  gt::cols_label(
    "est" = "Estimate",
    "ci" = "95% CI",
    "pval" = "p-value",
    "parameter" = "Parameter"
  ) %>%
  gt::tab_options(
    table.font.size = 10,
    data_row.padding = gt::px(2),
    summary_row.padding = gt::px(2),
    grand_summary_row.padding = gt::px(2),
    #footnotes.padding = gt::px(2),
    #source_notes.padding = gt::px(2),
    row_group.padding = gt::px(2)
  )

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-sensitivity-analysis.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-sensitivity-analysis.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-sensitivity-analysis.png")))

tbl
```

<!-- PAIRWISE COMPARISONS -->

::: {.landscape}

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-pairwise-intervention
#| tbl-cap: "Explorative pairwise comparison of the Index of Desistance (IoD total score) for the intervention arm."

library(here)
source(here::here("_scripts/prim_pairwise_functions.R"))

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

variable <- "IoD"
tbl <- create_prim_pairwise_tbls(variable, subgroup_str = "Intervention")

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.png")))

tbl
```

:::

::: {.landscape}

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-pairwise-placebo
#| tbl-cap: "Explorative pairwise comparison of the Index of Desistance (IoD total score) for the placebo arm."

variable <- "IoD"
tbl <- create_prim_pairwise_tbls(variable, subgroup_str = "Placebo")

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-pairwise-intervention.png")))

tbl
```

:::

<!-- DIFFERENCES FROM BASELINE -->

::: {.landscape}

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-prim-iod-diffscore
#| tbl-cap: "Difference of the Index of Desistance (IoD total score) between before (pre) and after (post) each module."

library(here)
source(here::here("_scripts/prim_diffscore_functions.R"))

# global theme for gtsummary
gtsummary::theme_gtsummary_journal(journal = "lancet")

variable <- "IoD"
tbl <- create_prim_diffscore_tbl(variable)

# save tbl as image
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-diffscore.pdf")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-diffscore.docx")))
gt::gtsave(tbl, file = file.path(here::here("_tables/tbl-prim-iod-diffscore.png")))

tbl
```

:::

<!-- RAIN PLOT -->
![Rainplot of the differences from baseline for the Index of Desistance (IoD total score).](_figures/fig-iod-rainplot-difference-from-baseline.png){#fig-iod-rainplot-difference-from-baseline}

